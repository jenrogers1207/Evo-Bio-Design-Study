{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/scripts/multinetLoad.js","webpack:///./src/scripts/pathCalc.js","webpack:///./src/scripts/selectedPaths.js","webpack:///./src/scripts/buttonComponents.js","webpack:///./src/scripts/renderPathView.js","webpack:///./src/scripts/filterComponent.js","webpack:///./src/scripts/toolbarComponent.js","webpack:///./src/scripts/cladeMaker.js","webpack:///./src/scripts/sidebarComponent.js","webpack:///./src/scripts/pairView.js","webpack:///./src/scripts/viewControl.js","webpack:///./src/scripts/distributionView.js","webpack:///./src/scripts/dataFormat.js","webpack:///./src/scripts/index.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","Multinet","this","tables","nodes","links","graph_structure","api_root","api","multinetApi","getGraphNames","workspace","graphs","load_data","graph","multinetOb","load_tables","nodeTables","node_table","load_nodes","edge_table","edgeTable","load_links","rename_node_vars","rename_link_vars","JSON","parse","stringify","table","limit","concat","row","id","_id","source","_from","target","_to","allPaths","edgeArray","leafArray","map","le","getPath","leaf","pathKeeper","path","filter","ed","reverse","pullPath","pathArray","arrayOfArray","nameArray","depth","forEach","node","childArray","undefined","children","assign","flag","selectedPaths","comparisonKeeper","pathSelected","selectedPath","otherPaths","scales","selectedDiv","d3","main","selectAll","remove","style","drawPathsAndAttributes","commonNodes","pathData","selectedSpecies","flatMap","f","treeNodes","select","indexOf","classed","attrHide","filterMaster","type","attribute","attrFilter","sc","field","selectedToolTest","selectedTool","empty","append","sortByDistanceDiv","text","sortByDistanceButton","on","sortButton","attrKeys","attrSortWrap","radioDiv","join","radio","attr","svgTest","svg","branchFrequency","reduce","acc","curr","selectWrap","circleScale","range","domain","values","selectedGroups","addRemoveBubble","treeNode","treeLinks","string","label","charAt","toUpperCase","timelines","nodeGroups","x","edgeMove","hovers","nearest","attributeWrapper","attData","formatAttributeData","attributeGroups","renderAttributes","keys","attributes","drawContAtt","drawDiscreteAtt","sorted","sort","a","b","realVal","paths","high","highLeaves","low","lowLeaves","commonNodeStart","maxBranch","thresh","max","chil","parentBase","move","base","scaledParentMove","parentScale","xScale","level","getCommonNodes","pathBars","childNodeWrap","childNodes","curve","y","line","species","commonHover","renderSelectedTopology","attWrap","ch","mappedDis","att","offset","index","last","dis","spec","states","winState","color","maxP","v","notMax","other","findMaxState","attGroups","wrapRect","speciesGrp","lineGenD","attributeHeight","lineGenC","yScale","branchGrpDis","sp","bCirc","otherCirc","tool","transition","duration","html","state","pageX","pageY","ticks","branchGrpCon","MeanRect","scale","min","confiBars","lowerCI95","upperCI95","dataMaster","renderDistibutions","renderSelectedView","commonNode","chosenPath","test","distance","pathIndex","console","error","sortOtherPaths","group","pathRemove","renderComparison","buttonGroupTest","buttonGroup","usedColors","groupColor","newColor","colorKeeper","find","compareButtonTest","compareButton","comparisonCombined","newAtt","com","atts","added","standard","variance","first","second","button","filteredComp","selectedTest","attWraps","normBins","Array","fill","internalNodes","leafNodes","bins","edges","top","mean","e","Math","sqrt","meanStandard","sigma2","upCon95","lowCon95","leaves","exit","attWrapsEnter","enter","merge","innerWrap","lineGen","pathGroups","missing","areaG","y0","y1","confGroups","conf","NaN","axisGroupTest","axisGroup","maxDiff","newScale","startBins","difArray","diffs","abs","clamp","diff","obsDistWrap","histogram","thresholds","newLeaves","xAxis","each","distGroups","groupLength","dropDown","div","optionArray","dropText","dropId","dropdiv","dropContent","options","raise","dimensions","rectWidth","rectHeight","collapsedHeight","getScales","nodeTooltipFlag","collapsed","pathWrapTest","pathWrap","pathAdd","notIt","maxTimeKeeper","combLength","nodeFilter","getLatestData","renderPaths","shownAttributes","checked","predictedAttrGrps","attribWrap","attrMove","selectedState","filterType","addFilterTag","addFilter","attributeType","updateMainView","nodeList","leafStateFilter","attrLabel","innerTimeline","step","change","height","innerPaths","continuousAtt","continuousPaths","attributeNodesCont","innerBars","rangeRect","colorScale","satScale","drawGroups","stateBins","splitOnArray","newBins","newBinData","scaleName","newData","pa","firstGroupSvg","firstGroup","secondGroup","g","newM","branchBar","drawBranchPointDistribution","groupLabels","stateLabel","innerGroup","innerWrapRect","wrappers","shiftWraps","xAxisShift","shiftCircles","leafWraps","totalVal","totalMean","newVal","groupMean","distcircles","dotVals","w","groupBy","totalArray","leafWrapsD","rects","groupedData","d3Array","width","ratio","drawLeaves","bars","discreteAtt","innerTimelineDis","statePath","disct","attributeNodesDisc","stateDots","endStateDot","stateBars","probability","chosenIn","valueAdd","toolbarDataControl","toolbar","graphList","chosenGraph","dataDrop","sidebar","toolbarButtonWrap","loadApp","toolbarControl","calculatedScales","viewArray","chosenCladesGroup","groups","filterButton","log","filterDiv","normedPaths","moveMetric","selectWrapper","attButton","stateChange","attProps","selectedOption","optKeys","button1","button2","submit","fromState","classList","toState","discreteFilter","filterOb","continRanges","ranges","brushBars","xBrush","extent","selection","handle","invert","brushGroup","selections","_groups","__brush","predictedFilter","observedFilter","lastFilter","continuousFilter","stateFilter","searchDiv","form","input","queryArray","split","toLowerCase","queryFilter","toggleFilters","scrunchButton","toggleScrunch","discreteViewButton","discretePredictedGroups","dropOptions","no","attributeOptions","checkedAttributes","attoptions","cladeOptions","cladeKeeper","dropdivClade","buttonClade","dropContentClade","updateCladeDrop","li","names","binGroups","calculatedScalesKeeper","renderDistStructure","dropUl","cladesGroupKeeper","growSidebarRenderTree","attrDraw","cladeBool","traitColorDropDown","renderTreeButtons","renderTree","margin","right","bottom","left","lengthHeight","addingEdgeLength","nestedData","treenodes","root","size","treeSvg","updateCladeTree","assignPosition","array","stepDown","child","findDepth","link","descendants","combEdge","position","parent","notleaves","stateColors","includes","branchNodes","branchPoint","triangle","clade","uncollapseSub","collapseSub","lengthBool","renderCladeTree","nodeData","findCommonNode","path1","path2","className","common","subtreeFinder","nodeNames","labelTree","wrap","textInput","addClade","addCladeGroup","clades","buildTreeStructure","getNested","String","V1","renderCallback","reduce2DropArray","startArray","buttonWrap","phenoOptions","phenogramButton","drop","updateRanking","pairPaths","cladeButton","_children","positionArray","edge","edgeLength","uncollapse","pheno","treemap","groupedBool","sidebarTest","gTest","updateTree","treeData","getLeaves","ids","Set","Clade","from","collapseTree","branchCount","yAxis","pairs","weights","deltaMax","deltas","closeMax","closeness","distMax","deltaScale","closeScale","distScale","sortedPairs","delta","deltaRank","closenessRank","distanceRank","totalRank","pairColor","brushes","brushData","pairWraps","p1","p2","scoreWrap","scoreGroups","score","scoreLabel","zero","pairGroupN","species1","species2","neighbors","start","speciesTest","speciesNames","labeledN","spec1N","spec2N","closest1","closest2","branchesN","pairGroup","branches","xAxisG","neighNodes","mouseG","mousePerLine","parentNode","dat","mouse","xDate","bisect","getElementsByClassName","beginning","end","getTotalLength","floor","pos","getPointAtLength","toFixed","drawSorted","view","document","getElementById","disabled","rankDiv","defaultW","weightPicker","slider","slide","default","displayValue","num","rankingControl","attKeys","generatePairs","removeFilter","filterId","dataFilters","filterIndex","testData","fun","filterFunction","newTestData","newFilterMaster","attType","filFunction","oldData","extra","ex","filterToolbar","formater","datum","nodeId","selectedNode","predicted","observed","numb","filterPred","st","filterObs","win","selectorDiv","selectId","dropDownWrapper","observedWidth","predictedWidth","squareDim","timeRange","brushColors","compareColors","light","dark","defaultBarColor","colorBool","selectedClades","groupLabel","newNormed","keysToHide","rootNodes","sortedBins","mapNorm","bin","fData","binI","leafAttr","leafData","nodeArray","count","maxO","minO","xO","histogramO","stateKeys","rootNode","colors","entries","histo","h","x1","x0","binWrap","nodeLengthArray","nodeDuplicateCheck","bPointScale","pointGroups","eMove","binsRects","groupBins","axis","axGroup","mainDiv","compareTooltipFlag","filteredAttributes","branchScale","binnedWrap","selected","sum","leafNames","fl","cladeLabel","drawGroupLabels","divWrap","groupHeader","textDiv","branchPointSvg","selectedNodes","testNodes","testLinks","pathsListOne","pathsListTwo","testNodesOne","testLinksOne","testNodesTwo","testLinksTwo","mapBins","combined","groupKey","predictedWrap","rootData","contRoot","newy","disRoot","rootStateGroups","maxVal","branchGroup","discreteDist","discreteMiddleGroups","stateRects","av","stateBarsPredicted","xMove","maxBin","maxState","continDist","list","continBinGroups","maxCount","distrib","mirrorlineGen","gindex","brush","maxCounts","classLabel","brushedVal","otherBins","descendBins","groupDis","continuousHistogram","oNode","oHisto","oDist","brushedNodes","selectedBranch","secondGrp","doesItExist","classy","notNodes","observedWrap","contOb","contBars","movex","xvalues","discOb","discBars","dRects","offSet","movey","xPoint","padding","renderDistributionComparison","probabilityTicks","stateBinsPredicted","winStates","winStateTicks","disWrap","winPosArray","getBoundingClientRect","lineThing","brushedDist","otherDist","testH","notNodeNames","notNodeSelectedBranch","notTest","testtest","notTestTest","notNodeSecondGrp","pair","verts","lastNode","p1Index","p2Index","binCount","binStep","one","two","valdiffs","calculateDelta","leaf1","leaf2","calculateCloseness","calculateNewScales","keyList","scaleCat","combineLength","maxTime","filterArray","speciesLabel","catColor","dataLoadAndFormatMultinet","graphName","dataName","unique","self","attributeList","internal","notAttributeList","discreteTraitList","calculatedAtt","newRow","calcLeafAtt","matchedEdges","attrib","fromNode","V2","rooted","chosenClade","savedSelected","toolbarDiv","toolbarDataWrap","then","centData","appLaunch"],"mappings":"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","file":"js/app.b2093553.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/Evo-Bio-Design-Study/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([200,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { multinetApi } from \"multinet\";\n\n/* Multinet data importer */\n// Define local variables that will store the api url and the responses from the database\n// let multinet = {\n//     tables: {},\n//     nodes: [],\n//     links: [],\n//     graph_structure: {},\n//     api_root: \"https://multinet.app/api\"\n// };\nconst api_root = \"https://multinet.app/api\";\n\nclass Multinet {\n\n    constructor(){\n\n        this.tables = {},\n        this.nodes = [],\n        this.links = [],\n        this.graph_structure = {},\n        this.api_root = api_root\n\n    }\n   \n}\n\nconst api = multinetApi(api_root);\n\nexport async function getGraphNames(workspace){\n    return await api.graphs(workspace);\n}\n\nexport async function load_data(workspace, graph) {\n\n    let multinetOb = new Multinet();\n\n    // Fetch the names of all the node and edge tables \n    await load_tables(workspace, graph, multinetOb);\n\n    // Loop through each node tables and fetch the nodes to global variables\n    for (let node_table of multinetOb.tables.nodeTables) {\n        await load_nodes(workspace, node_table, multinetOb);\n    };\n\n    // Load the edge table (ONLY ONE BECAUSE OF ARANGO API LIMITATIONS) to a global variable\n    let edge_table = multinetOb.tables.edgeTable;\n    await load_links(workspace, edge_table, multinetOb);\n\n    // Set the graph structure\n    multinetOb.graph_structure = { \"nodes\": rename_node_vars(multinetOb.nodes), \"links\": rename_link_vars(multinetOb.links) }\n    return JSON.parse(JSON.stringify(multinetOb.graph_structure))\n};\n\nasync function load_tables(workspace, graph, multinetOb) {\n    multinetOb.tables = await api.graph(workspace, graph);\n};\n\nasync function load_nodes(workspace, node_table, multinetOb) {\n    const table = await api.table(workspace, node_table, {\n      limit: 1000,\n    });\n    multinetOb.nodes = [].concat(multinetOb.nodes, table);\n};\n\nasync function load_links(workspace, edge_table, multinetOb) {\n    const table = await api.table(workspace, edge_table, {\n      limit: 1000,\n    });\n    multinetOb.links = [].concat(multinetOb.links, table)\n};\n\nfunction rename_link_vars(links) {\n    for (let row of links) {\n        row.id = row._id;\n        row.source = row._from;\n        row.target = row._to;\n\n        delete row._id;\n        delete row._from;\n        delete row._to;\n    };\n\n    return links;\n}\n\nfunction rename_node_vars(nodes) {\n    for (let row of nodes) {\n        row.id = row._id;\n\n        delete row._id;\n    };\n\n    return nodes;\n}\n","/**\n * \n * @param {array of all graph edges} edgeArray \n * @param {array of leaf nodes in graph} leafArray \n * @param {string for property} source\n * @param {string for property} target  \n */\nexport function allPaths(edgeArray, leafArray, source, target){\n    return leafArray.map(le=> getPath(edgeArray, le, [le], source, target));\n}\n\nexport function getNested(node, edgeArray){\n    node.children = edgeArray.filter(f=> String(f.V1) === String(node.node));\n    node.name = String(node.node);\n    if(node.children.length > 0){\n        node.children.forEach(c=> getNested(c, edgeArray));\n    }else{\n        return node;\n    }\n    return node;\n}\n\nexport function calculateMovingAverage(data, i) {\n\n    if (movingAverage === 0) {\n        return data[i][yValue];\n    }\n\n    var count = Math.min(movingAverage, i + 1),\n        first = i + 1 - count;\n\n    var sum = 0;\n    for (var index = first; index <= i; ++index) {\n        var x = data[index][yValue];\n        sum += x;\n    }\n\n    return sum / count;\n};\n\nexport function calculateMovingStandardDeviation(data, i, avg) {\n\n    if (movingAverage === 0) {\n        return 0;\n    }\n\n    var count = Math.min(movingAverage, i + 1),\n        first = i + 1 - count;\n\n    var sum = 0;\n    for (var index = first; index <= i; ++index) {\n        var x = data[index][yValue];\n        var dx = x - avg;\n        sum += (dx * dx);\n    }\n\n    var variance = sum / count;\n    return Math.sqrt(variance);\n};\n\n/**\n * \n * @param {array of all graph edges} edgeArray \n * @param {one row of the leaf array} leaf \n * @param {array that holds the constructed path} pathKeeper \n * @param {string for source header} source (V1)\n * @param {string for target header} target (V2)\n */\nexport function getPath(edgeArray, leaf, pathKeeper, source, target){\n    \n    let path = edgeArray.filter(ed=> {\n        return ed[target] === leaf[source];\n    });\n    \n    if(path.length > 0){\n        pathKeeper.push(path[0]);\n        return getPath(edgeArray, path[0], pathKeeper, source, target);\n    }else{\n        pathKeeper.push({'root': true, 'node': leaf[source], 'edgeLength': 0.0});\n        return pathKeeper.reverse();\n    }\n}\n\n\n/**\n * \n * @param {*} pathArray \n * @param {*} nodes \n * @param {*} arrayOfArray \n * @param {*} nameArray \n * @param {*} depth \n */\nexport function pullPath(pathArray, nodes, arrayOfArray, nameArray, depth){\n\n    nodes.forEach((node, i)=> {\n        node.depth = depth;\n        node.id = depth + '.' + i;\n       // node.edgeLength = node.edge_data.weight;\n        if(notEmpty(node.children)){\n            pathArray.push(Object.assign({}, node));\n            pullPath([...pathArray], [...node.children], arrayOfArray, nameArray, depth+1);\n        }else{\n            nameArray.push(node.node);\n            node.flag = true;\n            arrayOfArray.push([...pathArray, Object.assign({},node)]);\n        }\n    });\n    return arrayOfArray;\n}\n\nfunction notEmpty(childArray){\n    if(childArray == undefined){\n        return false;\n    }else if(childArray.length == 0){\n        return false;\n    }else{\n        return true;\n    }\n}\n","import * as d3 from \"d3\";\nimport { branchPaths, renderPaths, renderAttributes, drawContAtt, drawDiscreteAtt, drawPathsAndAttributes } from './renderPathView';\nimport { formatAttributeData } from './dataFormat';\nimport { filterMaster } from './filterComponent';\nimport { dataMaster, collapsed, colorKeeper } from './index';\nimport { renderDistibutions } from \"./distributionView\";\n\nexport let selectedPaths = [];\nexport let comparisonKeeper = [];\n\nexport function pathSelected(selectedPath, otherPaths, scales) {\n\n    let selectedDiv = d3.select('div#selected');\n    let main = d3.select('div#main');\n    if (selectedPath === null) {\n\n        selectedPaths = [];\n\n        d3.select('div#selected').selectAll('*').remove();\n        selectedDiv.style('height', 0);\n        d3.select('div#main').style('padding-top', '0px');\n        let main = d3.select('div#main');\n        drawPathsAndAttributes([...otherPaths], main, scales, false);\n\n    } else {\n      \n        selectedPaths = selectedPaths.concat(selectedPath);\n        let commonNodes = renderSelectedView([...selectedPaths], [...otherPaths], selectedDiv, scales);\n        let sortedPaths = sortOtherPaths([...selectedPaths], [...otherPaths], [...commonNodes]);\n        \n        /// LOWER ATTRIBUTE VISUALIZATION ///\n        let pathGroups = drawPathsAndAttributes(sortedPaths.map(s => s.data), main, scales, false);\n\n        main.style('padding-top', '250px');\n    }\n}\nfunction getCommonNodes(paths){\n    let maxBranch = d3.max(paths.map(p => p.length));\n    let longestBranch = paths.filter(path => path.length === maxBranch)[0];\n    let startBranch = longestBranch.filter(f=> f.leaf != true);\n    let commonNodeStart = startBranch;\n    //FIND THE COMMON BRANCHES BETWEEN ALL OF THE SELECTED///\n    paths.map(path => {\n        commonNodeStart = [...path].filter(f => {\n            return (commonNodeStart.map(m => m.node).indexOf(f.node) > -1) & f.leaf != true });\n    });\n\n    let children = paths.map(path => {\n        path = (path[0].leaf === true) ? path.reverse() : path;\n        let nodeIndex = path.map(p => p.node);\n        let thresh = nodeIndex.indexOf(commonNodeStart[commonNodeStart.length - 1].node);\n        let subset = path.filter((f, i) => i > thresh);\n        return subset;\n    });\n\n    commonNodeStart[commonNodeStart.length - 1].children = children.map((path, i) => {\n        let max = d3.max(path.map(p => p.edgeMove)) - commonNodeStart[commonNodeStart.length - 1].edgeMove;\n        return path.map((chil, j, n) => {\n            chil.parentBase = commonNodeStart[commonNodeStart.length - 1].edgeMove;\n            chil.move = chil.edgeMove - commonNodeStart[commonNodeStart.length - 1].edgeMove;\n            chil.base = (j === 0) ? 0 : n[j - 1].edgeMove - commonNodeStart[commonNodeStart.length - 1].edgeMove;\n            let parentScale = d3.scaleLinear().domain([0, 1]).range([0, 1000])\n            let scaledParentMove = parentScale(commonNodeStart[commonNodeStart.length - 1].edgeMove);\n            chil.xScale = d3.scaleLinear().domain([0, max]).range([0, (1000 - scaledParentMove)]);\n            chil.level = i;\n            return chil;\n        });\n    });\n\n    return commonNodeStart;\n}\nexport function sortOtherPaths(pathData, otherPaths, commonNode) {\n\n    if(pathData.length > 1){\n\n        if(commonNode != null){\n\n            let chosenPath = commonNode.reverse().map(m => m.node);\n            let rankedPaths = otherPaths.map(path => {\n                let step = 0;\n                let test = path.reverse().map((node, i) => {\n                    if (chosenPath.indexOf(node.node));\n                    return { 'indexOf': chosenPath.indexOf(node.node), 'pathIndex': i, 'node': node, 'chosen': chosenPath[chosenPath.indexOf(node.node)] };\n                }).filter(f => f.indexOf > -1);\n                let distance = (test[0].indexOf + test[0].pathIndex);\n                return { 'data': path.reverse(), 'distance': distance };\n            });\n            let sortedData = rankedPaths.sort(function(a, b) { return a.distance - b.distance; });\n        \n            return sortedData;\n        }\n        console.error('multiple paths without common node');\n    }else{\n\n        let chosenPath = pathData[0].reverse().map(m => m.node);\n    \n        let rankedPaths = otherPaths.map(path => {\n            let step = 0;\n            let test = path.reverse().map((node, i) => {\n                if (chosenPath.indexOf(node.node));\n                return { 'indexOf': chosenPath.indexOf(node.node), 'pathIndex': i, 'node': node, 'chosen': chosenPath[chosenPath.indexOf(node.node)] };\n            }).filter(f => f.indexOf > -1);\n            let distance = (test[0].indexOf + test[0].pathIndex);\n            return { 'data': path.reverse(), 'distance': distance };\n        });\n        let sortedData = rankedPaths.sort(function(a, b) { return a.distance - b.distance; });\n        return sortedData;\n    }\n\n}\nfunction renderSelectedTopology(commonNodeStart, svg, scales, branchFrequency){\n\n        let selectWrap = svg.append('g').classed('select-wrap', true);\n        selectWrap.attr('transform', 'translate(0, 20)')\n\n        ///Scales for circles ///\n        let circleScale = d3.scaleLog().range([6, 14]).domain([1, d3.max(Object.values(branchFrequency))]);\n\n        let selectedGroups = selectWrap.selectAll('.paths').data([commonNodeStart]).join('g').classed('paths', true);\n\n        let pathBars = selectedGroups.append('rect').classed('path-rect', true);\n        pathBars.attr('y', -8);\n        pathBars.attr('height', (35 + (25 * commonNodeStart[commonNodeStart.length - 1].children.length)));\n\n        //////////\n        ///Selecting species\n        /////////\n        addRemoveBubble(selectedGroups, scales)\n\n        /////////\n        let timelines = selectedGroups.append('g').classed('time-line', true);\n        timelines.attr('transform', (d, i) => 'translate(145, 0)');\n\n        let lines = timelines.append('line')\n            .attr('x1', 0)\n            .attr('x2', (d, i) => {\n                let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n                return x(d[d.length - 1].edgeMove)\n            })\n            .attr('y1', 15)\n            .attr('y2', 15);\n\n        let nodeGroups = timelines.selectAll('.node').data((d) => d).join('g').classed('node', true);\n\n        nodeGroups.attr('transform', (d) => {\n            let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n            let distance = x(d.edgeMove);\n            return 'translate(' + distance + ', 10)';\n        });\n\n        nodeGroups.classed('common-node', true);\n\n        let childNodeWrap = nodeGroups.filter(c => c.children != undefined).selectAll('g.child').data(d => d.children).join('g').classed('child', true);\n\n        let childNodes = childNodeWrap.selectAll('g.node').data(d => d).join('g').classed('node', true)\n        childNodes.attr('transform', (d, i, n) => {\n            return 'translate(' + d.xScale(d.move) + ', ' + (d.level * 20) + ')';\n        });\n\n        childNodeWrap.append('path').attr('d', (d, i, n) => {\n            let pathArray = [{ 'x': 0, 'y': 0 }, { 'x': 0, 'y': i }];\n            d.map(m => {\n                pathArray.push({ 'x': m.xScale(m.move), 'y': m.level })\n            });\n            let line = d3.line()\n                .curve(d3.curveMonotoneY)\n                .x(function(d) {\n                    return d.x;\n                })\n                .y(d => (d.y * 20))\n            return line(pathArray);\n        }).attr('stoke-width', '2px').attr('fill', 'none').attr('stroke', 'gray');\n\n        childNodeWrap.on('mouseover', (d, i)=> {\n            let specArray = d.map(m=> m.species);\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            let commonHover = [...commonNodeStart].map(c=> c.node).concat(d.map(n=> n.node));\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let treeLinks  = d3.select('#sidebar').selectAll('.link');\n            treeNode.filter(f => commonHover.indexOf(f.data.node) > -1).classed('hover', true);\n            treeLinks.filter(f => commonHover.indexOf(f.data.node) > -1).classed('hover', true);\n            return hovers.classed('hover-branch', true);\n        }).on('mouseout', (d, i)=> {\n            d3.selectAll('.hover').classed('hover', false);\n        });\n\n        let circle = nodeGroups.append('circle').attr('cx', 0).attr('cy', 0).attr('r', d => {\n            return circleScale(branchFrequency[d.node]);\n        }).attr('class', (d, i) => 'node-' + d.node);\n\n        let childCirc = childNodes.append('circle').attr('r', 7).attr('fill', 'red').attr('y', 5);\n\n        childCirc.on('mouseover', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let selectedBranch = treeNode.filter(f => f.data.node === d.node).classed('selected-branch', true);\n            return hovers.classed('hover-branch', true);\n        }).on('mouseout', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            d3.selectAll('.selected-branch').classed('selected-branch', false);\n            return hovers.classed('hover-branch', false);\n        });\n\n        childNodes.filter(f => f.leaf === true).append('text').text(d => d.label).attr('x', 9).attr('y', 4);\n        //selectWrap.attr('transform', 'translate('+(50+(20 *commonNodeStart[commonNodeStart.length - 1].children.length))+')')\n       \n\n}\nexport function addRemoveBubble(group, scales){\n\n    let pathRemove = group.append('g').classed('x-icon', true);\n    pathRemove.attr('transform', 'translate(15, 10)');\n    pathRemove.append('circle').attr('r', 7).attr('fill', '#fff');\n    pathRemove.append('text').text('x').attr('transform', 'translate(-5, 5)');\n    pathRemove.style('cursor', 'pointer');\n    pathRemove.on('click', (d, i, n) => {\n        d3.selectAll('.high').classed('high', false);\n        d3.selectAll('.low').classed('low', false);\n        treeNodes.select('.selected').classed('selected', false);\n        pathSelected(null, dataMaster[0], scales);\n    });\n\n}\nexport function renderComparison(group, otherPaths, selectedDiv, scales){\n \n    let buttonGroupTest = selectedDiv.select('.button-wrap');\n    let buttonGroup = buttonGroupTest.empty() ? selectedDiv.append('div').classed('button-wrap', true) : buttonGroupTest;\n\n\n    \n    buttonGroup.style('display','inline-block').style('width', '900px').style('height', '50px');\n    let main = d3.select('div#main');\n    main.style('padding-top', '300px');\n\n    if(group != null){\n        let usedColors = comparisonKeeper.map(m=> m.groupColor);\n        let newColor = colorKeeper.find(c => usedColors.indexOf(c[0]) === -1);\n        group.groupColor = newColor[0];\n        comparisonKeeper.push(group);\n    }\n\n    if(comparisonKeeper.length > 1){\n        let compareButtonTest = d3.select('#toolbar').select('#compare-button');\n        let compareButton = compareButtonTest.empty() ? d3.select('#toolbar').append('button').text('Normal Mode').attr('id', 'compare-button').classed('btn btn-info', true) : compareButtonTest;\n        compareButton.on('click', ()=> {\n            compareButton.text() === \"Normal Mode\" ? compareButton.text('Compare Mode') : compareButton.text('Normal Mode');\n            renderComparison(null, otherPaths, selectedDiv, scales);\n        });\n    }\n\n    let comparisonCombined = scales.map((sc, i)=> {\n        let newAtt = {'field': sc.field, 'type': sc.type, 'data': []}\n        comparisonKeeper.map((com, i)=> {\n            let atts = formatAttributeData(com.data, scales, [sc.field]);\n           \n            let added = atts.flatMap(att=> {\n                return att.map(a => {\n                    return a.map(m=> {\n                        let standard = m.leaf === true ? 0 : (m.upperCI95 - m.realVal) / 2;\n                        m.variance = standard * standard;\n                        return m;\n                    });\n                })\n            })\n\n            newAtt.data.push({'group': {'first': com.first, 'second': com.second, 'color': com.groupColor}, 'data': sc.type === 'continuous' ? added : atts.flatMap(a=> a)});\n        })\n        return newAtt;\n    });\n\n    let button = buttonGroup.selectAll('button').data(comparisonKeeper).join('button').classed('btn btn-info', true).style('background', d=> d.groupColor);\n    button.selectAll('span').data(t=> [t]).join('span').text(t=> {\n        return t.first ? `${t.first[1]} / ${t.second[1]}` : t.state;\n    }).append('span').text(t=> t.data.length).classed(\"badge badge-light\", true)\n    \n    let xOut = button.selectAll('i').data(d=> [d]).join('i').classed('close fas fa-times', true).style('padding-left', '10px');\n    xOut.on('click', (d, i)=> {\n        let filteredComp = comparisonKeeper.filter(f=> f.groupColor != d.groupColor);\n        comparisonKeeper = filteredComp;\n        if(comparisonKeeper.length > 0){\n            renderComparison(null, otherPaths, selectedDiv, scales);\n        }else{\n            selectedDiv.selectAll('*').remove();\n            selectedDiv.style('height', '0px');\n            main.style('padding-top', '0px');\n        }\n    });\n\n    let selectedTest = selectedDiv.select('.comparison-svg');\n    let selectedTool = selectedTest.empty() ? selectedDiv.append('svg').classed('comparison-svg', true) : selectedTest;\n    selectedDiv.style('height', '300px').style('width', '100%');\n    selectedTool.style('height', '300px');\n\n    let attWraps = selectedTool.selectAll('.att-wrapper').data(comparisonCombined.filter(f=> f.type === 'continuous').map((com)=>{\n       \n        let max = d3.max(com.data.flatMap(d=> d.data.flatMap(m=> m.map(f=> f.upperCI95)))) + .2;\n        let min = d3.min(com.data.flatMap(d=> d.data.flatMap(m=> m.map(f=> f.lowerCI95)))) - .2;\n        \n        com.data.map(c=> {\n            let binLength = 6;\n            //let max = scales.filter(f=> f.field === com.field)[0].max;\n           // let min = scales.filter(f=> f.field === com.field)[0].min;\n            let normBins = new Array(binLength).fill().map((m, i)=> {\n                let step = 1 / binLength;\n                let base = (i * step);\n                let top = ((i+ 1)* step);\n                return {'base': base, 'top': top, 'binI': i, 'max': max, 'min':min }\n            });\n\n            let internalNodes = c.data.map(path => path.filter(node=> node.leaf != true));\n            let leafNodes = c.data.flatMap(path => path.filter(node=> node.leaf === true));\n\n            c.bins = normBins.map((n, i, nodes)=> {\n                let edges = internalNodes.flatMap(path => path.filter(node=> {\n                    return node.edgeMove >= n.base && node.edgeMove <= n.top;\n                } ));\n                n.data = edges;\n                let mean = d3.mean(edges.map(e=> e.realVal));\n                n.mean = mean === undefined ? normBins[i-1].mean : mean;\n                let standard = Math.sqrt(d3.mean(edges.map(e=> e.variance)));\n                n.meanStandard = edges.length === 0 ? 0 : standard;\n                let sigma2 = standard * 2;\n                n.upCon95 = mean === undefined ? normBins[i-1].upCon95 : mean + sigma2;\n                n.lowCon95 = mean === undefined ? normBins[i-1].lowCon95 : mean - sigma2;\n                return n;\n            });\n            c.leaves = leafNodes;\n           \n            return c;\n        })\n        \n        return com;\n    }));\n    attWraps.exit().remove();\n    let attWrapsEnter = attWraps.enter().append('g').classed('att-wrapper', true);\n\n    let attLabels = attWrapsEnter.append('text').text(d=> d.field).style('text-anchor', 'end')\n                    .style('font-size', '11px').attr('transform', 'translate(120, 35)');\n\n    attWraps = attWrapsEnter.merge(attWraps);\n    attWraps.attr('transform', (d, i)=> 'translate(0,'+(10+(i * 70))+')');\n\n    let innerWrap = attWraps.selectAll('g.inner-group').data(d=> [d]).join('g').classed('inner-group', true);\n    innerWrap.attr('transform', 'translate(150, 0)');\n    let wrapRect = innerWrap.selectAll('rect.outline-rect').data(d=> [d]).join('rect').classed('outline-rect', true)\n                    .attr('width', 800).attr('height', 60).attr('fill', '#fff').attr('stroke', 'gray');\n    \n    if(d3.select('#compare-button').empty() || d3.select('#compare-button').text() === \"Normal Mode\"){\n            let lineGen = d3.line()\n            .x((d, i)=> {\n                let x = d3.scaleLinear().domain([0, 5]).range([0, 800]);\n                return x(i);\n            })\n            .y(d=> {\n            let y = d3.scaleLinear().domain([d.min, d.max])\n                y.range([60, 1]);\n                return y(d.mean);\n    });\n\n    let pathGroups = innerWrap.selectAll('g.path-groups').data(d=> d.data).join('g').classed('path-groups', true);\n    pathGroups.selectAll('*').remove();\n    let paths = pathGroups.append('path').attr('d', d=> { \n        let scale = d.bins[0].data[0].yScale\n        d.bins = d.bins.map((b, i, n)=> {\n            if(b.mean === undefined){\n                b.mean = d.bins[i-1].mean;\n                d.missing = true;\n            }\n           \n            b.yScale = d3.scaleLinear().domain([b.min, b.max]).range([60, 1])\n            return b;\n        });\n        return lineGen(d.bins);\n    }).classed('path', true);\n\n    var areaG = d3.area()\n    .curve(d3.curveCardinal)\n    .x((d, i)=> {\n        let x = d3.scaleLinear().domain([0, 5]).range([0, 800]);\n        return x(i);\n    })\n    .y0(d=> {\n        let y = d.yScale;\n        y.range([60, 1]);\n     \n        return y(d.lowCon95);\n    })\n    .y1(d=> {\n        let y = d.yScale;\n        y.range([60, 1]);\n     \n        return y(d.upCon95); \n    });\n\n    let confGroups = innerWrap.selectAll('g.conf-groups').data(d=> d.data).join('g').classed('conf-groups', true);\n    confGroups.selectAll('*').remove();\n    let conf = confGroups.append('path').attr('d', d=> { \n        d.bins = d.bins.map((b, i, n)=> {\n            if(b.upCon95 === NaN){\n                b.upCon95 = d.bins[i-1].upCon95;\n                d.missing = true;\n            }\n            if(b.lowCon95 === NaN){\n                b.lowCon95 = d.bins[i-1].lowCon95;\n                d.missing = true;\n            }\n\n            return b;\n        });\n        return areaG(d.bins);\n    }).classed('path', true);\n\n    paths.style('fill', 'none');\n    paths.style('stroke', d=> d.group.color);\n    paths.style('stroke-width', '2px');\n\n    conf.style('fill', d=> d.group.color);\n    conf.style('opacity', 0.15);\n\n    let yAxisG = innerWrap.append('g').classed('y-axis', true);\n\n    innerWrap.on('mousemove', function(d, i) {\n     \n        let scale = d3.scaleLinear().domain([d.data[0].bins[0].min, d.data[0].bins[0].max]).range([1, 60]);\n        let axisGroupTest = d3.select(this).select('.y-axis');\n        let axisGroup = axisGroupTest.empty() ? d3.select(this).append('g').classed('y-axis', true) : axisGroupTest;\n        \n        if(d3.select('#compare-button').empty() || d3.select('#compare-button').text()==='Normal Mode'){\n            axisGroup.attr('transform', (d, i)=> 'translate('+(d3.mouse(this)[0] - 10)+',0)')\n            axisGroup.call(d3.axisLeft(scale).ticks(5));\n        }else{\n            let pathD = d3.select(this).select('.path-groups').selectAll('path');\n            let maxDiff = pathD.data().map(d=> d[0].maxDiff)[0];\n            \n            axisGroup.attr('transform', (d, i)=> 'translate('+(d3.mouse(this)[0] - 10)+',0)');\n            let newScale = d3.scaleLinear().domain([maxDiff, 0]).range([0, 60]);\n            axisGroup.call(d3.axisLeft(newScale).ticks(5));\n        }\n\n    \n    }).on('mouseleave', function(){\n        let axisGroup = d3.select(this).select('.y-axis');\n        axisGroup.remove();\n    });\n    \n}else{\n\n    innerWrap.selectAll('.path-groups').remove();\n    innerWrap.selectAll('g.conf-groups').remove();\n    let pathGroups = innerWrap.selectAll('g.path-groups').data(d=> {\n        let startBins = d.data[0].bins;\n        let difArray = [];\n        for(let i = 1; i < d.data.length; i ++){\n            let diffs = []\n            d.data[i].bins.map((b, j)=>{\n                if(b.mean === undefined){\n                    b.mean = d.data[i].bins[j-1].mean;\n                }\n                if(startBins[j].mean === undefined){\n                    startBins[j].mean = startBins[j-1].mean;\n                }\n                let maxDiff = d.data[0].bins[0].max - d.data[0].bins[0].min;\n                diffs.push({'diff':Math.abs(startBins[j].mean - b.mean), 'maxDiff': maxDiff});\n            });\n            difArray.push(diffs);\n        }\n        return difArray;\n    }).join('g').classed('path-groups', true);\n\n    let lineGen = d3.line()\n        .x((d, i)=> {\n            let x = d3.scaleLinear().domain([0, 5]).range([0, 800]);\n            return x(i);\n        })\n        .y(d=> {\n            let y = d3.scaleLinear().domain([0, d.maxDiff]).clamp(true);\n            y.range([60, 0]);\n            return y(d.diff);\n        });\n\n    let paths = pathGroups.append('path').attr('d', d=> { \n        return lineGen(d);\n    });\n\n    paths.style('fill', 'none');\n    paths.style('stroke', 'black');\n    paths.style('stroke-width', '2px');\n}\n\n/////////////////////////\nlet obsDistWrap = attWraps.selectAll('.observed-dist-wrap').data(d=> {\n  \n        let max = d3.max(d.data.flatMap(f=> f.leaves.map(m=> m.realVal)));\n        let min = d3.min(d.data.flatMap(f=> f.leaves.map(m=> m.realVal)));\n\n        let x = d3.scaleLinear().domain([min, max]).range([0, 200]);\n    \n        let histogram = d3.histogram()\n        .value(function(d) { return d.realVal; })  \n        .domain(x.domain())  \n        .thresholds(x.ticks(10)); \n        \n        let leafData = d.data.map(m=> {\n            let newLeaves = [...m.leaves].map(leaf => {\n                leaf.x = x;\n                leaf.group = m.group;\n                return leaf;\n            });\n            return {'binData':histogram(m.leaves), 'data': newLeaves, 'group': m.group, 'xScale': x};\n        });\n        return [{'data':leafData, 'xScale': x}];\n    }).join('g').classed('observed-dist-wrap', true);\n\n    obsDistWrap.attr('transform', 'translate(970, 0)');\n  \n    let xAxis = obsDistWrap.selectAll('g.axis-x').data(d=> [d]).join('g').classed('axis-x', true);\n    xAxis.attr('transform', 'translate(0, 50)')\n    xAxis.each((d, i, nodes)=> {\n        d3.select(nodes[i]).call(d3.axisBottom(d.xScale).ticks(5))\n    });\n\n    let distGroups = obsDistWrap.selectAll('.observed-group').data(d=> {\n        return d.data.map((m, i, n)=> {\n            m.index = i;\n            m.groupLength = n.length;\n            return m;\n        });\n    }).join('g').classed('observed-group', true);\n\n    let lines = distGroups.selectAll('.line').data(d => {\n            let mean = d3.mean(d.data.map(r=> r.realVal))\n            let vals = {'mean': mean, 'group':d.group, 'x':d.xScale}\n            return [vals];\n    }).join('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.mean)-1.5)+',0)')\n    .attr('height', 50).attr('width', 3).attr('fill', d=> d.group.color).style('opacity', '0.4')\n\n    let circWrap = distGroups.selectAll('.circ-wrap').data((d, i)=> [d]).join('g').classed('circ-wrap', true).attr('transform', (d, i, n)=> {\n        let move = d3.scaleLinear().domain([0, d.groupLength]).range([0, 60]);\n        return 'translate(0,'+(move(d.index+0.5))+')'});\n\n    let distCirc = circWrap.selectAll('circle.disDots').data(d=> d.data).join('circle').attr('r', 3)\n    .attr('cx', (d, i) => {\n        return d.x(d.realVal);\n    }).attr('cy', (d, i, n)=> {\n        return 0;\n    }).attr('fill', d=> d.group.color);\n}\nexport function renderSelectedView(pathData, otherPaths, selectedDiv, scales) {\n\n    let attributeHeight = 50;\n\n    let selectedSpecies = pathData.flatMap(p => p.filter(f => f.leaf === true).map(n => n.node));\n    let treeNodes = d3.select('#sidebar').select('svg').selectAll('.node');\n    treeNodes.filter(node => selectedSpecies.indexOf(node.data.node) > -1).classed('selected', true);\n\n    ////FILTER MASTER TO HIDE ATTRIBUTES THAT ARE DESELECTED FROM FILTERBAR\n    let attrHide = filterMaster.filter(f => f.type === 'hide-attribute').length > 0 ? filterMaster.filter(f => f.type === 'hide-attribute').map(m => m.attribute) : [];\n    let attrFilter = attrHide.length > 0 ? scales.filter(sc => {\n        return attrHide.indexOf(sc.field) === -1;\n    }).map(m => m.field) : null;\n\n    ////IF THE SELECTED DIV IS THERE ALREADY USE THAT/////\n    let selectedToolTest = selectedDiv.select('.selected-toolbar');\n    let selectedTool = selectedToolTest.empty() ? selectedDiv.append('div').classed('selected-toolbar', true) : selectedToolTest;\n    selectedTool.selectAll('*').remove();\n\n    ///////////////////////\n    let sortByDistanceDiv = selectedTool.append('div').style('display', 'inline-block');\n    sortByDistanceDiv.append('text').text('Topology: ');\n    let sortByDistanceButton = sortByDistanceDiv.append('button').classed('btn btn-secondary btn-sm', true);\n    sortByDistanceButton.text('Sort Most to Least');\n    sortByDistanceButton.on('click', () => sortPaths(sortByDistanceButton));\n\n    /////////////Sorting by attribute///////////////\n    let attrKeys = scales.map(m => m.field);\n    let attrSortWrap = selectedTool.append('div').style('display', 'inline-block');\n    attrSortWrap.append('h6').text('Sort by: ').style('display', 'inline');\n\n    let radioDiv = attrSortWrap.selectAll('div.attr-radio').data(attrKeys).join('div').classed('attr-radio form-check form-check-inline', true);\n    let radio = radioDiv.append('input').attr('type', 'radio').property('name', 'attribute-radio-sort').property('value', d => d).attr('id', (d, i) => 'radio-' + i).classed(\"form-check-input\", true);\n    radioDiv.append('label').text(d => d).property('for', (d, i) => 'radio-' + i).classed(\"form-check-label\", true);\n\n    let svgTest = selectedDiv.select('svg.select-svg');\n    let svg = svgTest.empty() ? selectedDiv.append('svg').classed('select-svg', true) : svgTest;\n\n    svg.selectAll('*').remove();\n\n    let branchFrequency = pathData.flatMap(row => row.flatMap(f => f.node)).reduce(function(acc, curr) {\n        if (typeof acc[curr] == 'undefined') {\n            acc[curr] = 1;\n        } else {\n            acc[curr] += 1;\n        }\n        return acc;\n    }, {});\n\n    ///RENDERING SELECTED PATHS////\n    if (pathData.length === 1) {\n\n        /////////////////////////////////////////////////\n        let selectWrap = svg.append('g').classed('select-wrap', true);\n        selectWrap.attr('transform', (d, i) => 'translate(0,20)');\n\n        ///Scales for circles ///\n        let circleScale = d3.scaleLog().range([6, 14]).domain([1, d3.max(Object.values(branchFrequency))]);\n\n        let selectedGroups = selectWrap.selectAll('.paths').data(pathData).join('g').classed('paths', true);\n\n        let pathBars = selectedGroups.append('rect').classed('path-rect', true);\n        pathBars.attr('y', -8);\n\n        //////////\n        ///Selecting species\n        /////////\n        addRemoveBubble(selectedGroups, scales)\n\n        /////////\n        selectedGroups.on('mouseover', function(d, i) {\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let treeLinks = d3.select('#sidebar').selectAll('.link');\n            treeNode.filter(f => {\n                return d.map(m => m.node).indexOf(f.data.node) > -1;\n            }).classed('hover', true);\n            treeLinks.filter(f => d.map(m => m.node).indexOf(f.data.node) > -1).classed('hover', true);\n            return d3.select(this).classed('hover', true);\n        }).on('mouseout', function(d, i) {\n            let treeNode = d3.select('#sidebar').selectAll('.node').classed('hover', false);\n            let treeLinks = d3.select('#sidebar').selectAll('.link').classed('hover', false);\n            return d3.select(this).classed('hover', false);\n        });\n\n        let speciesTitle = selectedGroups.append('text').text(d => {\n            let string = d.filter(f => f.leaf === true)[0].label;\n            return string.charAt(0).toUpperCase() + string.slice(1);\n        });\n\n        speciesTitle.attr('x', 25).attr('y', 15);\n\n        let timelines = selectedGroups.append('g').classed('time-line', true);\n        timelines.attr('transform', (d, i) => 'translate(150, 0)');\n\n        let lines = timelines.append('line')\n            .attr('x1', 0)\n            .attr('x2', 1000)\n            .attr('y1', 15)\n            .attr('y2', 15);\n\n        let nodeGroups = timelines.selectAll('.node').data((d) => d).join('g').classed('node', true);\n\n        nodeGroups.attr('transform', (d) => {\n            let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n            let distance = x(d.edgeMove);\n            return 'translate(' + distance + ', 10)';\n        });\n\n        let circle = nodeGroups.append('circle').attr('cx', 0).attr('cy', 0).attr('r', d => {\n            return circleScale(branchFrequency[d.node]);\n        }).attr('class', (d, i) => 'node-' + d.node);\n\n        circle.on('mouseover', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let selectedBranch = treeNode.filter(f => f.data.node === d.node).classed('selected-branch', true);\n            return hovers.classed('hover-branch', true);\n        }).on('mouseout', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            d3.selectAll('.selected-branch').classed('selected-branch', false);\n            return hovers.classed('hover-branch', false);\n        });\n\n        let speciesNodeLabel = nodeGroups.filter(f => f.label != undefined).append('text').text(d => {\n            let string = d.label.charAt(0).toUpperCase() + d.label.slice(1);\n            return string;\n        }).attr('x', 10).attr('y', 5);\n\n        selectedGroups.attr('transform', (d, i) => 'translate(0,' + (i * 60) + ')');\n\n        let nodes = selectedGroups.select('.time-line').selectAll('.node');\n        nodes.on('mouseover', (d, i) => {\n\n            let nearest = otherPaths.filter(path => {\n                let nodearray = path.flatMap(f => f.node);\n                return nodearray.indexOf(d.node) > -1;\n            });\n\n            let nearestA = nearest[0];\n            let nearestB = nearest[1];\n           \n        });\n\n        //////PLAYING WITH FUNCTION TO CALULATE DISTANCES\n\n        /// LOWER ATTRIBUTE VISUALIZATION ///\n        let attributeWrapper = selectedGroups.append('g').classed('attribute-wrapper', true);\n        let attData = formatAttributeData(pathData, scales, attrFilter);\n        let attributeGroups = renderAttributes(attributeWrapper, attData, scales, null);\n\n        selectedGroups.attr('transform', (d, i) => 'translate(10,' + (i * ((attributeHeight + 5) * (Object.keys(d[1].attributes).length + 1))) + ')');\n\n        drawContAtt(attributeGroups);\n        drawDiscreteAtt(attributeGroups, scales, false, false);\n\n        //sizeAndMove(svg, attributeWrapper, pathData, (attrMove * attributeHeight));\n        //tranforming elements\n        svg.style('height', ((pathData.length + attributeGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        selectedDiv.style('height', ((pathData.length + attributeGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        attributeWrapper.attr('transform', (d) => 'translate(140, 25)');\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        ////RADIO BUTTON THAT COLORS BASE DON ATTRIBUTE VALUE////\n        radio.on('click', (d, i) => {\n            let leaf = pathData.map(node => node.filter(d => d.leaf === true)[0])[0];\n            let sorted = [...otherPaths].sort(function(a, b) {\n                return a.filter(n => n.leaf === true)[0].attributes[d].realVal - b.filter(n => n.leaf === true)[0].attributes[d].realVal;\n            });\n    \n            let main = d3.select('div#main');\n            /// LOWER ATTRIBUTE VISUALIZATION ///\n            drawPathsAndAttributes(sorted.reverse(), main, scales);\n            main.style('padding-top', '250px');\n    \n            let paths = main.select('svg#main-path-view').selectAll('.paths');\n    \n            let high = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal > leaf.attributes[d].realVal;\n            });\n            high.classed('high', true);\n    \n            let highLeaves = high.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => highLeaves.indexOf(f.data.node) > -1).classed('high', true);\n    \n            let low = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal < leaf.attributes[d].realVal;\n            });\n            low.classed('low', true);\n    \n            let lowLeaves = low.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => lowLeaves.indexOf(f.data.node) > -1).classed('low', true);\n    \n            let same = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal === leaf.attributes[d].realVal;\n            });\n            same.classed('same', true);\n        });\n      \n        return pathData;\n\n    } else if(pathData.length > 1 && pathData.length < 5) {\n       \n        let commonNodeStart = getCommonNodes(pathData);\n        renderSelectedTopology(commonNodeStart, svg, scales, branchFrequency);\n\n        /////END PATH RENDER///////\n        let attWrap = svg.append('g').classed('attribute-wrapper', true);\n        let attributeData = commonNodeStart[commonNodeStart.length - 1].children.map(ch => {\n            return [...commonNodeStart].concat(ch);\n        });\n\n        let attData = formatAttributeData(pathData, scales, attrFilter);\n        let attDataComb = attData[0].map((att, i)=> {\n            let species = pathData[0].filter(f=> f.leaf === true)[0].label;\n            att[att.length - 1].offset = 0;\n            let attribute = {'label': att[att.length-1].label, 'type':att[att.length-1].type, 'data': [{'species': species, 'paths': att}]}\n            for(let index = 1; index < attData.length; index++ ){\n                let species = pathData[index].filter(f=> f.leaf === true)[0].label;\n                let last = attData[index][i].length - 1\n                attData[index][i][last].offset = (index * 8);\n                attribute.data.push({'species': species, 'paths': attData[index][i]})\n            }\n            return attribute;\n        });\n\n        function findMaxState(states, offset){\n            let maxP = d3.max(states.map(v=> v.realVal));\n            let notMax = states.filter(f=> f.realVal != maxP);\n            let winState = states[states.map(m=> m.realVal).indexOf(maxP)]\n            winState.other = notMax;\n            winState.offset = offset;\n    \n            return winState;\n        }\n\n       let mappedDis = attDataComb.map(dis=> {\n           dis.data = dis.data.map((spec, i)=> {\n               spec.paths = spec.paths.map(m=> {\n                if(dis.type === 'discrete'){\n                    let offset = 5 * i;\n                    let maxProb = m.states? {'realVal': 1.0, 'state': m.winState, 'color':m.color, 'edgeMove': m.edgeMove, 'offset':m.offset, 'leaf': true} : findMaxState(m, offset); \n                    return maxProb;\n                }else{\n                    return m;\n                }\n            });\n            return spec;\n           });\n           return dis;\n       });\n\n       let attGroups = attWrap.selectAll('g').data(mappedDis).join('g').classed('attr', true);\n       attGroups.attr('transform', (d, i) => 'translate(145,' + (i * (attributeHeight + 10)) + ')');\n\n       attGroups.append('text')\n        .text(d=> d.label)\n        .style('text-anchor', 'end')\n        .style('font-size', 11)\n        .attr('transform', 'translate(0,'+(attributeHeight/2)+')');\n\n       let wrapRect = attGroups.append('rect').attr('width', 1010);\n       wrapRect.attr('height', attributeHeight);\n       wrapRect.style('fill', '#fff');\n       wrapRect.style('stroke', 'gray');\n       wrapRect.style('opacity', 0.5);\n\n       attGroups.append('line').classed('half', true).attr('x1', 0).attr('y1', 22).attr('x2', 1010).attr('y2', 22);\n     \n       let speciesGrp = attGroups.selectAll('g').data(d=> {\n            d.data = d.data.map(m=> {\n                m.type = d.type;\n                return m;\n            });\n            return d.data;\n        }).join('g').classed('species', true);\n\n       let lineGenD = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n           let distance = d.edgeMove;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight-2, 1]);\n           return y(d.realVal) + d.offset;\n       });\n\n       let lineGenC = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n           let distance = d.edgeMove;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d.yScale;\n           y.range([attributeHeight-2, 1]);\n           return y(d.realVal) + 2;\n       });\n\n       let innerStatePaths = speciesGrp.append('path')\n       .attr(\"d\", d=> {\n            return (d.type === 'discrete') ? lineGenD(d.paths) : lineGenC(d.paths);\n        })\n       .attr(\"class\", (d, i)=> {\n            return d.species + \" inner-line\"})\n       .style('stroke-width', 0.7)\n       .style('fill', 'none')\n       .style('stroke', 'gray');\n\n       innerStatePaths.on('mouseover', (d, i, n)=> {\n           d3.select(n[i]).classed('selected', true);\n       }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).classed('selected', false);\n       });\n\n       let disGroup = speciesGrp.filter(sp=> {\n        return sp.type === 'discrete';\n        });\n\n       let branchGrpDis = disGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n       branchGrpDis.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n            let distance = x(d.edgeMove);\n            return 'translate('+distance+', 0)';\n        });\n\n        let bCirc = branchGrpDis.append('circle').attr('r', 5).attr('cy', (d, i)=> {\n            let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight - 5, 2]);\n            return y(d.realVal) + d.offset;\n        }).attr('cx', 5);\n\n        bCirc.attr('fill', (d, i)=> d.color);\n\n        let otherCirc = branchGrpDis.filter(f=> f.leaf != true).selectAll('.other').data(d=> d.other).join('circle').classed('other', true);\n        otherCirc.attr('r', 4).attr('cx', 5).attr('cy', (c, i)=> {\n            let y = d3.scaleLinear().domain([1, 0]);\n            y.range([0, (attributeHeight-5)]);\n                return y(c.realVal);\n            }).attr('fill', (c)=> c.color).style('opacity', 0.1);\n\n        otherCirc.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX + 10) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n\n        bCirc.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX + 10) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n        \n        /////AXIS ON HOVER////\n        branchGrpDis.on('mouseover', (d, i, n)=> {\n            let y = d3.scaleLinear().domain([1, 0]);\n            y.range([0, (attributeHeight-5)]);\n            svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n            svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n            d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n            d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n        }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).select('g.y-axis')\n            d3.select(n[i]).select('g.y-axis').remove();\n            d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n            d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n            d3.selectAll('.other').style('opacity', 0.1);\n        });\n\n        let conGroup = speciesGrp.filter(sp=> {\n            return sp.type === 'continuous';\n        });\n\n        let branchGrpCon = conGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n        branchGrpCon.attr('transform', (d)=> {\n         let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n             let distance = x(d.edgeMove);\n             return 'translate('+distance+', 0)';\n         });\n\n         /////AXIS ON HOVER////\n        branchGrpCon.on('mouseover', (d, i, n)=> {\n            let y = d.yScale;\n            y.range([0, (attributeHeight-5)]);\n            svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n            svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n            d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n            d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n        }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).select('g.y-axis')\n            d3.select(n[i]).select('g.y-axis').remove();\n            d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n            d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n            d3.selectAll('.other').style('opacity', 0.1);\n        });\n\n        let MeanRect = branchGrpCon.append('rect');\n   \n        MeanRect.attr('width', 10).attr('height', 3);\n        MeanRect.attr('y', (d, i) => {\n            let scale = scales.filter(s=> s.field === d.label)[0];\n            let y = d3.scaleLinear().domain([scale.min, scale.max]).range([attributeHeight, 0])\n            return y(d.realVal);\n        });\n\n        let confiBars = branchGrpCon.filter(f=> f.leaf != true).append('rect');\n        confiBars.attr('width', 10).attr('height', (d, i)=> {\n            let scale = scales.filter(s=> s.field === d.label)[0];\n            let y = d3.scaleLinear().domain([scale.min, scale.max]).range([attributeHeight, 0]);\n            return y(d.lowerCI95) - y(d.upperCI95);\n        });\n\n        confiBars.attr('y', (d, i)=> {\n            let scale = scales.filter(s=> s.field === d.label)[0];\n            let y = d3.scaleLinear().domain([scale.min, scale.max]).range([attributeHeight, 0]);\n            return y(d.upperCI95);\n        })\n        confiBars.style('opacity', 0.1);\n\n        //tranforming elements\n        svg.style('height', ((pathData.length + attGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        selectedDiv.style('height', ((pathData.length + attGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        attWrap.attr('transform', (d) => 'translate(0, 60)');\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        return commonNodeStart;\n\n\n    }else{\n       \n        /////////\n        //getting common node\n        ///\n\n        let maxBranch = d3.max(pathData.map(p => p.length));\n        let longestBranch = pathData.filter(path => path.length === maxBranch)[0];\n        let startBranch = longestBranch.filter(f=> f.leaf != true);\n        let commonNodeStart = startBranch;\n        //FIND THE COMMON BRANCHES BETWEEN ALL OF THE SELECTED///\n        pathData.map(path => {\n            commonNodeStart = [...path].filter(f => {\n                return (commonNodeStart.map(m => m.node).indexOf(f.node) > -1) & f.leaf != true });\n        });\n\n        svg.remove();\n        let remove = selectedTool.append('g').classed('x-icon', true);\n        remove.attr('transform', 'translate(15, 10)');\n        remove.append('circle').attr('r', 7).attr('fill', '#fff');\n        remove.append('text').text('x').attr('transform', 'translate(-5, 5)');\n        remove.style('cursor', 'pointer');\n        remove.on('click', (d, i, n) => {\n            d3.selectAll('.high').classed('high', false);\n            d3.selectAll('.low').classed('low', false);\n            treeNodes.select('.selected').classed('selected', false);\n            pathSelected(null, dataMaster[0], scales);\n        });        \n\n        /////////\n        renderDistibutions(pathData, selectedDiv, scales);\n        selectedDiv.style('height', '550px');\n\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        ////RADIO BUTTON THAT COLORS BASE DON ATTRIBUTE VALUE////\n        radio.on('click', (d, i) => {\n            let leaf = pathData.map(node => node.filter(d => d.leaf === true)[0])[0];\n            let sorted = [...otherPaths].sort(function(a, b) {\n                return a.filter(n => n.leaf === true)[0].attributes[d].realVal - b.filter(n => n.leaf === true)[0].attributes[d].realVal;\n            });\n    \n            let main = d3.select('div#main');\n            /// LOWER ATTRIBUTE VISUALIZATION ///\n            drawPathsAndAttributes(sorted.reverse(), main, scales);\n            main.style('padding-top', '250px');\n    \n            let paths = main.select('svg#main-path-view').selectAll('.paths');\n    \n            let high = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal > leaf.attributes[d].realVal;\n            });\n            high.classed('high', true);\n    \n            let highLeaves = high.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => highLeaves.indexOf(f.data.node) > -1).classed('high', true);\n    \n            let low = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal < leaf.attributes[d].realVal;\n            });\n            low.classed('low', true);\n    \n            let lowLeaves = low.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => lowLeaves.indexOf(f.data.node) > -1).classed('low', true);\n    \n            let same = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal === leaf.attributes[d].realVal;\n            });\n            same.classed('same', true);\n        });\n        //tranforming elements\n        svg.style('height', ((pathData.length + attributeGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        selectedDiv.style('height', ((pathData.length + attGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        attWrap.attr('transform', (d) => 'translate(140, 25)');\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        return commonNodeStart;\n    }\n    \n}\n\nfunction sortPaths(sortButton) {\n    if (sortButton.text() === 'Sort Most to Least') {\n        sortButton.text('Sort Least to Most');\n    } else {\n        sortButton.text('Sort Most to Least');\n    }\n}","import * as d3 from \"d3\";\n\nexport function dropDown(div, optionArray, dropText, dropId){\n    let dropdiv = div.append('div').classed(`dropdown ${dropId}`, true);\n    dropdiv.style('display', 'inline-block')\n    let button = dropdiv.append('button').classed('btn dropbtn btn-secondary dropdown-toggle', true).text(dropText);\n    let dropContent = dropdiv.append('div').attr('id', dropId).classed('dropdown-content', true);\n    dropContent.append('a').text('text').attr('font-size', 11);\n    let options = dropContent.selectAll('a').data(optionArray).join('a').text(d=> d.field);\n\n    options.on('click', (d, i, n)=> dropContent.classed('show', false));\n\n    button.on('click', (d, i, n)=> {\n        if(dropContent.classed('show')){\n            dropContent.classed('show', false);\n        }else{\n            dropContent.classed('show', true);\n        }\n    });\n    options.raise()\n    return options;\n}\n\nexport function updateDropdown(optionArray, dropId){\n    d3.select(`#${dropId}`).selectAll('a').data(optionArray).join('a').text(d=> d.field);\n}","import '../styles/index.scss';\nimport * as d3 from \"d3\";\nimport * as d3Array from 'd3-array'\nimport {pathSelected, renderComparison} from './selectedPaths';\nimport {formatAttributeData, maxTimeKeeper} from './dataFormat';\nimport {filterMaster, nodeFilter, getLatestData, leafStateFilter, getScales} from './filterComponent';\nimport { drawBranchPointDistribution } from './distributionView';\nimport { dropDown } from './buttonComponents';\nimport { groupedView } from './viewControl';\n\nconst dimensions = {\n    rectWidth: 15,\n    rectHeight: 40,\n    collapsedHeight: 20,\n}\n\nexport function drawPathsAndAttributes(pathData, main){\n\n    let scales = getScales();\n\n    let nodeTooltipFlag = true;\n\n    let collapsed = d3.select('#scrunch').attr('value');\n  \n    main.select('#main-path-view').selectAll('*').remove();\n\n    let pathGroups = renderPaths(pathData, main);\n  \n      /// LOWER ATTRIBUTE VISUALIZATION ///\n    let attributeWrapper = pathGroups.append('g').classed('attribute-wrapper', true);\n  \n    let shownAttributes = d3.select('#attribute-show').selectAll('input').filter((f, i, n)=> n[i].checked === true).data();\n\n    let attData = formatAttributeData(pathData, scales, shownAttributes);\n\n    let predictedAttrGrps = renderAttributes(attributeWrapper, attData, collapsed);\n    let attributeHeight = (collapsed === 'true')? 22 : 45;\n    pathGroups.attr('transform', (d, i)=> 'translate(10,'+ (i * ((attributeHeight + 5)* (shownAttributes.length + 1))) +')');\n    \n    let cGroups = drawContAtt(predictedAttrGrps, collapsed);\n    let dGroups = drawDiscreteAtt(predictedAttrGrps, collapsed, false);\n    sizeAndMove(main.select('#main-path-view'), attributeWrapper, pathData, (shownAttributes.length * attributeHeight));\n\n    let leafStates = d3.selectAll('.discrete-leaf');\n    leafStates.on('click', (d, i)=> {\n        if(nodeTooltipFlag){\n            nodeTooltipFlag = false;\n            d3.select(\"#state-tooltip\").classed(\"hidden\", true);\n        }else{\n            nodeTooltipFlag = true;\n            d3.select(\"#state-tooltip\")\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\")\n            .select(\"#value\")\n            .text(d.winState);\n            d3.select(\"#state-tooltip\").classed(\"hidden\", false);\n\n            d3.select(\"#filter-by-state\").on('click', ()=> {\n                leafStateFilter(d, scales);\n                nodeTooltipFlag = false;\n                d3.select(\"#state-tooltip\").classed(\"hidden\", true);\n            });\n\n            d3.select(\"#select-by-state\").on('click', ()=> {\n                let data = getLatestData();\n                let test = data.filter(path => {\n                    return path[path.length - 1].attributes[d.label].winState === d.winState;\n                });\n\n                let notIt = data.filter(path => {\n                    return path[path.length - 1].attributes[d.label].winState != d.winState;\n                });\n            \n                nodeTooltipFlag = false;\n                d3.select(\"#state-tooltip\").classed(\"hidden\", true);\n\n                pathSelected(test, notIt, scales);\n\n            });\n\n        }});\n\n    return pathGroups;\n\n}\nexport function sizeAndMove(svg, attribWrap, data, attrMove){\n        //tranforming elements\n    svg.style('height', ((data.length * (attrMove + 52))) + 'px');\n    attribWrap.attr('transform', (d)=> 'translate(140, 25)');\n        ///////////////////////////////////\n}\nexport function renderPaths(pathData, main){\n\n    let scales = getScales();\n\n    ////YOU SHOULD MOVE THESE APPENDING THINGS OUT OF HERE///////\n    /////Rendering ///////\n    let svgTest = main.select('#main-path-view');\n    let svg = svgTest.empty() ? main.append('svg').attr('id', 'main-path-view') : svgTest;\n    \n    let nodeTooltipFlag = false;\n\n    let pathWrapTest = svg.select('.path-wrapper');\n    let pathWrap = pathWrapTest.empty() ? svg.append('g').classed('path-wrapper', true) : pathWrapTest;\n    pathWrap.attr('transform', (d, i)=> 'translate(0,20)');\n\n      /////Counting frequency of nodes//////\n    let branchFrequency = pathData.flatMap(row=> row.flatMap(f=> f.node)).reduce(function (acc, curr) {\n        if (typeof acc[curr] == 'undefined') {\n          acc[curr] = 1;\n        } else {\n          acc[curr] += 1;\n        }\n        return acc;\n        }, {});\n\n     ///Scales for circles ///\n    let circleScale = d3.scaleLog().range([6, 12]).domain([1, d3.max(Object.values(branchFrequency))]);\n    let pathGroups = pathWrap.selectAll('.paths').data(pathData).join('g').classed('paths', true);\n    let pathBars = pathGroups.append('rect').classed('path-rect', true);\n    pathBars.attr('y', -8);\n\n    //////////\n    ///Selecting species\n    /////////\n    let pathAdd = pathGroups.append('g').classed(\"fas fa-search-plus\", true);\n    pathAdd.attr('transform', 'translate(15, 10)');\n    pathAdd.append('circle').attr('r', 7).attr('fill', '#fff');\n    pathAdd.append('text').text('+').attr('transform', 'translate(-5, 5)');\n    pathAdd.style('cursor', 'pointer');\n\n    pathAdd.on('click', (d, i, n)=>{\n\n        let notIt = d3.selectAll(n).filter((f, j)=> j != i).classed('selected-path', false);\n     \n        if(d3.select(n[i]).classed('selected-path')){\n            d3.select(n[i]).classed('selected-path', false);\n            pathSelected(null, notIt.data(), scales);\n        }else{\n            d3.select(n[i]).classed('selected-path', true);\n            pathSelected([d], notIt.data(), scales);\n        }\n    });\n\n    /////////\n    pathGroups.on('mouseover', function(d, i){\n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n        let treeLinks  = d3.select('#sidebar').selectAll('.link');\n        treeNode.filter(f=> {\n            return d.map(m=> m.node).indexOf(f.data.node) > -1;\n        }).classed('hover', true);\n        treeLinks.filter(f=> d.map(m=> m.node).indexOf(f.data.node) > -1).classed('hover', true);\n        return d3.select(this).classed('hover', true);\n    }).on('mouseout', function(d, i){\n        let treeNode  = d3.select('#sidebar').selectAll('.node').classed('hover', false);\n        let treeLinks  = d3.select('#sidebar').selectAll('.link').classed('hover', false);\n        return d3.select(this).classed('hover', false);\n    });\n\n    let speciesTitle = pathGroups.append('text').text(d=> {\n       let string = d.filter(f=> f.leaf === true)[0].node;\n        return string.charAt(0).toUpperCase() + string.slice(1);\n    });\n\n    speciesTitle.attr('x', 25).attr('y', 15);\n\n    let timelines = pathGroups.append('g').classed('time-line', true);\n    timelines.attr('transform', (d, i)=> 'translate(150, 0)');\n\n    let lines = timelines.append('line')\n    .attr('x1', 0)\n    .attr('x2', 1000)\n    .attr('y1', 15)\n    .attr('y2', 15);\n\n    let nodeGroups = timelines.selectAll('.node').data((d)=> {\n        return d}).join('g').attr('class', (d, i, n)=> {\n            return d3.select(n[n.length - 1]).data()[0].node + \" node\";\n        });\n   \n    nodeGroups.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 1000]);\n        let distance = x(d.combLength);\n        return 'translate('+ distance +', 10)';});\n\n    nodeGroups.on('click', (d, i, n)=> {\n        if(nodeTooltipFlag){\n            nodeTooltipFlag = false;\n            d3.select(\"#branch-tooltip\").classed(\"hidden\", true);\n        }else{\n            nodeTooltipFlag = true;\n            d3.select(\"#branch-tooltip\")\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\")\n            .select(\"#value\")\n            .text(d.node);\n            d3.select(\"#branch-tooltip\").classed(\"hidden\", false);\n\n            d3.select(\"#filter-by-node\").on('click', ()=> {\n                nodeFilter(d.node, scales);\n                nodeTooltipFlag = false;\n                d3.select(\"#branch-tooltip\").classed(\"hidden\", true);\n            });\n\n            d3.select(\"#select-by-node\").on('click', ()=> {\n                let data = getLatestData();\n                let test = pathGroups.filter(path => {\n                    return path.map(node => node.node).indexOf(d.node) > -1;\n                });\n                let notIt = pathGroups.filter(path => {\n                    return path.map(node => node.node).indexOf(d.node) === -1;\n                });\n                nodeTooltipFlag = false;\n                d3.select(\"#branch-tooltip\").classed(\"hidden\", true);\n                pathSelected(test.data(), notIt.data(), scales);\n            });\n        }\n    });\n\n    let circle = nodeGroups.append('circle').attr('cx', 0).attr('cy', 0).attr('r', d=> {\n        return circleScale(branchFrequency[d.node]);\n    }).attr('class', (d, i)=> 'node-'+d.node);\n\n    circle.on('mouseover', function(d, i){\n        let hovers = nodeGroups.filter(n=> n.node === d.node);\n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n        let selectedBranch = treeNode.filter(f=> f.data.node === d.node).classed('selected-branch', true);\n        return hovers.classed('hover-branch', true);\n    }).on('mouseout', function(d, i){\n        let hovers = nodeGroups.filter(n=> n.node === d.node);\n        d3.selectAll('.selected-branch').classed('selected-branch', false);\n        return hovers.classed('hover-branch', false);\n    });\n\n    let speciesNodeLabel = nodeGroups.filter(f=> f.label != undefined).append('text').text(d=> {\n        let string = d.label.charAt(0).toUpperCase() + d.label.slice(1);\n        return string;\n    }).attr('x', 10).attr('y', 5);\n\n    return pathGroups;\n}\nexport function renderAttributes(attributeWrapper, data, collapsed){\n    let attributeHeight = (collapsed === 'true')? 20 : 45;\n    let predictedAttrGrps = attributeWrapper.selectAll('g').data((d, i)=> {\n        return data[i]}).join('g');\n    predictedAttrGrps.classed('predicated-attr-groups', true);\n    predictedAttrGrps.attr('transform', (d, i) => 'translate(0, '+(i * (attributeHeight + 5))+')');\n\n    let attrLabel = predictedAttrGrps.append('text').text(d=> {\n        return d[d.length - 1].label ? d[d.length - 1].label : d[d.length - 1].attrLabel\n    });\n    attrLabel.classed('attribute-label', true);\n    attrLabel.attr('transform', 'translate(-15, 20)');\n\n    return predictedAttrGrps;\n}\nfunction collapsedPathGen(data){\n    data.map((p, i)=>{\n        let step = i === 0 ? 0 : 1;\n        let test = (p.realVal > data[i-step].realVal) ? 1 : 18;\n        p.change = test;\n    })\n}\nasync function continuousPaths(innerTimeline, collapsed){\n\n    innerTimeline.data().forEach(path => {\n        collapsedPathGen(path);\n    });\n\n    //THIS IS THE PATH GENERATOR FOR THE CONTINUOUS VARIABLES\n    let height = (collapsed === 'true')? dimensions.collapsedHeight : dimensions.rectHeight;\n    var lineGen = d3.line()\n    .x(d=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 1000]);\n        let distance = x(d.combLength);\n        return distance; })\n    .y(d=> {\n        let y = d.scales.yScale;\n        y.range([height, 0]);\n        if(collapsed === 'true'){\n            return d.change;\n        }else{\n            return y(d.values.realVal);\n        }\n    });\n\n    let innerPaths = innerTimeline.append('path')\n    .attr(\"d\", lineGen)\n    .attr(\"class\", \"inner-line\")\n    .style('stroke', (d)=> d[0].color);\n\n    return innerPaths;\n    ///////////////////////////////////////////////////////////\n}\nexport function drawContAtt(predictedAttrGrps, collapsed){\n\n    let continuousAtt = predictedAttrGrps.filter(d=> {\n        return (d[d.length - 1] != undefined) ? d[d.length - 1].type === 'continuous' : d.type === 'continuous';\n    });\n\n    let attributeHeight = (collapsed === 'true') ? dimensions.collapsedHeight : dimensions.rectHeight;\n\n    let innerTimeline = continuousAtt.append('g').classed('attribute-time-line', true);\n    /////DO NOT DELETE THIS! YOU NEED TO SEP CONT AND DICRETE ATTR. THIS DRAWS LINE FOR THE CONT/////\n    let innerPaths = continuousPaths(innerTimeline, collapsed);\n ////////\n    let attribRectCont = innerTimeline.append('rect').classed('attribute-rect', true);\n    attribRectCont.attr('height', attributeHeight);\n    let attributeNodesCont = innerTimeline.selectAll('g').data(d=> d).join('g').classed('attribute-node', true);\n\n    let innerBars = attributeNodesCont.append('g').classed('inner-bars', true);\n\n    // let innerRect = innerBars.append('rect').classed('attribute-inner-bar', true);\n    // innerRect.attr('height', attributeHeight).attr('width', dimensions.rectWidth);\n\n    innerBars.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 1000]);\n        let distance = x(d.combLength);\n        return 'translate('+ distance +', 0)';});\n      \n    let rangeRect = innerBars.append('rect').classed('range-rect', true);\n    rangeRect.attr('width', dimensions.rectWidth).attr('height', (d, i)=> {\n       \n        let y = d.scales.yScale;\n        y.range([attributeHeight, 0]);\n        let range = d.leaf ? 0 : y(d.values.lowerCI95) - y(d.values.upperCI95);\n        let barHeight = (collapsed === 'true') ? dimensions.collapsedHeight : range;\n        return barHeight;\n    });\n    rangeRect.attr('transform', (d, i)=> {\n        let y = d.scales.yScale;\n        y.range([attributeHeight, 0]);\n        let move = (d.leaf || (collapsed === 'true')) ? 0 : y(d.values.upperCI95);\n        return 'translate(0, '+ move +')';\n    });\n    rangeRect.style('fill', (d)=> {\n        return d.colorScale(d.values.realVal);\n    });\n    rangeRect.attr('opacity', (d)=> {\n        return d.satScale(d.values.realVal);\n    });\n    if(collapsed != 'true'){\n        innerBars.append('rect').attr('width', dimensions.rectWidth).attr('height', 4)\n        .attr('transform', (d, i)=> {\n            let y = d.scales.yScale;\n            y.range([attributeHeight, 0]);\n            return 'translate(0, '+ y(d.values.realVal) +')';})\n        .attr('fill', d=> d.color).classed('val-bar', true);\n    }\n\n    /////AXIS ON HOVER////\n    innerBars.on('mouseover', (d, i, n)=> {\n        let y = d.scales.yScale;\n        y.range([0, attributeHeight]);\n        d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(5));\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(200)\n          .style(\"opacity\", .9);\n        let f = d3.format(\".3f\");\n        tool.html('mean: '+f(d.values.realVal) +\"</br>\"+\"</br>\"+ 'upperCI: '+ f(d.values.upperCI95) +\"</br>\"+\"</br>\"+ 'lowerCI: '+ f(d.values.lowerCI95))\n          .style(\"left\", (d3.event.pageX) + \"px\")\n          .style(\"top\", (d3.event.pageY - 28) + \"px\");\n        tool.style('height', 'auto');\n       \n    }).on('mouseout', (d, i, n)=> {\n        d3.select(n[i]).select('g.y-axis')\n        d3.select(n[i]).select('g.y-axis').remove();\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(500)\n          .style(\"opacity\", 0);\n    });\n\n    return attributeNodesCont;\n   \n}\nexport function findMaxState(states, offset){\n    let maxP = d3.max(states.map(v=> v.values.realVal));\n    let notMax = states.filter(f=> f.values.realVal != maxP);\n    let winState = states[states.map(m=> m.values.realVal).indexOf(maxP)]\n    winState.other = notMax;\n    winState.offset = offset;\n    return winState;\n}\n    //BEGIN TEST\nfunction drawLeaves(attWraps, groupBy){\n    //THIS IS HARD CODED AND SHOULD NOT BE\n\n    let numSpecies = 100;\n    let height = 40;\n    //CONTINUOUS \n    let leafWraps = attWraps.filter(f=> f.type === 'continuous').selectAll('g.observe-wrap-first.continuous').data(d=> {\n            let totalVal = attWraps.data().filter(f=> f.label === d.label).map(m=> m.data);\n            let totalArray = totalVal.flatMap(p=> p.flatMap(f=> f.paths[f.paths.length - 1].realVal));\n            let max = d3.max(totalArray);\n            let min = d3.min(totalArray);\n            let totalMean = d3.mean(totalArray);\n        \n            let x = d3.scaleLinear().domain([min, max]).range([0, 200])\n            let newVal = d.data.map((m, i)=> {\n                m.index = i;\n                return {'value': m.paths[m.paths.length - 1].values.realVal, 'x': x, 'min': min, 'max': max, 'species':m.species };\n            });\n            let groupMean = d3.mean(newVal.map(v=> v.value));\n            return [{'dotVals':newVal, 'x': x, 'totalMean': totalMean, 'groupMean':groupMean}];\n        }).join('g').classed('observe-wrap-first continuous', true);\n        \n        leafWraps.attr('transform', 'translate(850, 0)');\n        \n        let xAxis = leafWraps.append('g').classed('axis-x', true);\n        xAxis.attr('transform', 'translate(0, '+(height - 15)+')');\n        xAxis.each((d, i, nodes)=> {\n            d3.select(nodes[i]).call(d3.axisBottom(d.x).ticks(5));\n        });\n        \n        let totalMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.totalMean)-1.5)+',0)')\n        .attr('height', (height - 15)).attr('width', 3).attr('fill', 'red').style('opacity', '0.4');\n        \n        let groupMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.groupMean)-1.5)+',0)')\n        .attr('height', (height - 15)).attr('width', 3).attr('fill', 'gray').style('opacity', '0.4');\n        \n        let distCircGroupOut = leafWraps.append('g').attr('transform', 'translate(0, 20)');\n        let distcirclesOut = distCircGroupOut.selectAll('circle').data(d=> d.dotVals).join('circle');\n        distcirclesOut.attr('r', 4).attr('cx', (d, i)=> d.x(d.value)).style('opacity', '0.3');\n\n        //DISCRETE//\n        let leafWrapsD = attWraps.filter(f=> f.type === 'discrete').selectAll('g.observe-wrap-first.discrete').data(d=> {\n          return [d];\n        }).join('g').classed('observe-wrap-first discrete', true);\n\n        let rects = leafWrapsD.filter(f=> {\n            return f.label != groupBy;\n        }).selectAll('rect').data(d=> {\n            let groupedData = d3Array.groups(d.data.map(m=> m.paths[m.paths.length - 1]), d=> d.state);\n            groupedData.sort((a, b)=> b[1].length - a[1].length)\n            return groupedData;\n        }).join('rect').attr('height', 15).attr('width', (d, i, n)=>{\n            let scale = d3.scaleLinear().domain([0, d3.sum(d3.selectAll(n).data().map(m=> m[1].length))])\n            .range([5, 170]);\n            d.width = scale(d[1].length);\n            return scale(d[1].length);\n        });\n\n        rects.attr('x', (d, i, n)=> {\n            if(i === 0){ return 0}\n            else {\n                d3.selectAll(n).filter((f, j)=> j< i);\n                let move = d3.sum(d3.selectAll(n).filter((f, j)=> j< i).data().map(m=> m.width));\n                return move;}\n        }).attr('y', 12)\n\n        rects.attr('fill', d=> d[1][0].color);\n\n        rects.on('mouseover', (d, i, n)=> {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            \n            tool.html(d[0] + \"</br>\" + d[1].length)\n              .style(\"left\", (d3.event.pageX + 10) + \"px\")\n              .style(\"top\", (d3.event.pageY + 20) + \"px\");\n\n              d3.selectAll(n).filter((f, j)=> j != i).attr('opacity', 0.3);\n          \n        }).on('mouseout', (s, i, n)=> {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n\n              d3.selectAll(n).filter((f, j)=> j != i).attr('opacity', 1)\n        })\n\n        leafWrapsD.attr('transform', 'translate(850, 0)');\n\n        let ratio = leafWrapsD.filter(f=> f.label === groupBy)\n            .selectAll('text').data(d=> [d]).join('text').text(d=> {\n                let paths = d.data[d.data.length - 1].paths;\n                return `${paths[paths.length - 1].state}: ${d.data.length} / ${numSpecies}`\n            });\n        ratio.style('text-anchor', 'middle')\n        ratio.style('font-size', '12px')\n        ratio.attr('x', 90).attr('y', 25)\n        \n    }\nexport function drawGroups(stateBins, scales){\n    \n    let groupedBool = d3.select('#show-drop-div-group').attr('value', 'grouped');\n    \n    let height = 40;\n    let selectedTool = d3.select('#selected');\n    selectedTool.selectAll('*').remove();\n \n    let main = d3.select('#main');\n    main.style('padding-top', 0);\n\n    d3.select('#toolbar').append('text').text(stateBins[0].field)\n\n    let splitOnArray = [{'field':'None'}].concat(scales.filter(f=> (f.field != stateBins[0].field) && f.type === 'discrete'));\n    let dropOptions = dropDown(d3.select('#toolbar'), splitOnArray, 'Split On','show-drop-div-group');\n\n    ////THIS SPLITS THE DATA////\n    dropOptions.on('click', (d, i, n)=> {\n        d3.select('#toolbar').append('text').text(d.field);\n        \n        if(d.type === 'discrete'){\n            let newBins = stateBins.map(state=> {\n                let newBinData = d.scales.map(sc=> {\n                    let field = sc.field;\n                    let name = sc.scaleName;\n                    let newData = state.data.filter(pa=> {\n                        let leaf = pa.filter(le=> le.leaf === true)[0];\n                        return leaf.attributes[field].winState === name;\n                    });\n                    return {'field': field, 'state': name, 'data': newData }\n                });\n                state.data = newBinData;\n                return state;\n            });\n\n            //////RENDERING NEED TO SEPARATE OUT/////\n           \n           let main = d3.select('#main');\n           main.selectAll('*').remove();\n           main.style('padding-top', '40px');\n           let firstGroupDiv = main.selectAll('div.first-group').data(newBins).join('div').classed('first-group', true);\n           \n           let firstGroupSvg = firstGroupDiv.append('svg');\n           firstGroupSvg.attr('height', s=> (s.data.length*270));\n           let firstGroup = firstGroupSvg.append('g');\n          \n           let firstLabel = firstGroup.append('text').text(f=> f.state).attr('transform', 'translate(10, 10)');\n\n           let secondGroup = firstGroup.selectAll('g.second-group').data(g=> {\n               let newGroups = g.data.map((m)=>{\n                   let newM = {};\n                   newM.first = [g.field, g.state];\n                   newM.second = [m.field, m.state];\n                   newM.data = m.data\n                   newM.leaves = m.data.flatMap(path=> path.filter(f=> f.leaf === true));\n                   return newM\n               });\n               return newGroups}).join('g').classed('second-group', true);\n\n           secondGroup = secondGroup.filter(f=> f.data.length > 0);\n           secondGroup.attr('transform', (s, i)=> 'translate(30,'+(20 + (i * 270))+')');\n\n           secondGroup.each((s, i, n)=> {\n            let branchBar = drawBranchPointDistribution(s.data, d3.select(n[i]));\n            branchBar.select('rect').attr('x', -80).attr('fill','gray');\n            branchBar.selectAll('.branch-points').selectAll('circle').attr('fill', 'rgba(255, 255, 255, 0.3)');\n            \n            branchBar.select('.leaf-label').append('text').text((t, i) =>': '+ t.data.length).attr('transform', 'translate(45, 0)');\n            branchBar.selectAll('text').style('font-size', '11.5px').style('fill', '#fff');\n    \n            branchBar.select('line').attr('stroke', '#fff');\n\n            let groupLabels = d3.select(n[i]).append('g');\n\n            //groupLabels.\n            let pathAdd = groupLabels.append('g').classed(\"fas fa-search-plus\", true);\n            pathAdd.attr('transform', 'translate(-10, 15)');\n            pathAdd.append('circle').attr('r', 7).attr('fill', '#fff');\n            pathAdd.append('text').text('+').attr('transform', 'translate(-5, 3)').attr('fill', 'gray');\n        \n            pathAdd.style('cursor', 'pointer');\n\n            pathAdd.on('click', ()=> {\n                let other = d3.selectAll(n).filter((f,j)=> j != i);\n                renderComparison(s, other.data(), d3.select('#selected'), scales);\n            });\n\n            let stateLabel = groupLabels.append('text').text((s, i)=> s.second[1]);\n            stateLabel.attr('transform', (d, i)=> 'translate(3, 20)');\n            stateLabel.attr('fill', '#fff');\n           });\n\n           let innerGroup = secondGroup.filter(f=> f.data.length > 0).append('g').classed('inner-wrap', true);\n           innerGroup.attr('transform', (d,i)=> 'translate(110, 0)');\n\n       \n           let attWraps = innerGroup.selectAll('.att-wrapper').data((d)=> {\n               let atts = formatAttributeData(d.data, scales, null);\n             \n               let attDataComb = atts[0].map((att, i)=> {\n                  \n                   let species = d.data[0].filter(f=> f.leaf === true)[0].label;\n\n                   att[att.length - 1].offset = 0;\n                   let attribute = {'label': att[att.length-1].label, 'type':att[att.length-1].type, 'data': [{'species': species, 'paths': att}]}\n                   for(let index = 1; index < atts.length; index++ ){\n                       let species = d.data[index].filter(f=> f.leaf === true)[0].label;\n                       let last = atts[index][i].length - 1\n                       atts[index][i][last].offset = (index * 8);\n                       attribute.data.push({'species': species, 'paths': atts[index][i]});\n                   }\n                   \n                   return attribute;\n               });\n\n              let mappedDis = attDataComb.map(dis=> {\n                  dis.data = dis.data.map((spec, i)=> {\n                      spec.paths = spec.paths.map(m=> {\n                            if(dis.type === 'discrete'){\n                                let offset = 5 * i;\n                                let maxProb = m.states? {'realVal': 1.0, 'state': m.winState, 'color':m.color, 'combLength': m.combLength, 'offset':m.offset, 'leaf': true} : findMaxState(m, offset); \n                                return maxProb;\n                            }else{\n                                return m;\n                            }\n                        });\n                   return spec;\n                  });\n        \n                  dis.leaves = dis.data.flatMap(f=> f.paths.filter(p=> p.leaf === true));\n                  return dis;\n              });\n              return mappedDis;\n           }).join('g').classed('att-wrapper', true);\n\n           let innerWrapRect = attWraps.append('rect').attr('width', 800);\n\n            innerWrapRect.attr('height', height);\n            innerWrapRect.style('fill', '#fff');\n            innerWrapRect.style('stroke', 'gray');\n\n            attWraps.attr('transform', (d, i)=> 'translate(0,'+((i * (height+5))+ 30)+')');\n            wrappers.attr('transform', (d, i)=> 'translate(60,'+(i * (5 * (height+15))+ 50)+')');\n            svg.attr('height', (wrappers.data().length * (5 * (height+15))+ 50));\n\n            let labels = attWraps.append('text')\n            .text(d=> d.label)\n            .style('text-anchor', 'end')\n            .style('font-size', 11)\n            labels.attr('transform', 'translate(-5,'+(50/2)+')');\n\n////WORKING ON STATE SHIFT VIEW///////\n            let shiftWraps = attWraps.filter(f=> f.type === 'discrete').selectAll('g.shift-wrap').data(d=> {\n       \n                let test = d.data.flatMap(m=> m.paths.filter((f, i)=> {\n                    if(i===0) return (i === 0);\n                    if(i > 0) return (m.paths[i-1].state != f.state)\n                    if(i < m.paths.length - 1) return (m.paths[i+1].state != f.state);\n                }));\n             \n                return [test];\n            }).join('g').classed('shift-wrap', true);\n\n            shiftWraps.attr('transform', 'translate(850, 0)');\n\n            let xAxisShift = shiftWraps.append('g').classed('axis-x', true);\n            xAxisShift.attr('transform', 'translate(0, '+(height - 15)+')');\n            xAxisShift.each((d, i, nodes)=> {\n                let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 200]);\n                d3.select(nodes[i]).call(d3.axisBottom(x).ticks(5));\n            });\n\n            let circGroupShift = shiftWraps.append('g').attr('transform', 'translate(0, 20)');\n\n            let shiftCircles = circGroupShift.selectAll('circle.shift').data(d=> d).join('circle').classed('shift', true);\n            shiftCircles.attr('r', 4).attr('cx', (d, i)=> {\n                let x = d3.scaleLinear().domain([0,maxTimeKeeper[0]]).range([0, 200]);\n                return x(d.combLength)\n            });\n            shiftCircles.attr('fill', d=> d.color).style('opacity', 0.4);\n\n//////DRAW OBSERVED DISTRIBUTIONS/////\n            let leafWraps = attWraps.filter(f=> f.type === 'continuous').selectAll('g.observe-wrap').data(d=> {\n                let totalVal = attWraps.data().filter(f=> f.label === d.label).flatMap(m=> m.leaves.map(l=> l.realVal));\n                let max = d3.max(totalVal);\n                let min = d3.min(totalVal);\n                let totalMean = d3.mean(totalVal);\n\n                let x = d3.scaleLinear().domain([min, max]).range([0, 200])\n                let newVal = d.leaves.map((m, i)=> {\n                    m.index = i;\n                    return {'value': m.realVal, 'x': x, 'min': min, 'max': max, 'species':m.species };\n                });\n                let groupMean = d3.mean(newVal.map(v=> v.value));\n                return [{'dotVals':newVal, 'x': x, 'totalMean': totalMean, 'groupMean':groupMean}];\n            }).join('g').classed('observe-wrap', true);\n\n            leafWraps.attr('transform', 'translate(850, 0)');\n\n            let xAxis = leafWraps.append('g').classed('axis-x', true);\n            xAxis.attr('transform', 'translate(0, '+(height - 15)+')');\n            xAxis.each((d, i, nodes)=> {\n                d3.select(nodes[i]).call(d3.axisBottom(d.x).ticks(5));\n            });\n\n            let totalMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.totalMean)-1.5)+',0)')\n            .attr('height', (height - 15)).attr('width', 3).attr('fill', 'red').style('opacity', '0.4');\n\n            let groupMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.groupMean)-1.5)+',0)')\n            .attr('height', (height - 15)).attr('width', 3).attr('fill', 'gray').style('opacity', '0.4');\n\n            let distCircGroup = leafWraps.append('g').attr('transform', 'translate(0, 20)');\n            let distcircles = distCircGroup.selectAll('circle').data(d=> d.dotVals).join('circle');\n            distcircles.attr('r', 4).attr('cx', (d, i)=> d.x(d.value)).style('opacity', '0.3');\n\n            distcircles.on('mouseover', (d, i, n)=> {\n\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(200)\n                  .style(\"opacity\", .9);\n                let f = d3.format(\".3f\");\n                tool.html(d.species)\n                  .style(\"left\", (d3.event.pageX + 10) + \"px\")\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\n           \n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', true);\n\n            }).on('mouseout', (d, i, n)=> {\n                d3.select(n[i]).classed('selected', false);\n\n                distcircles.classed('selected', false).style('opacity', 0.3);\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(500)\n                  .style(\"opacity\", 0);\n\n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', false);\n            });\n\n\n            ////DRAW SPECIES GROUPS IN THE ATTRIBUTES\n\n            let speciesGrp = attWraps.selectAll('g.species').data(d=> {\n                d.data = d.data.map(m=> {\n                    m.type = d.type;\n                    return m;\n                });\n                return d.data;\n            }).join('g').classed('species', true);\n\n            let lineGenD = d3.line()\n                .x(d=> {\n                    let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 800]);\n                    let distance = d.combLength;\n                    return x(distance);\n                    })\n                .y(d=> {\n                    let y = d3.scaleLinear().domain([0, 1]).range([height-2, 1]);\n                    return y(d.realVal);\n                });\n\n            let lineGenC = d3.line()\n                .x(d=> {\n                    let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 800]);\n                    let distance = d.combLength;\n                    return x(distance);\n                })\n                .y(d=> {\n                    let y = d.scales.yScale;\n                    y.range([height-2, 1]);\n                    return y(d.values.realVal) + 2;\n                });\n\n            let innerStatePaths = speciesGrp.append('path')\n                .attr(\"d\", d=> {\n                        return (d.type === 'discrete') ? lineGenD(d.paths) : lineGenC(d.paths);\n                    })\n                .attr(\"class\", (d, i)=> {\n                        return d.species + \" inner-line\"})\n                .style('stroke-width', 0.7)\n                .style('fill', 'none')\n                .style('stroke', 'gray');\n\n            innerStatePaths.on('mouseover', (d, i, n)=> {\n               \n                d3.select(n[i]).classed('selected', true);\n                distcircles.filter(f=> f.species === d.species).classed('selected', true).style('opacity', 1);\n\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(200)\n                  .style(\"opacity\", .9);\n                let f = d3.format(\".3f\");\n                tool.html(d.species)\n                  .style(\"left\", (d3.event.pageX + 10) + \"px\")\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\n\n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', true);\n                \n            }).on('mouseout', (d, i, n)=> {\n                d3.select(n[i]).classed('selected', false);\n\n                distcircles.classed('selected', false).style('opacity', 0.3);\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(500)\n                  .style(\"opacity\", 0);\n\n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', false);\n            });\n\n            let disGroup = speciesGrp.filter(sp=> {\n            return sp.type === 'discrete';\n            });\n\n            let branchGrpDis = disGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n            branchGrpDis.attr('transform', (d)=> {\n                let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n                    let distance = x(d.combLength);\n                    return 'translate('+distance+', 0)';\n            });\n\n            let bCirc = branchGrpDis.append('circle').attr('r', 5).attr('cy', (d, i)=> {\n                let y = d3.scaleLinear().domain([0, 1]).range([height - 5, 2]);\n                return y(d.realVal);\n            }).attr('cx', 5);\n\n            bCirc.classed('win-state', true);\n\n            bCirc.attr('fill', (d, i, n)=> {\n                if(i === 0){\n                    return d.color;\n                }else if(i === n.length - 1){\n                    if(d.state === d3.select(n[i-1]).data()[0].state){\n                        return 'rgba(189, 195, 199, 0.3)';\n                    }else{\n                        d.shift = true;\n                        return d.color;\n                    }\n                }else{\n                    if(d.state === d3.select(n[i+1]).data()[0].state || d.state === d3.select(n[i-1]).data()[0].state){\n                        return 'rgba(189, 195, 199, 0.3)';\n                    }else{\n                        d.shift = true;\n                        return d.color;\n                    }\n                }\n            });\n\n\n    let otherCirc = branchGrpDis.filter(f=> f.leaf != true).selectAll('.other').data(d=> d.other).join('circle').classed('other', true);\n    \n    otherCirc.attr('r', 4).attr('cx', 5).attr('cy', (c, i)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n             return y(c.realVal);\n         }).attr('fill', 'rgba(189, 195, 199, 0.1)');\n\n    otherCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n\n    bCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n     \n     /////AXIS ON HOVER////\n    branchGrpDis.on('mouseover', (d, i, n)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7).attr('fill', (d)=> d.color);\n         d3.select(n[i]).selectAll('.win-state').style('opacity', 0.7).attr('fill', (d)=> d.color);\n\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').attr('fill', 'rgba(189, 195, 199, 0.1)');\n         d3.select(n[i]).selectAll('.win-state').filter(w=> w.shift != true).attr('fill', 'rgba(189, 195, 199, 0.3)');\n     });\n\n    let conGroup = speciesGrp.filter(sp=> {\n         return sp.type === 'continuous';\n     });\n\n    let branchGrpCon = conGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n    branchGrpCon.attr('transform', (d)=> {\n      let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n          let distance = x(d.combLength);\n          return 'translate('+distance+', 0)';\n      });\n\n      /////AXIS ON HOVER////\n    branchGrpCon.on('mouseover', (d, i, n)=> {\n         let y = d.yScale;\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').style('opacity', 0.1);\n     });\n\n     let MeanRect = branchGrpCon.append('rect');\n     MeanRect.attr('width', dimensions.rectWidth).attr('height', 3);\n     MeanRect.attr('y', (d, i) => {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0])\n         return y(d.realVal);\n     });\n\n     let confiBars = branchGrpCon.filter(f=> f.leaf != true).append('rect');\n     confiBars.attr('width', dimensions.rectWidth).attr('height', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.lowerCI95) - y(d.upperCI95);\n     });\n\n     confiBars.attr('y', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.upperCI95);\n     });\n     confiBars.style('opacity', 0.1);\n           \n           //drawGroups(stateBins, scales);\n    }else{\n            console.error('THIS HAS TO BE DISCRETE');\n        }\n        selectedTool.select('#show-drop-div-group').classed('show', false);\n    });\n    /////END SPLIT VIEW//////\n    let svgTest = main.select('#main-path-view');\n    let svg = svgTest.empty() ? main.append('svg').attr('id', 'main-path-view') : svgTest;\n    svg.selectAll('*').remove();\n\n    svg.attr('height', (stateBins.length * (height + 20)));\n    svg.append('g').attr('transform', 'translate(500, 40)').append('text').text(stateBins[0].field)\n\n    let wrappers = svg.selectAll('.grouped').data(stateBins).join('g').classed('grouped', true);\n    wrappers.each((d, i, n)=> {\n        let branchBar = drawBranchPointDistribution(d.data, d3.select(n[i]));\n        branchBar.select('rect').attr('x', -80).attr('fill','gray');\n        branchBar.selectAll('.branch-points').selectAll('circle').attr('fill', 'rgba(255, 255, 255, 0.3)');\n        \n        branchBar.select('.leaf-label').append('text').text((d, i) =>': '+ d.data.length).attr('transform', 'translate(45, 0)');\n        branchBar.selectAll('text').style('font-size', '11.5px').style('fill', '#fff');\n\n        branchBar.select('line').attr('stroke', '#fff');\n    });\n\n    let groupLabels = wrappers.append('g');\n   \n\n     //groupLabels.\n     let pathAdd = groupLabels.append('g').classed(\"fas fa-search-plus\", true);\n     pathAdd.attr('transform', 'translate(20, -5)');\n     pathAdd.append('circle').attr('r', 7).attr('fill', '#fff');\n     pathAdd.append('text').text('+').attr('transform', 'translate(5, 3)').attr('fill', 'gray');\n \n     pathAdd.style('cursor', 'pointer');\n\n     pathAdd.on('click', (d, i, n)=> {\n         let other = d3.selectAll(n).filter((f,j)=> j != i);\n         renderComparison(d, other.data(), d3.select('#selected'), scales);\n     });\n\n     groupLabels.append('text').text((d, i)=> d.state);\n     groupLabels.attr('transform', (d, i)=> 'translate(40, 16)');\n     groupLabels.style('text-anchor', 'end');\n     groupLabels.attr('fill', '#fff');\n\n    let innerGroup = wrappers.append('g').classed('inner-wrap', true);\n    innerGroup.attr('transform', (d,i)=> 'translate(110, 0)');\n\n    let attWraps = innerGroup.selectAll('.att-wrapper').data((d, i)=> {\n        let atts = formatAttributeData(d.data, scales, null);\n\n       \n        let attDataComb = atts[0].map((att, i)=> {\n            let species = d.data[0].filter(f=> f.leaf === true)[0].label;\n            att[att.length - 1].offset = 0;\n            let attribute = {'label': att[att.length-1].label, 'type':att[att.length-1].type, 'data': [{'species': species, 'paths': att}]}\n            for(let index = 1; index < atts.length; index++ ){\n                let species = d.data[index].filter(f=> f.leaf === true)[0].label;\n                let last = atts[index][i].length - 1;\n                atts[index][i][last].offset = (index * 8);\n                attribute.data.push({'species': species, 'paths': atts[index][i]})\n            }\n            return attribute;\n        });\n\n       let mappedDis = attDataComb.map(dis=> {\n           dis.data = dis.data.map((spec, i)=> {\n               spec.paths = spec.paths.map(m=> {\n                if(dis.type === 'discrete'){\n                    let offset = 5 * i;\n                    let maxProb = m.states? {'realVal': 1.0, 'state': m.winState, 'color':m.color, 'combLength': m.combLength, 'offset':m.offset, 'leaf': true} : findMaxState(m, offset); \n                    return maxProb;\n                }else{\n                    return m;\n                }\n            });\n            return spec;\n           });\n           return dis;\n       });\n       return mappedDis;\n    }).join('g').classed('att-wrapper', true);\n\n    let innerWrapRect = attWraps.append('rect').attr('width', 800);\n    innerWrapRect.attr('height', height);\n    innerWrapRect.style('fill', '#fff');\n    innerWrapRect.style('stroke', 'gray');\n\n    attWraps.attr('transform', (d, i)=> 'translate(0,'+((i * (height+5))+ 30)+')');\n    wrappers.attr('transform', (d, i)=> 'translate(60,'+(i * (5 * (height+15))+ 50)+')');\n    \n    svg.attr('height', (wrappers.data().length * (5 * (height+15))+ 50));\n\n       //END EXPERIMENT\n    drawLeaves(attWraps, stateBins[0].field);\n\n    let labels = attWraps.append('text')\n    .text(d=> d.label)\n    .style('text-anchor', 'end')\n    .style('font-size', 11)\n    labels.attr('transform', 'translate(-5,'+(50/2)+')');\n\n    let speciesGrp = attWraps.selectAll('g.species').data(d=> {\n        d.data = d.data.map(m=> {\n            m.type = d.type;\n            return m;\n        });\n        return d.data;\n    }).join('g').classed('species', true);\n\n    let lineGenD = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 800]);\n           let distance = d.combLength;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d3.scaleLinear().domain([0, 1]).range([height-2, 1]);\n           return y(d.values.realVal);\n       });\n\n       let lineGenC = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n           let distance = d.combLength;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d.yScale;\n           y.range([height-2, 1]);\n           return y(d.values.realVal) + 2;\n       });\n\n       let innerStatePaths = speciesGrp.append('path')\n       .attr(\"d\", d=> {\n            return (d.type === 'discrete') ? lineGenD(d.paths) : lineGenC(d.paths);\n        })\n       .attr(\"class\", (d, i)=> {\n            return d.species + \" inner-line\"})\n       .style('stroke-width', 0.7)\n       .style('fill', 'none')\n       .style('stroke', 'gray');\n\n       innerStatePaths.on('mouseover', (d, i, n)=> {\n        d3.select(n[i]).classed('selected', true);\n    }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).classed('selected', false);\n    });\n\n    let disGroup = speciesGrp.filter(sp=> {\n     return sp.type === 'discrete';\n     });\n\n    let branchGrpDis = disGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n    branchGrpDis.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 800]);\n            let distance = x(d.combLength);\n            return 'translate('+distance+', 0)';\n     });\n\n    let bCirc = branchGrpDis.append('circle').attr('r', 5).attr('cy', (d, i)=> {\n         let y = d3.scaleLinear().domain([0, 1]).range([height - 5, 2]);\n         //return y(d.realVal) + d.offset;\n         return y(d.values.realVal);\n     }).attr('cx', 5);\n\n     bCirc.classed('win-state', true);\n\n     bCirc.attr('fill', (d, i, n)=> {\n        if(i === 0 || i === n.length - 1){\n            return d.color;\n            /*\n        }else if(i === n.length - 1){\n            if(d.state === d3.select(n[i-1]).data()[0].state){\n                return 'rgba(189, 195, 199, 0.3)';\n            }else{\n                d.shift = true;\n                return d.color;\n            }*/\n        }else{\n            if(d.state === d3.select(n[i+1]).data()[0].state || d.state === d3.select(n[i-1]).data()[0].state){\n                return 'rgba(189, 195, 199, 0.3)';\n            }else{\n                d.shift = true;\n                return d.color;\n            }\n        }\n     });\n\n    let otherCirc = branchGrpDis.filter(f=> f.leaf != true).selectAll('.other').data(d=> d.other).join('circle').classed('other', true);\n    \n    otherCirc.attr('r', 4).attr('cx', 5).attr('cy', (c, i)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n             return y(c.realVal);\n         }).attr('fill', 'rgba(189, 195, 199, 0.1)');\n\n    otherCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n\n    bCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n     \n     /////AXIS ON HOVER////\n    branchGrpDis.on('mouseover', (d, i, n)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7).attr('fill', (d)=> d.color);\n         d3.select(n[i]).selectAll('.win-state').style('opacity', 0.7).attr('fill', (d)=> d.color);\n\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').attr('fill', 'rgba(189, 195, 199, 0.1)');\n         d3.select(n[i]).selectAll('.win-state').filter(w=> w.shift != true).attr('fill', 'rgba(189, 195, 199, 0.3)');\n     });\n\n    let conGroup = speciesGrp.filter(sp=> {\n         return sp.type === 'continuous';\n     });\n\n    let branchGrpCon = conGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n    branchGrpCon.attr('transform', (d)=> {\n      let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 800]);\n          let distance = x(d.combLength);\n          return 'translate('+distance+', 0)';\n      });\n\n      /////AXIS ON HOVER////\n     branchGrpCon.on('mouseover', (d, i, n)=> {\n         let y = d.yScale;\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').style('opacity', 0.1);\n     });\n\n     let MeanRect = branchGrpCon.append('rect');\n     MeanRect.attr('width', dimensions.rectWidth).attr('height', 3);\n     MeanRect.attr('y', (d, i) => {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0])\n         return y(d.realVal);\n     });\n\n     let confiBars = branchGrpCon.filter(f=> f.leaf != true).append('rect');\n     confiBars.attr('width', dimensions.rectWidth).attr('height', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.lowerCI95) - y(d.upperCI95);\n     });\n\n     confiBars.attr('y', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.upperCI95);\n     })\n     confiBars.style('opacity', 0.1);\n\n     /////HIGHLIGHTING NODES IN A TREE ON HOVER//////\n     d3.selectAll('.att-wrapper').selectAll('.branch').on('mouseover', (d, i, n)=> {\n         let treeNode  = d3.select('#sidebar').selectAll('.node');\n        treeNode.filter(f=> {\n            return d.node === f.data.node;\n        }).classed('selected', true);\n      \n    }).on('mouseout', (d, i, n)=> {\n       \n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n        treeNode.filter(f=> {\n            return d.node === f.data.node;\n        }).classed('selected', false);\n    })\n     \n}\nexport function drawDiscreteAtt(predictedAttrGrps, collapsed, bars){\n\n    let discreteAtt = predictedAttrGrps.filter(d=> {\n        return d[d.length - 1].type === 'discrete';\n    });\n\n   // discreteAtt.selectAll('*').remove();\n\n    let attributeHeight = (collapsed === 'true')? 20 : 45;\n\n    let innerTimelineDis = discreteAtt.append('g').classed('attribute-time-line', true);\n\n    innerTimelineDis.append('line').classed('half', true).attr('x1', 0).attr('y1', 22).attr('x2', 1010).attr('y2', 22);\n    \n    let statePath = innerTimelineDis.selectAll('g').data(d=> {\n        \n        // let disct = d.map(m=> {\n        //     console.log('m', d, m)\n        //     let test = (m.leaf == true) ? m.states.map(s=> {\n        //         s.combLength = m.combLength;\n        //         s.color = m.color;\n        //         return s;\n        //     }) : m;\n        //     return test;\n        // });\n        let disct = d;\n       \n        let keys = disct[0].map(s=> s.state);\n        let lines = keys.map(key=> {\n             return disct.map(m=> m.leaf ? m : m.filter(f=> f.state == key)[0]);\n        });\n        return lines;\n    }).join('g').classed('state-path', true);\n\n    var lineGen = d3.line()\n    .x(d=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 1000]);\n        let distance = x(d.combLength);\n        return distance + 7;})\n    .y(d=> {\n        let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight-2, 1]);\n        return d.value ? y(d.value) : y(1);\n    });\n\n    let innerStatePaths = statePath.append('path')\n    .attr(\"d\", lineGen)\n    .attr(\"class\", (d, i)=> d[0].species + \" inner-line\")\n    .style('stroke-width', 0.7)\n    .style('stroke', (d)=> {\n        return d[0].color;\n    });\n\n    let attribRectDisc = innerTimelineDis.append('rect').classed('attribute-rect', true);\n    attribRectDisc.attr('height', attributeHeight);\n    let attributeNodesDisc = innerTimelineDis.selectAll('.attribute-node-discrete').data(d=> {\n        return d;}).join('g');\n\n    attributeNodesDisc.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 1000]);\n        if(d[0]){\n           // let distance = (moveMetric === 'move') ? d[0].move : x(d[0].combLength);\n           let distance = x(d[0].combLength);\n            return 'translate('+distance+', 0)';\n        }else{\n           // let distance = (moveMetric === 'move') ? d.move : x(d.combLength);\n            let distance = x(d.combLength);\n            return 'translate('+distance+', 0)';\n        }\n    });\n\n    attributeNodesDisc.append('rect').attr('width', dimensions.rectWidth).attr('height', attributeHeight).attr('opacity', 0);\n\n    attributeNodesDisc.append('line').attr('x1', 10).attr('x2', 10).attr('y1', 0).attr('y2', attributeHeight);\n\n        /////AXIS ON HOVER////\n    attributeNodesDisc.on('mouseover', (d, i, n)=> {\n            let y = d3.scaleLinear().domain([1, 0]);\n            y.range([0, attributeHeight]);\n            d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n        }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).select('g.y-axis')\n            d3.select(n[i]).select('g.y-axis').remove();\n        })\n\n    attributeNodesDisc.attr('class', (d, i, n)=> {\n        let path = d3.selectAll(n).data();\n        return path[path.length - 1].species;\n    }).classed('attribute-node-discrete', true);\n\n    if(bars === false){\n\n        let stateDots = attributeNodesDisc.filter((att, i)=> att[0] != undefined).selectAll('.dots').data(d=> {\n            \n            return d;\n        }).join('circle').classed('dots', true);\n        \n        stateDots.attr('cx', 10).attr('cy', (d)=> {\n            let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight - 2, 2]);\n            return d.realVal? y(d.realVal) : y(d.value);\n        }).attr('r', 2);\n        \n        stateDots.style('fill', (d, i, n)=> {\n           \n            /*\n            let speciesPath = d3.selectAll('.attribute-node-discrete.'+ d.species)//.filter(f=> f.type === 'discrete');\n           \n            let nodeArray = speciesPath.data().map(m=> {\n                return m.node ? m.node : m[0].node;\n            });\n            let index = nodeArray.indexOf(d.node);\n           \n            */\n            //return d.color\n            return 'gray';\n        });\n    \n        stateDots.filter(f=> f.realVal > 0.5).attr('r', 4);\n/*\n        let maxDots = stateDots.filter((f, i, n)=> {\n           \n            return f.realVal === d3.max(d3.selectAll(n).data().map(m=> m.realVal));\n        });\n*/\n        \n\n        ////NEED TO ADD COLOR ON STATE CHANGE////\n    \n        stateDots.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n    \n        let endStateDot = attributeNodesDisc.filter((att, i)=> {\n            return att[0] === undefined;}).classed('discrete-leaf', true);\n    \n        endStateDot.append('circle').attr('cx', 10).attr('cy', 2).attr('r', 7).style('fill', d=> {\n           return d.color;\n        });\n        ////NEED TO MAKE A FUNCTION TO ASSIGN COLOR OF STATES//////\n    \n        endStateDot.append('text').text(d=> d.winState).attr('transform', 'translate(20, 5)').style('font-size', 10);\n\n    }else{\n        attributeNodesDisc.filter((att, i)=> {\n            return att[0] != undefined;}).append('rect').attr('height', attributeHeight).attr('width', dimensions.rectWidth).attr('fill', '#fff')\n        let stateBars = attributeNodesDisc.filter((att, i)=> att[0] != undefined).selectAll('.dis-rect').data(d=> {\n            return d;\n        }).join('rect').classed('dis-rect', true);\n\n        stateBars.attr('width', dimensions.rectWidth).attr('height', (d, i)=> {\n         \n            let y = d3.scaleLinear().domain([0, 1]).range([0, attributeHeight]);\n            return y(d.realVal);\n        });\n\n        stateBars.attr('fill', (d, i)=> d.color);\n        stateBars.attr('opacity', '0.7');\n        stateBars.attr('stroke', '#fff');\n        stateBars.attr('transform', (d, i, n)=> {\n            let y = d3.scaleLinear().domain([0, 1]).range([0, attributeHeight]);\n            let probability = d3.selectAll(n).data().sort((a, b)=> b.realVal - a.realVal);\n            let chosenIn = probability.map(p=> p.state).indexOf(d.state);\n         \n            if(chosenIn === 0){\n                    return 'translate(0,0)';\n            }else{\n                ///need to make this a reduce function///\n                let valueAdd = 0;\n                    for(let step = 0; step < chosenIn; step++){\n                        valueAdd = valueAdd + probability[step].realVal;\n                    }\n                return 'translate(0,'+(y(valueAdd))+')';\n            }\n        });\n\n        stateBars.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n    \n        let endStateDot = attributeNodesDisc.filter((att, i)=> {\n            return att[0] === undefined;}).classed('discrete-leaf', true);\n    \n        endStateDot.append('circle').attr('cx', 10).attr('cy', 2).attr('r', 7).style('fill', d=> {\n           return d.color;\n        });\n\n        endStateDot.append('text').text(d=> d.winState).attr('transform', 'translate(20, 5)').style('font-size', 10);\n\n    }\n\n    return attributeNodesDisc;\n}\n\n","import '../styles/index.scss';\n\nimport * as d3 from \"d3\";\nimport {dataMaster, calculatedScalesKeeper} from './index';\nimport { updateMainView } from './viewControl';\n\nexport let filterMaster = [];\n\nexport function removeFilter(filterId, scales){\n    let dataFilters = filterMaster.filter(f=> f.filterType === 'data-filter');\n    let filterIndex = dataFilters.map(f=> f.filterId).indexOf(filterId);\n\n    if(filterIndex != dataFilters.length - 1){\n   \n        let baseData = filterIndex === 0? dataMaster[0] : dataFilters[filterIndex - 1].data;\n    \n        let testData = [...baseData];\n\n        let filterToolbar = d3.select(\"#toolbar\");\n\n        let badges = filterToolbar.selectAll('.filter-tag').remove();\n  \n        for(let i = filterIndex + 1; i < dataFilters.length; i ++){\n       \n            let fun = dataFilters[i].filterFunction;\n            if(dataFilters[i].attributeType === 'continuous'){\n                let newTestData = fun(testData, dataFilters[i].selectedOption, dataFilters[i].predictedFilter, dataFilters[i].observedFilter);\n                dataFilters[i].data = [...newTestData];\n                dataFilters[i].filterId = 'c-'+ i;\n                //// Re adding in buttons ////\n                addFilterTag(dataFilters[i], scales);\n                testData = newTestData;\n            }else{//discrete\n                let newTestData = fun(testData, dataFilters[i].selectedOption, dataFilters[i].fromState, dataFilters[i].toState);\n                dataFilters[i].data = [...newTestData];\n                dataFilters[i].filterId = 'd-'+ i;\n                //// Re adding in buttons ////\n                addFilterTag(dataFilters[i], scales);\n                testData = newTestData;\n            }\n        }\n    }\n    let newFilterMaster = filterMaster.filter(f=> f.filterId != filterId);\n\n    filterMaster = newFilterMaster;\n}\n\nexport function addFilter(filterType, attType, filterId, filFunction, oldData, newData, extra){\n    let filterOb = {'filterType': filterType, 'attributeType': attType, 'filterId': filterId, 'filterFunction':filFunction, 'before-data': oldData, 'data': newData}\n    if(extra != null){\n        extra.forEach(ex=> {\n            filterOb[ex[0]] = ex[1];\n        });\n    }\n    filterMaster.push(filterOb);\n    return filterOb;\n}\n\nexport function getLatestData(){\n    let data = filterMaster.length > 0 ? filterMaster[filterMaster.length - 1].data : dataMaster[0];\n    return data;\n}\n\nexport function getScales(){\n    return calculatedScalesKeeper[calculatedScalesKeeper.length - 1];\n}\n\n///NEED TO BREAK THESE OUT INTO SEPARATE FILTERS\nexport function toggleFilters(filterButton, main, scales){\n    console.log(filterButton, main, scales)\n\n    let filterDiv = d3.select('#filter-tab');\n    let data = getLatestData();\n\n    if(filterDiv.classed('hidden')){\n        filterButton.text('Hide Filters');\n        filterDiv.classed('hidden', false);\n        main.style('padding-top', '200px');\n\n        //move metric is 'edgeLength'\n\n        //renderAttToggles(filterDiv, data, scales);\n        stateFilter(filterDiv, filterButton, data, main, scales);\n        queryFilter(filterDiv, filterButton, data, main, scales);\n\n    }else{\n        filterButton.text('Show Filters');\n        filterDiv.selectAll('*').remove();\n        filterDiv.classed('hidden', true);\n        main.style('padding-top', '0px');\n    }\n}\nfunction addFilterTag(data, scales){\n\n    let filterToolbar = d3.select('#toolbar');\n\n    if(data.attributeType === 'continuous'){\n\n        let formater = d3.format(\".2s\");\n        let button = filterToolbar.append('button').classed('btn btn-info filter-tag', true);\n        d3.select(button).datum(data);\n        let span = button.append('span').classed('badge badge-light', true);\n        span.text(data.data.length);\n        let label = button.append('h6').text(data.selectedOption + \"  Predicted: \"+ formater(data.predictedFilter[0]) + \"-\" + formater(data.predictedFilter[1]) + \" Observed: \" + formater(data.observedFilter[0]) + \"-\" + formater(data.observedFilter[1]));\n        let xSpan = label.append('i').classed('close fas fa-times', true);\n        xSpan.on('click', ()=> {\n            let filterLine = filterMaster.filter(f=> f.filterType === 'data-filter').filter(f=> data.attribute != f.attribute);\n            ////YOU NEED TO CHANGE THIS TO REMOVE FILTER FUNCTION\n            removeFilter(data.filterId, scales);\n            updateMainView('Summary View');\n            d3.selectAll('.link-not-there').classed('link-not-there', false);\n            d3.selectAll('.node-not-there').classed('node-not-there', false);\n            button.remove();\n        });\n\n    }else if(data.attributeType === 'discrete'){\n     \n        let button = filterToolbar.append('button').classed('btn btn-info filter-tag', true);\n        let span = button.append('span').classed('badge badge-light', true);\n        span.text(data.data.length);\n        button.append('h6').text(data.state[0]);\n        button.append('i').classed('fas fa-arrow-right', true);\n        button.append('h6').text(data.state[1] + '  ');\n       \n        let xSpan = button.append('i').classed('close fas fa-times', true);\n        xSpan.on('click', ()=> {\n            removeFilter(data.filterId, scales);\n            updateMainView('Summary View');\n            d3.selectAll('.link-not-there').classed('link-not-there', false);\n            d3.selectAll('.node-not-there').classed('node-not-there', false);\n            button.remove();\n        });\n\n    }else if(data.attributeType === 'branch'){\n        let button = filterToolbar.append('button').classed('btn btn-info filter-tag', true);\n        let span = button.append('span').classed('badge badge-light', true);\n        span.text(data.data.length);\n        button.append('h6').text(' At Branch: ' + data.nodeId);\n       \n        let xSpan = button.append('i').classed('close fas fa-times', true);\n        xSpan.on('click', ()=> {\n            removeFilter(data.filterId, scales);\n            updateMainView('Summary View');\n            d3.selectAll('.link-not-there').classed('link-not-there', false);\n            d3.selectAll('.node-not-there').classed('node-not-there', false);\n            button.remove();\n        });\n\n    }\n    \n}\nfunction stateFilter(filterDiv, filterButton, normedPaths, main, moveMetric, scales){\n    let keys = ['Select a Trait'].concat(Object.keys(normedPaths[0][0].attributes));\n        let selectWrapper = filterDiv.append('div').classed('filter-wrap', true);\n        selectWrapper.style('width', '200px');\n        selectWrapper.append('h6').text('State Transition:');\n        let attButton = stateChange(selectWrapper, keys, 'attr-select', '');\n\n        let attProps = selectWrapper.append('div').classed('attribute-properties', true);\n\n        attButton.on(\"change\", function(d) {\n            var selectedOption = d3.select(this).property(\"value\");\n            let options = scales.filter(f=> f.field === selectedOption)[0];\n            attProps.selectAll('*').remove();\n\n            if(options.type === \"discrete\"){\n                let optionArray = ['Any'];\n                let optKeys = options.scales.map(s=> s.scaleName);\n                optionArray = optionArray.concat(optKeys);\n                let button1 = stateChange(attProps, optionArray, 'predicted-state', 'From');\n                let button2 = stateChange(attProps, optionArray, 'observed-state', 'To');\n                let submit = attProps.append('button').classed('btn btn-outline-success', true);\n                submit.text('Filter');\n\n                submit.on('click', ()=> {\n                    let fromState = button1.node().classList[0];\n                    let toState = button2.node().classList[0];\n\n                      ////GOING TO ADD FILTERING HERE//// NEED TO BREAK INTO ITS OWN THING/////\n                      \n                    let lastFilter = filterMaster.filter(f=> f['filterType'] === 'data-filter');\n              \n                    //let data = lastFilter.length > 0 ? lastFilter[lastFilter.length - 1].data : dataMaster[0];\n                    let data = getLatestData();\n              \n                    let test = discreteFilter(data, selectedOption, fromState, toState);\n\n                    let filId = 'd-'+filterMaster.filter(f=> f.attributeType === 'discrete').length;\n                    let filterOb = addFilter('data-filter', 'discrete', filId, discreteFilter, [...data], [...test], [['state', [fromState, toState]], ['selectedOption', selectedOption]]);\n\n                    updateMainView('Summary View');\n\n                    ////Class Tree Links////\n                    let treeLinks  = d3.select('#sidebar').selectAll('.link');\n                    let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n                    let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n                    d3.selectAll('.link-not-there').classed('link-not-there', false);\n                    d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n                    let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingLinks.classed('link-not-there', true);\n\n                    let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingNodes.classed('node-not-there', true);\n\n                    ///END NODE DIMMING///////\n\n                    /////ADD THE FILTER TO THE TOOLBAR////\n                    addFilterTag(filterOb, scales);\n\n                    ////HIDE THE FILTER BAR/////\n                    filterButton.text('Show Filters');\n                    filterDiv.selectAll('*').remove();\n                    filterDiv.classed('hidden', true);\n                    main.style('padding-top', '0px');\n                });\n            }else{\n                \n                let yScale = d3.scaleLinear().domain([options.min, options.max]).range([60, 0]);\n               \n                let continRanges = attProps.append('svg');\n                continRanges.attr('width', 200).attr('height', 100);\n                let data = [{'label':'Ancestors', 'type': 'predicted'}, {'label':'Leaves', 'type': 'observed'}];\n                let ranges = continRanges.selectAll('.range').data(data).join('g').classed('range', true);\n\n                ranges.attr('transform', (d, i)=> 'translate('+((i*125)+',20)'));\n\n                let brushBars = ranges.append('g');\n                brushBars.attr('transform', 'translate(10, 10)');\n\n                let labels = ranges.append('text').text((d)=> d.label+ ': ');\n                labels.attr('x', 0).attr('y', 0);\n                let wrapperRect = brushBars.append('rect').attr('width', 20).attr('height', 50);\n                wrapperRect.attr('x', 10);\n\n                brushBars.append(\"g\")\n                .attr(\"class\", \"axis axis--y\")\n                .attr(\"transform\", \"translate(10,0)\")\n                .call(d3.axisLeft(yScale).ticks(3));\n                \n                let brushMoved = function(){\n                    var s = d3.event.selection;\n                    if (s == null) {\n                      handle.attr(\"display\", \"none\");\n                    \n                    } else {\n                      var sx = s.map(yScale.invert);\n                    }\n                };\n                let xBrush = d3.brushY().extent([[10,0], [30, 60]]).on(\"end\", brushMoved);\n                let brushGroup = brushBars.append('g').call(xBrush);\n                brushGroup.call(xBrush.move, [0, 60]);\n\n                let submit = attProps.append('button').classed('btn btn-outline-success', true);\n                submit.text('Filter');\n\n                submit.on('click', ()=> {\n\n                    let selections = brushGroup._groups[0].map(m=> m.__brush.selection.map(s=> s[1]));\n                    let predictedFilter = selections[0].map(yScale.invert).sort();\n                    let observedFilter = selections[1].map(yScale.invert).sort();\n                    let lastFilter = filterMaster.filter(f=> f['filterType'] === 'data-filter');\n\n                    let data = lastFilter.length > 0 ? lastFilter[lastFilter.length - 1].data : dataMaster[0];\n\n                    let test = continuousFilter(data, selectedOption, predictedFilter, observedFilter);\n\n                    let filId = 'c-'+filterMaster.filter(f=> f.attributeType === 'continuous').length;\n                    let filterOb = addFilter('data-filter', 'continuous', filId, continuousFilter, [...data], [...test], [['selectedOption', selectedOption], ['predictedFilter', predictedFilter], ['observedFilter', observedFilter]]);\n\n                    updateMainView('Summary View');\n\n                    /////ADD THE FILTER TO THE TOOLBAR/////\n                    addFilterTag(filterOb, scales);\n\n                    ///DIMMING THE FILTERED OUT NODES//////\n\n                    ////Class Tree Links////\n                    let treeLinks  = d3.select('#sidebar').selectAll('.link');\n                    let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n                    let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n                    d3.selectAll('.link-not-there').classed('link-not-there', false);\n                    d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n                    let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingLinks.classed('link-not-there', true);\n\n                    let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingNodes.classed('node-not-there', true);\n\n                    ///END NODE DIMMING///////\n\n                    ////HIDE THE FILTER BAR/////\n                    filterButton.text('Show Filters');\n                    filterDiv.selectAll('*').remove();\n                    filterDiv.classed('hidden', true);\n                    main.style('padding-top', '0px');\n                });\n            }\n         });\n}\nexport function nodeFilter(selectedNode, scales){\n   \n    let data = getLatestData();\n    let dataFilters = filterMaster.filter(f=> f.filterType === 'data-filter');\n \n    let test = data.filter(path => {\n        return path.map(node => node.node).indexOf(selectedNode) > -1;\n    });\n\n    let filId = 'b-'+filterMaster.filter(f=> f.attributeType === 'branch').length;\n    //let filterOb = addFilter('data-filter', 'discrete', filId, discreteFilter, [...data], [...test], [['state', [fromState, toState]], ['selectedOption', selectedOption]]);\n\n    let filterOb = addFilter('data-filter', 'branch', filId, nodeFilter, [...data], [...test], [['nodeId', selectedNode]])\n    addFilterTag(filterOb, scales);\n    updateMainView('Summary View');\n\n   ////Class Tree Links////\n   let treeLinks  = d3.select('#sidebar').selectAll('.link');\n   let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n   let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n   d3.selectAll('.link-not-there').classed('link-not-there', false);\n   d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n   let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingLinks.classed('link-not-there', true);\n\n   let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingNodes.classed('node-not-there', true);    \n  \n}\n\nexport function leafStateFilter(selectedState, scales){\n   \n    let data = getLatestData();\n    let dataFilters = filterMaster.filter(f=> f.filterType === 'data-filter');\n \n    let test = data.filter(path => {\n        return path[path.length - 1].attributes[selectedState.label].winState === selectedState.winState;\n    });\n\n    let filId = 'l-'+filterMaster.filter(f=> f.attributeType === 'leaf').length;\n    //let filterOb = addFilter('data-filter', 'discrete', filId, discreteFilter, [...data], [...test], [['state', [fromState, toState]], ['selectedOption', selectedOption]]);\n\n    let filterOb = addFilter('data-filter', 'leaf', filId, nodeFilter, [...data], [...test], [['leafState', [selectedState.label, selectedState.winState]]])\n    addFilterTag(filterOb, scales);\n    updateMainView('Summary View');\n\n   ////Class Tree Links////\n   let treeLinks  = d3.select('#sidebar').selectAll('.link');\n   let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n   let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n   d3.selectAll('.link-not-there').classed('link-not-there', false);\n   d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n   let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingLinks.classed('link-not-there', true);\n\n   let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingNodes.classed('node-not-there', true);    \n  \n}\n\n\nfunction continuousFilter(data, selectedOption, predicted, observed){\n\n    return data.filter(path=> {\n        let filterArray = path.map(node=> {\n            let numb = node.attributes[selectedOption].realVal;\n            if(node.leaf == true){\n                return numb > observed[0] && numb < observed[1];\n            }else{\n                return numb > predicted[0] && numb < predicted[1];\n            }\n        });\n        return filterArray.indexOf(false) === -1;\n    });\n}\nfunction discreteFilter(data, selectedOption, fromState, toState){\n    if(selectedOption != undefined){\n        return data.filter(path=> {\n            let filterPred = path.filter(f=> f.leaf != true).map(node=> {\n                let states = node.attributes[selectedOption].states;\n                if(fromState === 'Any'){\n                    return true;\n                }else{\n                    return states.filter(st=> st.state === fromState).length > 0 && states.filter(st=> st.state === fromState)[0].realVal > 0.75;\n                }\n            });\n            let filterObs = path.filter(f=> f.leaf === true).map(node=> {\n            let win = node.attributes[selectedOption].winState;\n            if(toState === 'Any'){\n                return true;\n            }else{\n                return win === toState;\n            }\n            });\n            return filterPred.indexOf(true) > -1 && filterObs.indexOf(true) > -1;\n        });\n    }\n}\nfunction queryFilter(filterDiv, filterButton, normedPaths, main, scales){\n\n    let moveMetric = 'edgeLength';\n\n    let searchDiv = filterDiv.append('div').classed('search-bar-div', true);\n        searchDiv.append('h6').text('Query Filter:');\n        let form = searchDiv.append('form').classed('form-inline', true);\n        let input = form.append('input').classed('form-control mr-sm-2', true);\n        input.attr('type', 'search').attr('placeholder', 'Search by Species').attr('aria-label', 'Search');\n        let searchButton = form.append('button').classed('btn btn-outline-success my-2 my-sm-0', true).attr('type', 'button').append('i').classed(\"fas fa-search\", true);\n        searchButton.on('click', ()=> {\n\n            let queryArray = input.node().value.split(' ').map(m=> m.toLowerCase());\n\n            let test = normedPaths.filter(path=> {\n                let species = path.filter(node=> node.leaf === true)[0].label;\n                return queryArray.indexOf(species) > -1;\n            });\n\n             ////DRAW THE PATHS\n         \n             updateMainView('Summary View');\n\n            let filterToolbar = d3.select(\"#toolbar\");\n            let button = filterToolbar.append('button').classed('btn btn-info', true);\n            let span = button.append('span').classed('badge badge-light', true);\n            span.text(test.length);\n            button.append('h6').text('Query Filter');\n            let xSpan = button.append('i').classed('close fas fa-times', true);\n            xSpan.on('click', ()=> {\n                updateMainView('Summary View');\n                button.remove();\n            });\n            d3.select('#main-path-view').style('height', ()=>{\n                return ((test.length * 60) + (Object.keys(test[0][0].attributes).length * 100) + 'px');\n            });\n\n            ////HIDE THE FILTER BAR/////\n            filterButton.text('Show Filters');\n            filterDiv.selectAll('*').remove();\n            filterDiv.classed('hidden', true);\n            main.style('padding-top', '0px');\n        });\n\n}\nfunction renderAttToggles(filterDiv, normedPaths, scales){\n\n    console.log(normedPaths, scales.map(m=> m.field))\n\n    ////NEED TO GET RID OF TOGGLE SVG\n   // let keys = Object.keys(normedPaths[0][0].attributes);\n   let keys = scales.map(m=> m.field);\n    let presentFilters = filterMaster.filter(f=> f.type === 'hide-attribute');\n    let noShow = presentFilters.length > 0 ? presentFilters.map(m=> m.attribute) : [];\n\n    let wrapper = filterDiv.append('div').classed('filter-wrap', true);\n    wrapper.style('width', '150px');\n   \n    let svg = wrapper.append('svg').classed('attr-toggle-svg', true);\n\n   let title = svg.append('text').text('Attributes: ');\n    title.attr('x', 20).attr('y', 10);\n    \n    let labelWrap = svg.append('g').attr('transform', 'translate(20, 25)');\n    let labelGroups = labelWrap.selectAll('g').data(keys).join('g'); \n    \n    labelGroups.attr('transform', (d, i)=> 'translate(0,'+(i* 25)+')');\n\n    let toggle = labelGroups.append('circle').attr('cx', 0).attr('cy', 0);\n    toggle.classed('toggle', true);\n    let shownToggs = toggle.filter(t=> noShow.indexOf(t) === -1);\n   \n    shownToggs.classed('shown', true);\n    shownToggs.style('fill', (d, i)=>{\n        return scales.filter(f=> f.field === d)[0].catColor;\n    });\n\n    toggle.on('click', function(d, i){\n        let togg = d3.select(this);\n        toggleCircle(togg, scales);\n        filterMaster.push({'type':'hide-attribute', 'attribute':d, 'before-data': [...normedPaths]});\n        let newKeys = d3.selectAll('.shown');\n        let hideKeys = scales.filter(sc=> newKeys.data().indexOf(sc.field) === -1);\n        let newFilMaster = filterMaster.filter(f=> f.type != 'hide-attribute');\n        hideKeys.forEach(key=> {\n            newFilMaster.push({'type':'hide-attribute', 'attribute':key.field, 'before-data': [...normedPaths], 'data': [...normedPaths]});\n        });\n        filterMaster = newFilMaster;\n    \n        updateMainView(\"Summary View\");\n    });\n    let labelText = labelGroups.append('text').text(d=> d).style('font-size', 10);\n    labelText.attr('transform', 'translate(10, 4)');  \n    \n}\nfunction stateChange(selectorDiv, keys, selectId, label){\n\n    let dropDownWrapper = selectorDiv.append('div').classed('selector', true);\n    let header = dropDownWrapper.append('h6').text(label);\n\n    \t// create the drop down menu of cities\n\tlet selectOp = dropDownWrapper\n    .append(\"select\")\n    .attr(\"id\", selectId).attr('class', 'Any');\n    \n    let options = selectOp.selectAll(\"option\")\n    .data(keys).join(\"option\");\n\n    options.text(d=> d).attr(\"value\", d=> d);\n\n    d3.select(\"#\"+selectId).on(\"change\", function(d) {\n       var selectedOption = d3.select(this).property(\"value\");\n       d3.select(this).attr('class', selectedOption);\n    });\n\n    return d3.select('#'+ selectId);\n}\nfunction toggleCircle(circle, scales){\n    if(circle.classed('shown')){\n        circle.classed('shown', false);\n        circle.style('fill', '#fff');\n    }else{\n        circle.classed('shown', true);\n        circle.style('fill', (d, i)=> scales.filter(f=> f.field === d)[0].catColor);\n    }\n}","import '../styles/index.scss';\nimport * as d3 from \"d3\";\nimport {drawPathsAndAttributes, drawDiscreteAtt, drawGroups} from './renderPathView';\nimport {toggleFilters, getLatestData} from './filterComponent';\nimport { updateMainView } from './viewControl';\nimport { collapsed, calculatedScalesKeeper, workspace, loadApp } from '.';\nimport { dropDown } from './buttonComponents';\nimport { cladesGroupKeeper, chosenCladesGroup, cladeKeeper } from './cladeMaker';\nimport { binGroups, renderDistStructure } from './distributionView';\n\n\nexport function findBrushedNodes(){\n    let brushes = d3.select('#toolbar').selectAll('.brush-span');\n    let brushData =  [];\n    brushes.each(e => brushData.push(e))\n  \n    let nodes = brushData.flatMap(m=> m.nodes);\n    return nodes;\n}\nexport function toolbarDataControl(toolbar, graphList, chosenGraph){\n\n    let dataDrop = dropDown(toolbar, graphList, chosenGraph.text, 'change-data');\n    d3.select('.dropdown.change-data').select('button').node().value = chosenGraph.field;\n    dataDrop.on('click', (d, i, n)=> {\n        d3.select('.dropdown.change-data').select('button').node().value = d.field;\n        d3.select('.dropdown.change-data').select('button').text(d.text)\n        d3.select('#change-data').classed('show', false);\n        let main = d3.select('#main');\n        let sidebar = d3.select('#sidebar');\n        let toolbarDiv = d3.select('#toolbar');\n        let toolbarButtonWrap = toolbarDiv.select('.toolbar-button-wrap');\n\n        main.selectAll('*').remove();\n        sidebar.selectAll('*').remove();\n        toolbarButtonWrap.selectAll('*').remove();\n\n        loadApp(workspace, d.field);\n\n\n    });\n\n}\nexport function toolbarControl(toolbar, main, calculatedScales){\n\n    let viewArray = [{'field':'Summary View'},{'field':'Path View'},{'field':'Pair View'}];\n\n    let viewDrop = dropDown(toolbar, viewArray, viewArray[0].field, 'change-view');\n\n    viewDrop.on('click', (d, i, n)=> {\n        let group = chosenCladesGroup[chosenCladesGroup.length - 1];\n        updateMainView(d.field, group.groups);\n        d3.select('.dropdown.change-view').select('button').node().value = d.field;\n        d3.select('.dropdown.change-view').select('button').text(d.field)\n        d3.select('#change-view').classed('show', false);\n    });\n    \n    let filterButton = toolbar.append('button').attr('id', 'view-filter');\n    filterButton.attr('class', 'btn btn-outline-secondary').text('Show Filters');\n    filterButton.on('click', ()=> toggleFilters(filterButton, main, calculatedScales));\n    ///LENGTH BUTTON CODE\n\n    let scrunchButton = toolbar.append('button').attr('id', 'scrunch');\n    scrunchButton.attr('class', 'btn btn-outline-secondary').text('Collapse Attributes');\n    scrunchButton.attr('value', false);\n    scrunchButton.on('click', ()=> toggleScrunch(scrunchButton, main, calculatedScales));\n\n    let discreteViewButton = toolbar.append('button').attr('id', 'discrete-view');\n    discreteViewButton.attr('class', 'btn btn-outline-secondary').text('Switch to Discrete Bars');\n    discreteViewButton.attr('value', false);\n    \n    discreteViewButton.on('click', ()=> {\n        let discretePredictedGroups = d3.selectAll('.predicated-attr-groups');\n        if(discreteViewButton.text() === 'Switch to Discrete Bars'){\n            discreteViewButton.text('Switch to Discrete Dots');\n            drawDiscreteAtt(discretePredictedGroups, collapsed, true);\n        }else{\n            discreteViewButton.text('Switch to Discrete Bars');\n            drawDiscreteAtt(discretePredictedGroups, collapsed, false);\n        }\n    });\n\n    let optionArray = [{'field':'None'}];\n\n    calculatedScales.map(m=> {\n        if(m.type === 'discrete'){\n            optionArray.push(m);\n        }\n    });\n\n    let dropOptions = dropDown(toolbar, optionArray, 'Group By', 'show-drop-div-group');\n    toolbar.select('#show-drop-div-group').attr('value', 'ungrouped');\n\n    d3.select('.dropdown.show-drop-div-group').select('button').style('display', 'none')\n\n    dropOptions.on('click', (d, i, n)=> {\n        if(d.type === 'discrete'){\n            let data = getLatestData();\n            let stateBins = d.scales.map(m=> {\n                return {'field': m.field, 'state': m.scaleName, 'data': []}});\n           \n            stateBins.map(state=> {\n               state.data = data.filter(paths=> {\n                    let node = paths.filter(no=> no.leaf === true);\n                        return node[0].attributes[state.field].winState === state.state;\n                });\n            });\n           d3.select('#main').selectAll('*').remove();\n           drawGroups(stateBins, calculatedScales);\n        }else{\n            console.error('THIS HAS TO BE DISCRETE');\n        }\n        toolbar.select('#show-drop-div-group').classed('show', false);\n    });\n\n    /////ATTRIBUTE DROP DOWN\n    let attributeOptions = calculatedScales.map(m=> m.field).filter(f=> f != \"Clade\");\n    let checkedAttributes = attributeOptions.length > 11 ? attributeOptions.slice(0, 8) : attributeOptions;\n\n    let dropdiv = toolbar.append('div').classed(`dropdown attribute-show`, true);\n    dropdiv.style('display', 'inline-block')\n    let button = dropdiv.append('button').classed('btn dropbtn btn-secondary dropdown-toggle', true).text('Shown Attributes');\n    let dropContent = dropdiv.append('div').attr('id', 'attribute-show').classed('dropdown-content', true);\n    let dropUl = dropContent.append('ul');\n    \n    let attoptions = dropUl.selectAll('li').data(attributeOptions).join('li')\n    let checkBox = attoptions.append('input').attr('type', 'checkbox');\n    attoptions.append('text').text(d=> ` ${d}`);\n\n    let checkedDefault = attoptions.filter(f=> checkedAttributes.indexOf(f) > -1).select('input');\n    checkedDefault.each((d, i, n) => n[i].checked = true);\n\n    button.on('click', (d, i, n)=> {\n        if(dropContent.classed('show')){\n            dropContent.classed('show', false);\n            updateMainView('Summary View', chosenCladesGroup[chosenCladesGroup.length - 1].groups)\n        }else{\n            dropContent.classed('show', true);\n        }\n    });\n\n    // /////CLADE VIEW////\n    // let cladePickerDrop = dropDown(toolbar, cladesGroupKeeper, `Clades Shown: ${cladesGroupKeeper[0].field}`, 'change-clade');\n    // d3.select('#change-clade').selectAll('a').on('click', (d, i, n)=> {\n    //     d3.select('.dropdown.change-clade').select('button').text(`Clades Shown: ${d.field}`)\n    //     chosenCladesGroup.push(d)\n    //     updateMainView('Summary View', d.groups);\n    // });\n    // if(cladesGroupKeeper.length === 0){\n    //     d3.select('.dropdown.change-clade').select('button').text(d.field);\n    // }\n\n    /////ATTRIBUTE DROP DOWN\n    let cladeOptions = cladeKeeper;\n   // let checkedClades = attributeOptions.length > 11 ? attributeOptions.slice(0, 2) : attributeOptions;\n\n    let dropdivClade = toolbar.append('div').classed(`dropdown clade-show`, true);\n    dropdivClade.style('display', 'inline-block')\n    let buttonClade = dropdivClade.append('button').classed('btn dropbtn btn-secondary dropdown-toggle', true).text('Shown Clades');\n\n    let dropContentClade = dropdivClade.append('div').attr('id', 'clade-show').classed('dropdown-content', true);\n    let dropUlClade = dropContentClade.append('ul');\n\n    let options = updateCladeDrop(dropUlClade, cladeOptions);\n\n    buttonClade.on('click', (d, i, n)=> {\n        if(dropContentClade.classed('show')){\n            dropContentClade.classed('show', false);\n           \n           let test = d3.select('#clade-show').selectAll('li').selectAll('input').filter((f, j, li)=> {\n                return li[j].checked === true});\n            \n                let groups = test.data().map((m=> {\n                let names = m.nodes.map(path => path[path.length - 1].node);\n                let data = getLatestData().filter(path => names.indexOf(path[path.length - 1].node) > -1);\n                \n                let group = binGroups(data, m.field, calculatedScalesKeeper[0], 8);\n                return {'label': m.field, 'paths': data, 'groupBins': group};\n           }));\n\n           d3.select('#summary-view').remove();\n           \n           renderDistStructure(main, groups);  \n\n        }else{\n            dropContentClade.classed('show', true);\n        }\n    });\n}\n\nexport function updateCladeDrop(dropUl, cladeOptions){\n\n    let options = dropUl.selectAll('li').data(cladeOptions).join('li')\n    let checkBox = options.selectAll('input').data(d=> [d]).join('input').attr('type', 'checkbox');\n    options.selectAll('text').data(d=> [d]).join('text').text(d=> ` ${d.field}`);\n    \n    if(cladeOptions.length < 1){\n        d3.select('.dropdown.clade-show').select('button').classed('hidden', true);\n    }else{\n        d3.select('.dropdown.clade-show').select('button').classed('hidden', false);\n    }\n\n    return options;\n    \n    // let checkedDefault = options.filter(f=> checkedAttributes.indexOf(f) > -1).select('input');\n}\n////COLLAPSES THE NODES DOWN\nfunction toggleScrunch(button, main, calculatedScales){\n\n    let data = getLatestData();\n   \n    if(button.text() === 'Collapse Attributes'){\n        button.text('Expand Attributes');\n        main.selectAll('*').remove();\n        button.attr('value', true);\n        drawPathsAndAttributes(data, main, calculatedScales);\n    }else{\n        button.text('Collapse Attributes');\n        main.selectAll('*').remove();\n        button.attr('value', false);\n        drawPathsAndAttributes(data, main, calculatedScales);\n    }\n}","import {dataMaster, nestedData, calculatedScalesKeeper} from './index';\nimport { updateDropdown } from './buttonComponents';\nimport * as d3 from \"d3\";\nimport { addingEdgeLength, assignPosition, renderTree, renderTreeButtons, traitColorDropDown } from './sidebarComponent';\nimport { maxTimeKeeper } from './dataFormat';\nimport { getLatestData, getScales } from './filterComponent';\nimport { renderDistStructure, binGroups } from './distributionView';\nimport { updateMainView } from './viewControl';\nimport { pullPath } from './pathCalc';\nimport { updateCladeDrop } from './toolbarComponent';\n\nexport const cladesGroupKeeper = []\nexport const chosenCladesGroup = []\nexport const cladeKeeper = []\n\n\n\nexport function growSidebarRenderTree(attrDraw){\n\n    let sidebar = d3.select('#sidebar');\n    let cladeBool = null;\n\n    sidebar.classed('clade-view', true);\n    d3.select('#main').classed('clade-view', true);\n\n    sidebar.select('.tree-svg').remove();\n    sidebar.select('.button-wrap').selectAll('*').remove();\n\n    traitColorDropDown(getScales(), sidebar.select('.button-wrap'), growSidebarRenderTree);\n\n    let x = sidebar.select('.button-wrap').append('div')\n    .style('position', 'absolute')\n    .style('right', '5px')\n    .style('top', '18px')\n    .append('i')\n    .classed('close fas fa-times', true)\n    .style('padding-right', '10px');\n\n    x.on('click', ()=> {\n     \n        sidebar.classed('clade-view', false);\n        d3.select('#main').classed('clade-view', false);\n\n        sidebar.selectAll('*').remove();\n\n        ////REDRAW SIDEBAR\n        renderTreeButtons(getLatestData(), sidebar, false);\n        renderTree(sidebar, null, true, false);\n\n    });\n\n    const dimensions =  {\n        margin : {top: 10, right: 90, bottom: 50, left: 20},\n        width : 400,\n        height : (getLatestData().length * 7),\n        lengthHeight: 500,\n    }\n   \n    renderCladeTree(sidebar, null, dimensions);\n\n    let leaf = sidebar.select('.tree-svg').selectAll('.node--leaf');\n    let nodes = sidebar.select('.tree-svg').selectAll('.node');\n    let link = sidebar.select('.tree-svg').selectAll('.link');\n\n    let nodeData = getLatestData();\n  \n    function  findCommonNode(path1, path2, className){\n\n        let common = path1.filter(f=> path2.map(m=> m.node).indexOf(f.node) > -1);\n        let subtreeFinder = [nestedData[0]];\n        let commonNodeMark = nodes.filter(f=> f.data.node === common[common.length - 1].node);\n      \n        common.map(m=> m.node).map((m, i)=> {\n            if(i > 0){\n                let child = subtreeFinder[subtreeFinder.length - 1].children.filter(f=> {\n                    return f.node === m})[0];\n                subtreeFinder.push(child)\n            }\n        })\n\n        let paths = pullPath([subtreeFinder[subtreeFinder.length - 1]], subtreeFinder[subtreeFinder.length - 1].children, [], [], 0);\n        \n        let nodeNames = paths.flatMap(path => path.map(p=> p.node))\n        nodes.filter(f=> nodeNames.indexOf(f.data.node) > -1).select('circle').classed(className, true);//.attr('fill', 'orange');\n        link.filter(f=> nodeNames.filter((n)=> n != common[common.length - 1].node).indexOf(f.data.node) > -1).classed(className, true);//.style('stroke', 'orange');\n\n        return paths;\n\n    }\n   \n    labelTree(leaf);\n\n    if(attrDraw != null){\n       // let leaves = node.filter(n=> n.data.leaf === true);\n        let notleaves = nodes.filter(n=> n.data.leaf != true);\n\n        if(attrDraw.type === 'discrete'){\n            attrDraw.stateColors.forEach(att=> {\n                let circ = leaf.filter(f=> {\n                    return att.state.includes(f.data.attributes[attrDraw.field].states.state)\n                }).select('circle');\n                circ.attr('fill', att.color);\n                notleaves.selectAll('circle').attr('fill', 'gray');\n            });\n        }else{\n            let scale = attrDraw.yScale;\n            scale.range(['#fff', '#E74C3C']);\n            leaf.select('circle').attr('fill', (d, i)=> {\n                return scale(d.data.attributes[attrDraw.field].values.realVal);\n            });\n        }\n    }else{\n        nodes.selectAll('circle').attr('fill', 'gray');\n    }\n\n    leaf.on('click', (d, i, n)=> {\n   \n        d3.select(n[i]).select('circle').attr('fill', 'orange').attr('r', '5');\n        if(cladeBool === null){\n            cladeBool = d;\n        }else{\n            let dat1 = nodeData.filter(f=> f[f.length-1].node === cladeBool.data.node)[0];\n            let dat2 = nodeData.filter(f=> f[f.length-1].node === d.data.node)[0];\n            let paths = findCommonNode(dat1, dat2, 'selected');\n\n            let wrap = sidebar.select('.button-wrap').append('form').classed(\"form-inline\", true)\n            .append('div').classed(\"form-group\", true).style('width', '300px');\n            \n            let textInput = wrap.append('input').attr('type', 'text')\n            .classed('form-control', true)\n            .attr('placeholder', 'Clade Name');\n\n            let button = wrap.append('div').classed('input-group-append', true).append('button').attr('type', 'button').classed('btn btn-outline-secondary', true);\n            button.text('Add Clade');\n            \n            button.on('click', ()=> {\n                let name = textInput.node().value != \"\" ? textInput.node().value : `Clade-${cladeKeeper.length}`\n                addClade(name, paths);\n                growSidebarRenderTree(null);\n                let ul = d3.select('div#clade-show').selectAll('ul');\n                updateCladeDrop(ul, cladeKeeper);\n            });\n            cladeBool = null;\n        }\n    });\n    leaf.on('mouseover', (d, i, n)=> {\n        if(cladeBool!=null){\n            let dat1 = nodeData.filter(f=> f[f.length-1].node === cladeBool.data.node)[0];\n            let dat2 = nodeData.filter(f=> f[f.length-1].node === d.data.node)[0];\n            findCommonNode(dat1, dat2, 'selected-hover');\n        }\n\n    }).on('mouseout', ()=> {\n        sidebar.selectAll('.selected-hover').classed('selected-hover', false);\n    });\n\n   sidebar.select('.tree-svg').classed('clade-view', true).append('g').classed('overlay-brush', true);\n\n}\n\nexport function addClade(name, nodes){\n    console.log('in add clade',name, nodes)\n    cladeKeeper.push({field: name, nodes: nodes})\n}\n\nexport function addCladeGroup(name, clades, nodes){\n    cladesGroupKeeper.push({field: name, names: clades, groups:nodes});\n    return {field: name, names: clades, groups:nodes};\n}\n\nexport function removeCladeGroup(clades){\n    cladeKeeper = cladeKeeper.filter(f=> f.groupKey != clades.groupKey);\n}\n\n\nfunction createNewCladeGroup(div, scales){\n    let cladeNames = []\n    let clades = []\n    d3.selectAll('.clade-name').each((e, i, n)=> {\n       cladeNames.push(n[i].value);\n       let rectTest = d3.select(`.rect-${i + 1}`).node().getBoundingClientRect();\n       let nodes = div.select('.tree-svg.clade-view').selectAll('.node--leaf').filter((f, j, node)=> {\n           let circPos = node[j].getBoundingClientRect();\n           return circPos.y >= rectTest.y-4 && circPos.y <= ((rectTest.y + rectTest.height) - 4);\n       })\n       nodes.select('circle').attr('fill', 'red');\n       clades.push({'clade': n[i].value , 'nodes': nodes.data().map(m=> m.data)})\n    });\n \n    let groupName = d3.select('.group-name').node().value;\n    let chosenGroup = addCladeGroup(groupName, cladeNames, clades);\n    updateDropdown(cladesGroupKeeper, 'change-clade');\n    let groups = groupDataByClade(scales, getLatestData(), chosenGroup);\n\n    d3.select('.dropdown.change-clade').select('button').text(`Clades Shown: ${chosenGroup.field}`);\n\n    updateMainView('Summary View', groups);\n    renderTree(d3.select('#sidebar'), null, true, false)\n}\n\n// function cladeToolbar(div, scales){\n\n//     let toolBar = div.append('div').classed('clade-toolbar', true);\n//     let textInput = toolBar.append('input')\n//     .classed('group-name', true)\n//     .attr('type', 'text')\n//     .attr('value', 'Name Your Group');\n  \n//     let addCladeGroupButton = toolBar.append('button').text('Add Clade Group');\n//     addCladeGroupButton.on('click', ()=> createNewCladeGroup(div, scales));\n\n//     let inputGroup = toolBar.append('div').classed('input-group input-number-group', true);\n//     let minusButton = inputGroup.append('button').text('-');\n   \n//     let numberText = inputGroup.append('input')\n//         .attr('value', 3)\n//         .attr('min', 0)\n//         .attr('max', 10)\n//         .attr('type', 'number')\n//         .classed('input-number', true);\n\n//     let plusButton = inputGroup.append('button').text('+');\n\n//     let nameWrap = inputGroup.append('div').classed('name-input-wrap', true);\n//     minusButton.on('click', ()=> {\n//         let num = numberText.attr('value');\n//         numberText.attr('value', +num - 1);\n//         addTextInputForGroups(+numberText.attr('value'), nameWrap);\n//     });\n\n//     plusButton.on('click', ()=> {\n//         let num = numberText.attr('value');\n//         numberText.attr('value', +num + 1);\n//         addTextInputForGroups(+numberText.attr('value'), nameWrap);\n//     });\n\n//     addTextInputForGroups(+numberText.attr('value'), nameWrap);\n\n//     function addTextInputForGroups(index, nameWrap){\n       \n//         nameWrap.selectAll('*').remove();\n//         d3.selectAll('.overlay-brush').selectAll('rect').remove();\n//         for(let ind = 0; ind < index; ind = ind + 1){\n//             nameWrap.append('input')\n//             .classed('clade-name', true)\n//             .attr('value', `Group ${ind+1}`)\n//             .attr('type', 'text');\n\n//             let rectGroup = d3.select('.overlay-brush').append('g').classed(`group-${ind}`, true)\n\n//             let rect = rectGroup.append('rect')\n//             .classed(`rect-${ind + 1}`, true)\n//             .attr('height', 100)\n//             .attr('width', 910)\n//             .attr('opacity', 0.3)\n//             .attr('transform',  (d, i, n)=> `translate(${0},${((800 / index) * ind)})`);\n\n//             let rectSizer = rectGroup.append('rect').attr('class', `handle-${ind}`)\n//             .attr('width', 700)\n//             .attr('height', 20)\n//             .attr('y', rect.node().getBoundingClientRect().y + 20)\n//             .attr('opacity', 0)\n//             .call(d3.drag()\n//             .on('drag', function(){\n//                 let dragPos = d3.mouse(this);\n//                 let dragY = d3.event.y\n//                 d3.select(this).attr('y', dragPos[1]);\n//                 let height = +d3.select(`.rect-${ind + 1}`).attr('height')\n//                 let rectY = d3.select(`.rect-${ind + 1}`).node().getBoundingClientRect().bottom;\n//                 d3.select(`.rect-${ind + 1}`).attr('height', height + (dragY-rectY) + 70);\n//             }));\n            \n//             rect.call(d3.drag().on('drag', function(){\n//                 let dragPos = d3.mouse(this);\n//                 let dragY = d3.event.y\n//                 d3.select(this).attr('y', dragPos[1]);\n//                 let rectH = d3.select(`.rect-${ind + 1}`).node().getBoundingClientRect().height;\n//                 d3.select(`.handle-${ind}`).attr('y', dragY + (rectH - 20));\n//             }))\n//         }\n//     }\n// }\n\nfunction labelTree(nodes){\n    nodes.append('text')\n    .text(d=> d.data.node)\n    .attr('font-size', 9)\n    .attr('x', 4)\n    .attr('y', 2)\n}\n\nexport async function createCladeView(div, scales){\n    drawTreeForGroups(div);\n    cladeToolbar(div, scales);\n}\n\nexport function renderCladeTree(sidebar, att, dimensions){\n\n     addingEdgeLength(0, nestedData[0]);\n    \n    let treeFun = data => {\n        const root = d3.hierarchy(data);\n        return d3.tree().size([dimensions.width, dimensions.height])(root);\n      }\n\n    let treenodes = treeFun(nestedData[0]);\n\n    let treeSvg = sidebar.append(\"svg\").classed('tree-svg', true);\n    let g = treeSvg.append(\"g\").classed('tree-g', true);\n   \n    ////Break this out into other nodes////\n    updateCladeTree(treenodes, dimensions, treeSvg, g, att, true);\n    \n    /////END TREE STUFF\n    ///////////\n}\n\nexport function findDepth(node, array){\n    function stepDown(n){\n        if(n.children != null){\n            n.children.forEach(child=> {\n                stepDown(child);\n            })\n        }else{\n            array.push(n);\n        }\n    }\n    stepDown(node);\n    return array;\n}\n\nexport function updateCladeTree(treenodes, dimensions, treeSvg, g, attrDraw, length){\n    \n    assignPosition(treenodes, 0);\n\n    treeSvg.attr(\"width\", dimensions.width + dimensions.margin.left + dimensions.margin.right)\n    .attr(\"height\", dimensions.height + (dimensions.height / 1.5));\n\n    findDepth(treenodes, []);\n    let xScale = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.width]).clamp(true);\n    let yScale = d3.scaleLinear().range([dimensions.height, 0]).domain([0, getLatestData().length])\n    g.attr('transform', `translate(30, ${dimensions.height / 1.9})`);\n\n    let link = g.selectAll(\".link\")\n    .data( treenodes.descendants().slice(1))\n    .join(\"path\")\n    .attr(\"class\", \"link\");\n\n    link.transition()\n    .duration(500)\n    .attr(\"d\", function(d) {\n       \n           return \"M\" + xScale(d.data.combEdge) + \",\" + yScale(d.position)\n           + \"C\" + (xScale(d.data.combEdge) + xScale(d.parent.data.combEdge)) / 2 + \",\" + yScale(d.position)\n           + \" \" + (xScale(d.parent.data.combEdge)) + \",\" + yScale(d.position)\n           + \" \" + xScale(d.parent.data.combEdge) + \",\" + yScale(d.parent.position);\n     \n    });\n\n    // adds each node as a group\n    var node = g.selectAll(\".node\")\n    .data(treenodes.descendants(), d => d.data.node)\n    .join(\"g\")\n    .attr(\"class\", function(d) { \n    return \"node\" + \n    (d.children ? \" node--internal\" : \" node--leaf\"); });\n\n    // adds the circle to the node\n    node.selectAll('circle').data(d=> [d]).join(\"circle\")\n      .attr(\"r\", 3);\n\n    node.transition()\n    .duration(500)\n    .attr(\"transform\", function(d) { \n            return \"translate(\" + xScale(d.data.combEdge) + \",\" + yScale(d.position) + \")\"; \n    });\n\n    if(attrDraw != null){\n        let leaves = node.filter(n=> n.data.leaf === true);\n        let notleaves = node.filter(n=> n.data.leaf != true);\n\n        if(attrDraw.type === 'discrete'){\n            attrDraw.stateColors.forEach(att=> {\n                let circ = leaves.filter(f=> {\n                    return att.state.includes(f.data.attributes[attrDraw.field].states.state)//f.data.attributes[attrDraw.field].winState === att.state;\n                }).select('circle');\n                circ.attr('fill', att.color);\n                notleaves.selectAll('circle').attr('fill', 'gray');\n            });\n        }else{\n            let scale = attrDraw.yScale;\n            scale.range(['#fff', '#E74C3C']);\n            leaves.select('circle').attr('fill', (d, i)=> {\n                return scale(d.data.attributes[attrDraw.field].values.realVal);\n            });\n        }\n    }else{\n        node.selectAll('circle').attr('fill', 'gray');\n    }\n\n    node.on('mouseover', (d, i, n)=> {\n        let paths = d3.select('#main-path-view').selectAll('.paths');\n        let points = d3.select('#main-summary-view').selectAll('.branch-points');\n        points.filter(f=> f.node === d.data.node).classed('selected', true);\n\n        let selectedPaths = paths.filter(path=> {\n            let nodes = path.map(m=> m.node);\n            return nodes.indexOf(d.data.node) > -1;\n        }).classed('hover', true);\n        selectedPaths.selectAll('g').filter(g=> g.node === d.data.node).classed('selected', true);\n        d3.select(n[i]).classed('selected-branch', true);\n\n        if(d.data.label){\n            let tool = d3.select('#tooltip');\n            tool.transition()\n            .duration(200)\n            .style(\"opacity\", .9);\n          \n            tool.html(`${d.data.label.charAt(0).toUpperCase() + d.data.label.slice(1)}`)\n            .style(\"left\", (d3.event.pageX - 40) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            tool.style('height', 'auto');\n        }\n\n    }).on('mouseout', (d, i, n)=> {\n        d3.selectAll('.paths.hover').classed('hover', false);\n        d3.selectAll('g.selected').classed('selected', false);\n        d3.select(n[i]).classed('selected-branch', false);\n\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(500)\n          .style(\"opacity\", 0);\n    });\n\n    let leaves = node.filter(f=> f.data.children.length == 0);\n\n    node.selectAll('text').remove();\n    node.selectAll('.triangle').remove();\n\n    let branchNodes = node.filter(n=> n.branchPoint === true);\n    branchNodes.each((b, i, n)=> {\n        if(b.children === null){\n            let triangle = d3.select(n[i]).append('path').classed('triangle', true).attr('d', d3.symbol().type(d3.symbolTriangle).size('400'))\n            triangle.attr('transform', `rotate(-90) translate(0, 65) scale(.9 4)`);\n            triangle.attr('fill', 'gray').style('opacity', 0.3);\n            let text = d3.select(n[i]).selectAll('text').data(d=> [d]).join('text').text(b.clade);\n            text.attr('transform', 'translate(55, 5)');\n        }\n    })\n    branchNodes.select('circle').attr('fill', 'red').attr('r', 4.5);\n    branchNodes.on('click', (d, i, n)=> {\n        if(d.children == null){\n            uncollapseSub(d);\n        }else{\n            collapseSub(d);\n        }\n        let lengthBool = d3.select('button#length').text() === 'Hide Lengths';\n        updateCladeTree(treenodes, dimensions, treeSvg, treeSvg.select('g'), attrDraw, lengthBool);\n      \n    });\n\n    node.raise();\n    node.selectAll('circle').raise();\n\n    return node;\n}","import '../styles/index.scss';\nimport * as d3 from \"d3\";\n\nimport {dataMaster, nestedData, collapsed} from './index';\nimport {getScales} from './filterComponent';\nimport {getNested} from './pathCalc';\nimport { dropDown } from './buttonComponents';\nimport { updateRanking } from './pairView';\nimport { pairPaths, maxTimeKeeper } from './dataFormat';\nimport { cladesGroupKeeper, chosenCladesGroup, growSidebarRenderTree } from './cladeMaker';\n\n\nexport function buildTreeStructure(paths, edges){\n   \n    let root = paths[0][0];\n    let nestedData = getNested(root, edges);\n    return nestedData;\n}\n\nexport function traitColorDropDown(scales, sidebar, renderCallback){\n\n    let optionArray  = reduce2DropArray(scales);\n\n    let dropOptions = dropDown(sidebar, optionArray, `Color By Value`,'show-drop-div-sidebar');\n    dropOptions.on('click', (d, i, n)=> {\n        if(d.type === 'discrete'){\n            renderCallback(d, true, false)\n            d3.select('.dropdown.show-drop-div-sidebar').select('button').text(`Colored by ${d.field}`)\n        }else if(d.type === 'continuous'){\n            renderCallback(d, true, false)\n            d3.select('.dropdown.show-drop-div-sidebar').select('button').text(`Colored by ${d.field}`);\n        }else{\n             renderCallback(null, true, false)\n            d3.select('.dropdown.show-drop-div-sidebar').select('button').text(`Color By Value`);\n        }\n    sidebar.select('#show-drop-div-sidebar').classed('show', false);\n    });\n\n}\n\nexport function reduce2DropArray(startArray){\n    return  startArray.reduce(function(array, scale){\n        array.push(scale);\n        return array; \n    }, [{'field':'None'}]); \n}\n\nexport function renderTreeButtons(normedPaths){\n\n    let scales = getScales();\n    let sidebar = d3.select('#sidebar');\n\n    ///SIDBAR STUFF\n    let buttonWrap = sidebar.append('div').classed('button-wrap', true);\n    traitColorDropDown(scales, buttonWrap, renderTree);\n    let phenoOptions = reduce2DropArray(scales.filter(f=> f.type != 'discrete'));\n \n      ///BUTTON FOR PHENOGRAM VIEW. MAYBE MOVE THIS TO SIDEBAR\n    let phenogramButton = d3.select('#sidebar').select('.button-wrap').append('button').text('View Phenogram');\n    phenogramButton.classed('btn btn-outline-secondary', true).attr('id', 'view-pheno'); \n    phenogramButton.on('click', ()=> {\n          if(phenogramButton.text() === 'View Phenogram'){\n            if(d3.select('.attr-drop.dropdown').select('button').empty()){\n                let drop = dropDown(d3.select('#toolbar'), phenoOptions, `Trait: ${phenoOptions[1].field}`, 'attr-drop');\n                d3.select('.attr-drop.dropdown').select('button').attr('value', phenoOptions[1].field);\n                d3.select('.dropdown.show-drop-div-sidebar').select('button').text(`Color By Value`);\n                drop.on('click', (d, i, n)=> {\n                    if(d3.select('.dropdown.change-view').select('button').node().value === \"View Pairs\"){\n                        updateRanking(pairPaths(normedPaths), d.field);\n                    }\n                    renderTree(true, d.field);\n                    d3.select('.attr-drop.dropdown').select('button').text(`Trait: ${d.field}`);\n                    d3.select('.attr-drop.dropdown').select('button').attr('value')\n                    d3.select('.attr-drop.dropdown').select('button').attr('value', d.field);\n                    d3.select('#attr-drop').classed('show', false);\n                });\n                renderTree(null, true, d3.select('.attr-drop.dropdown').select('button').attr('value'))\n              }else{\n                renderTree(null, true, d3.select('.attr-drop.dropdown').select('button').attr('value'))\n              }\n              phenogramButton.text('View Phylogeny');\n          }else{\n            ////ADD THE HIDE BUTTON HERE \n            let view = d3.select('.dropdown.change-view').select('button').text();\n           \n            if(view != \"Pair View\"){\n                d3.select('.dropdown.attr-drop').remove();\n            }\n            renderTree(null, true, false);\n            phenogramButton.text('View Phenogram');\n\n          }\n    })\n\n    let cladeButton = buttonWrap.append('button').attr('id', 'clade-maker');\n    cladeButton.attr('class', 'btn btn-outline-secondary').text('Clade View');\n    cladeButton.on('click', ()=> growSidebarRenderTree(null));\n}\n\nfunction uncollapseSub(d){\n    d.children = d._children;\n    d._children = null;\n    if(d.children){\n        d.children.map(c=> uncollapseSub(c));\n    }    \n}\n\nfunction collapseSub(d){\n    if(d.children) {\n        d._children = d.children\n        d._children.forEach(collapseSub)\n        d.children = null\n    }  \n}\n\nfunction collapseTree(treeData){\n\n    let leaves = getLeaves(treeData, []);\n\n    return stepDown(treeData);\n\n    function stepDown(node){\n        let leaves = getLeaves(node, []);\n        \n        let ids = new Set(leaves.map(m=> m.data.attributes.Clade.values.Clade));\n        if(ids.size > 1){\n            node.children.map(n=> stepDown(n))\n        }else{\n            node.branchPoint = true;\n            node.clade = Array.from(ids)[0]\n            collapseSub(node);\n            return node;\n        }\n        return node;\n    }\n    \n    function getLeaves(node, array){\n        if(node.children != undefined ){\n            node.children.map(n=> getLeaves(n, array))\n        }else{\n            array.push(node);\n        };\n        return array;\n    }\n}\n\nexport function assignPosition(node, position) {\n    if (node.children === undefined || node.children === null){\n        \n        position = position + 1.5;\n        node.position = position;\n        return position;\n    }else{\n        let positionArray = []\n        node.children.forEach((child) => {\n            position = assignPosition(child, position);\n            positionArray.push(position);\n        });\n        node.options = positionArray;\n        node.position = d3.max(positionArray);\n        return position;\n    }\n}\n\nexport function addingEdgeLength(edge, data){\n    data.combEdge = data.edgeLength + edge;\n    if(data.children){\n        data.children.forEach(chil=> {\n            addingEdgeLength(data.combEdge, chil);\n        });\n    }\n}\n\nexport function renderTree(att, uncollapse, pheno){\n\n    let sidebar = d3.select('#sidebar');\n\n    const dimensions =  {\n        margin : {top: 10, right: 90, bottom: 50, left: 20},\n        width : 260,\n        height : 520,\n        lengthHeight: 800,\n    }\n\n    let lengthBool = true;\n\n    // declares a tree layout and assigns the size\n    var treemap = d3.tree()\n    .size([dimensions.height, dimensions.width]);\n\n    addingEdgeLength(0, nestedData[0]);\n    \n    //  assigns the data to a hierarchy using parent-child relationships\n    var treenodes = d3.hierarchy(nestedData[0]);\n\n    // maps the node data to the tree layout\n    treenodes = treemap(treenodes);\n\n    let groupedBool = d3.select('#show-drop-div-group').attr('value');\n\n    let sidebarTest = sidebar.select('svg');\n    let treeSvg = sidebarTest.empty() ? sidebar.append(\"svg\") : sidebarTest;\n    treeSvg.classed('tree-svg', true);\n    treeSvg.attr(\"width\", dimensions.width + dimensions.margin.left + dimensions.margin.right)\n    .attr(\"height\", dimensions.height + dimensions.margin.top + dimensions.margin.bottom);\n\n    let gTest = treeSvg.select('g.tree-g');\n    let g = gTest.empty() ? treeSvg.append(\"g\").classed('tree-g', true) : gTest;\n    g.attr(\"transform\",\n      \"translate(\" + dimensions.margin.left + \",\" + dimensions.margin.top + \")\");\n\n    if(groupedBool === \"ungrouped\" && uncollapse === false){\n        if((cladesGroupKeeper.length > 0) && (chosenCladesGroup[chosenCladesGroup.length - 1].field != 'Clade Attribute)')){\n            let newNodes = collapseTree(treenodes);\n            updateTree(newNodes, dimensions, treeSvg, g, att, lengthBool, uncollapse);\n        }else{\n            updateTree(treenodes, dimensions, treeSvg, g, att, lengthBool, pheno, uncollapse);\n        }\n        \n    }else{\n        ////Break this out into other nodes////\n        updateTree(treenodes, dimensions, treeSvg, g, att, lengthBool, pheno, uncollapse);\n    }\n    /////END TREE STUFF\n    ///////////\n}\n\nexport function findDepth(node, array){\n    function stepDown(n){\n        if(n.children != null){\n            n.children.forEach(child=> {\n                stepDown(child);\n            })\n        }else{\n            array.push(n);\n        }\n    }\n    stepDown(node);\n    return array;\n}\n\nexport function updateTree(treenodes, dimensions, treeSvg, g, attrDraw, length, pheno, uncollapse){\n\n    d3.select('.pheno-y-axis').remove();\n    d3.select('.pheno-x-axis').remove();\n    \n    assignPosition(treenodes, 0);\n\n    let branchCount = findDepth(treenodes, []);\n    let xScale = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.width]).clamp(true);\n    let yScale = d3.scaleLinear().range([dimensions.height, 0]).domain([0, 1])\n\n    if(length){   \n        g.attr('transform', 'translate(20, 265)');\n        treeSvg.attr('height', 800);\n        yScale.range([500, 0]).domain([0, branchCount.length])\n        xScale.range([0, dimensions.width + 10]);\n    } \n    if(pheno){\n        treeSvg.attr('height', 800);\n        xScale.domain(treenodes.data.attributes[pheno].scales.yScale.domain())\n        yScale.domain([0, maxTimeKeeper[0]]).range([0, 500])\n    }\n\n    // adds the links between the nodes\n    let link = g.selectAll(\".link\")\n    .data( treenodes.descendants().slice(1))\n    .join(\"path\")\n    .attr(\"class\", \"link\");\n\n    link.transition()\n    .duration(500)\n    .attr(\"d\", function(d) {\n        if((length && pheno === undefined) || (length && pheno === false)){\n           return \"M\" + xScale(d.data.combEdge) + \",\" + yScale(d.position)\n           + \"C\" + (xScale(d.data.combEdge) + xScale(d.parent.data.combEdge)) / 2 + \",\" + yScale(d.position)\n           + \" \" + (xScale(d.parent.data.combEdge)) + \",\" + yScale(d.position)\n           + \" \" + xScale(d.parent.data.combEdge) + \",\" + yScale(d.parent.position);\n        }else{\n            return \"M\" + xScale(d.data.attributes[pheno].values.realVal) + \",\" + yScale(d.data.combEdge)\n            + \" \" + xScale(d.parent.data.attributes[pheno].values.realVal) + \",\" + yScale(d.parent.data.combEdge);\n        }       \n    });\n\n    if(pheno){\n        \n        link.style('opacity', 0.3);\n        g.attr('transform', 'translate(30, 50)');\n\n        let x = xScale.domain(treenodes.data.attributes[pheno].scales.yScale.domain()).range([0, (dimensions.width+20)]);\n        let xAxis = d3.axisBottom(x);\n        g.append('g').classed('pheno-x-axis', true).call(xAxis).attr('transform', 'translate(0, 510)').select('path').attr('stroke-width', 0);\n\n        let y = d3.scaleLinear().domain([0,maxTimeKeeper[0]]).range([0, dimensions.height -20]);\n        let yAxis = d3.axisLeft(y);\n        g.append('g').classed('pheno-y-axis', true).call(yAxis).attr('transform', 'translate(0, 2)').select('path').attr('stroke-width', 0);;\n    }\n\n    // adds each node as a group\n    var node = g.selectAll(\".node\")\n    .data(treenodes.descendants(), d => d.data.node)\n    .join(\"g\")\n    .attr(\"class\", function(d) { \n    return \"node\" + \n    (d.children ? \" node--internal\" : \" node--leaf\"); });\n\n    // adds the circle to the node\n    node.selectAll('circle').data(d=> [d]).join(\"circle\")\n      .attr(\"r\", 3);\n\n    node.transition()\n    .duration(500)\n    .attr(\"transform\", function(d) { \n        if(length && pheno === undefined || pheno === false){\n            return \"translate(\" + xScale(d.data.combEdge) + \",\" + yScale(d.position) + \")\"; \n        }else{\n\n           return \"translate(\" + (xScale(d.data.attributes[pheno].values.realVal) - 5) + \",\" + yScale(d.data.combEdge) + \")\"; \n        }\n    });\n\n    if(attrDraw != null){\n        let leaves = node.filter(n=> n.data.leaf === true);\n        let notleaves = node.filter(n=> n.data.leaf != true);\n\n        if(attrDraw.type === 'discrete'){\n            attrDraw.stateColors.forEach(att=> {\n                let circ = leaves.filter(f=> {\n                    return att.state.includes(f.data.attributes[attrDraw.field].states.state)//f.data.attributes[attrDraw.field].winState === att.state;\n                }).select('circle');\n                circ.attr('fill', att.color);\n                notleaves.selectAll('circle').attr('fill', 'gray');\n            });\n        }else{\n            let scale = attrDraw.yScale;\n            scale.range(['#fff', '#E74C3C']);\n            leaves.select('circle').attr('fill', (d, i)=> {\n                return scale(d.data.attributes[attrDraw.field].values.realVal);\n            });\n        }\n    }else{\n        node.selectAll('circle').attr('fill', 'gray');\n    }\n\n    node.on('mouseover', (d, i, n)=> {\n        let paths = d3.select('#main-path-view').selectAll('.paths');\n        let points = d3.select('#main-summary-view').selectAll('.branch-points');\n        points.filter(f=> f.node === d.data.node).classed('selected', true);\n\n        let selectedPaths = paths.filter(path=> {\n            let nodes = path.map(m=> m.node);\n            return nodes.indexOf(d.data.node) > -1;\n        }).classed('hover', true);\n        selectedPaths.selectAll('g').filter(g=> g.node === d.data.node).classed('selected', true);\n        d3.select(n[i]).classed('selected-branch', true);\n\n        if(d.data.label){\n            let tool = d3.select('#tooltip');\n            tool.transition()\n            .duration(200)\n            .style(\"opacity\", .9);\n          \n            tool.html(`${d.data.label.charAt(0).toUpperCase() + d.data.label.slice(1)}`)\n            .style(\"left\", (d3.event.pageX - 40) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            tool.style('height', 'auto');\n        }\n\n    }).on('mouseout', (d, i, n)=> {\n        d3.selectAll('.paths.hover').classed('hover', false);\n        d3.selectAll('g.selected').classed('selected', false);\n        d3.select(n[i]).classed('selected-branch', false);\n\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(500)\n          .style(\"opacity\", 0);\n    });\n    let leaves = node.filter(f=> f.data.children.length == 0);\n\n    node.selectAll('text').remove();\n    node.selectAll('.triangle').remove();\n\n    let branchNodes = node.filter(n=> n.branchPoint === true);\n\n    branchNodes.each((b, i, n)=> {\n        if(b.children === null){\n            let triangle = d3.select(n[i]).append('path').classed('triangle', true).attr('d', d3.symbol().type(d3.symbolTriangle).size('400'))\n            triangle.attr('transform', `rotate(-90) translate(0, 65) scale(.9 4)`);\n            triangle.attr('fill', 'gray').style('opacity', 0.3);\n            let text = d3.select(n[i]).selectAll('text').data(d=> [d]).join('text').text(b.clade);\n            text.attr('transform', 'translate(55, 5)');\n        }\n    })\n    branchNodes.select('circle').attr('fill', 'red').attr('r', 4.5);\n    branchNodes.on('click', (d, i, n)=> {\n        if(d.children == null){\n            uncollapseSub(d);\n        }else{\n            collapseSub(d);\n        }\n        let lengthBool = d3.select('button#length').text() === 'Hide Lengths';\n        updateTree(treenodes, dimensions, treeSvg, g, attrDraw, lengthBool, uncollapse);\n      \n    });\n\n    node.raise();\n    node.selectAll('circle').raise();\n\n\n    if(uncollapse){\n       \n        // let groups = chosenCladesGroup[chosenCladesGroup.length - 1];\n        \n        // let groupGroup = treeSvg.selectAll('.clade-rects')\n        // .data(groups.groups)\n        // .join('g')\n        // .attr('class', d=> d.label)\n        // .classed('clade-rects', true)\n    \n        // let rect = groupGroup.append('rect');\n        // rect.attr('width', 20);\n        // rect.attr('height', (d, i)=> {\n        //     return d.paths.length * 6;\n        // });\n        // groupGroup.each((d, i, node)=> {\n       \n        //     let first = d.paths.map(m=> m[m.length-1].node);\n        //     let test = treeSvg.selectAll('.node--leaf').filter((f)=> {\n        //         return first.indexOf(f.data.node) > -1});\n        //     let leafSort = test.data().sort((a, b)=> {\n        //         return a.x - b.x;\n        //     });\n        //     console.log(leafSort[0].data.node)\n\n        //     let chosenNode = test.filter(f=> {\n        //         return f.data.node === leafSort[leafSort.length - 1].data.node;\n        //     });\n\n        //     console.log(chosenNode.data())\n     \n        //     d3.select(node[i]).attr('transform', `translate(300, ${yScale(leafSort[0].position)})`)\n        // })\n\n     \n      \n        \n    }\n\n    return node;\n}","import { pairPaths, maxTimeKeeper } from \"./dataFormat\";\nimport { dropDown } from \"./buttonComponents\";\nimport * as d3 from \"d3\";\nimport * as slide from 'd3-simple-slider';\nimport { renderTree } from \"./sidebarComponent\";\nimport { speciesTest, dataMaster } from \".\";\nimport { findBrushedNodes } from \"./toolbarComponent\";\n\nexport function rankingControl(data){\n    let rankDiv = d3.select('#pair-rank').classed('hidden', false);\n    rankDiv.selectAll('*').remove();\n\n    let defaultW = [1, 1, 1];\n  \n    let weightPicker = rankDiv\n      .append('svg')\n      .attr('width', 800)\n      .attr('height', 100)\n      .append('g')\n      .attr('transform', 'translate(10,10)');\n\n     weightPicker\n    .append(\"svg:image\")\n    .attr('width', 200)\n    .attr('height', 140)\n    .attr('y', -50)\n    .attr(\"xlink:href\", \"./public/mini-diagram.gif\");\n\n    weightPicker.append('text').text('Distance').attr('font-size', 10).attr('x', 85).attr('y', 60);\n    weightPicker.append('text').text('Delta').attr('font-size', 10).attr('x', 66).attr('y', 20);\n    weightPicker.append('text').text('Closeness').attr('font-size', 10).attr('x', 195).attr('y', 22);\n\n    let labels = ['Distance', 'Delta', 'Closeness'];\n\n    weightPicker.selectAll('text.labels').data(labels).join('text').classed('labels', true)\n    .text(d=> d)\n    .attr('y', 10)\n    .attr('x', (d, i)=> (300+(260 * i)));\n\n  \n    defaultW.forEach((color, i) => {\n      var slider = slide\n        .sliderBottom()\n        .min(-1)\n        .max(1)\n        .step(.1)\n        .width(210)\n        .default(defaultW[i])\n        .displayValue(false)\n        .fill('#7FB3D5')\n        .on('end', num => {\n         defaultW[i] = num;\n       \n         updateRanking(pairPaths(data), d3.select('.attr-drop.dropdown').select('button').attr('value'), defaultW);\n        });\n  \n      weightPicker\n        .append('g')\n        .attr('transform', `translate(${300+(260 * i)}, 20)`)\n        .call(slider);\n\n      weightPicker.selectAll('.tick')\n      .filter(f=> f < 0).select('text')\n      .attr('fill', 'red')\n      .attr('opacity', 0.6);\n    });\n}\nexport function generatePairs(data){\n\n        let pairs = pairPaths(data);\n     \n        let weights = [1, 1, 1];\n\n        let attKeys = d3.entries(pairs[0].p1[0].attributes)\n                    .filter(f=> f.value.type === 'continuous')\n                    .map(m=> {\n                        return {'field': m.key, 'value': m.key }\n                    });\n        \n        let drop = d3.select('.attr-drop.dropdown')\n          .selectAll('a').empty() ? dropDown(d3.select('#toolbar'), attKeys, `Trait: ${attKeys[0].field}`, 'attr-drop') : d3.select('.attr-drop.dropdown').selectAll('a');\n        \n        d3.select('.attr-drop.dropdown').select('button').attr('value', attKeys[0].field);\n\n        drop.on('click', (d, i, n)=> {\n            updateRanking(pairPaths(data), d.field, weights);\n            renderTree(d3.select('#sidebar'), null, true, d.field);\n            d3.select('.attr-drop.dropdown').select('button').attr('value', d.field);\n            d3.select('.attr-drop.dropdown').select('button').text(`Trait: ${d.field}`);\n            d3.select('#attr-drop').classed('show', false);\n        });\n\n        updateRanking([...pairs], attKeys[0].field, weights);\n}\nexport function updateRanking(pairs, field, weights){\n\n  console.log('pairs',pairs, field)\n  \n    let deltaMax = d3.max([...pairs].map(m=> m.deltas.filter(f=> f.key === field)[0]).map(m=> m.value));\n    let closeMax = d3.max([...pairs].map(m=> m.closeness.filter(f=> f.key === field)[0]).map(m=> m.value));\n    let distMax = d3.max([...pairs].map(d=> d.distance))\n    let deltaScale = d3.scaleLinear().domain([0, deltaMax]).range([0, 1]);\n    let closeScale = d3.scaleLinear().domain([closeMax, 0]).range([0, 1]);\n    let distScale = d3.scaleLinear().domain([0, distMax]).range([0, 1]);\n\n    let pickedPairs = [...pairs].map(p=> {\n        p.delta = p.deltas.filter(d=> d.key === field)[0];\n        p.closeness = p.closeness.filter(d=> d.key === field)[0];\n        p.deltaRank = deltaScale(p.delta.value);\n        p.closenessRank = closeScale(p.closeness.value);\n        p.distanceRank = distScale(p.distance);\n        p.totalRank = (weights[0] * p.distanceRank) + (weights[1] * p.deltaRank) + (weights[2] * p.closenessRank);\n        return p;\n    })\n\n    let sortedPairs = pickedPairs.sort((a, b)=> b.totalRank - a.totalRank).slice(0, 40);\n    sortedPairs = sortedPairs.filter((f, i)=> i%2 === 0)\n    drawSorted(sortedPairs, field);\n}\n\nfunction drawSorted(pairs, field){\n\n  let pairColor = ['#FF5733', '#129BF5'];\n\n  let nodes = findBrushedNodes();\n  //console.log('nodes from brush',nodes.map(m=> m.species))\n   \n    let width = 600;\n    let height = 100;\n    let xScale = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, width]);\n\n    d3.select('#main').selectAll('*').remove()\n    let svg = d3.select('#main').append('svg');\n    svg.attr('height', pairs.length * 150)\n    let wrap = svg.append('g');\n    wrap.attr('transform', 'translate(20, 100)')\n    let pairWraps = wrap.selectAll('g.pair-wrap').data(pairs).join('g').classed('pair-wrap', true);\n    pairWraps.attr('transform', (d, i)=> `translate(50,${i*150})`);\n    pairWraps.append('rect')\n        .attr('width', (d, i)=> {\n            return width - xScale(d.common.combLength);\n        })\n        .attr('height', height)\n        .attr('x', d=> xScale(d.common.combLength))\n        .attr('stroke-width', 1).attr('stroke', 'black')\n        .attr('fill', '#fff');\n\n    pairWraps.append('text').text((d, i)=> {\n        return `${d.p1[d.p1.length - 1].node} + ${d.p2[d.p2.length - 1].node}`\n    }).attr('y', -10);\n\n    let scoreWrap = pairWraps.append('g').classed('score-wrap', true);\n    let scoreGroups = scoreWrap.selectAll('g.score').data((d, i)=> {\n        return [\n         {label: 'Distance', value: d.distance, score: d.distanceRank}, \n         {label: 'Delta', value: d.delta.value, score: d.deltaRank},\n         {label: 'Closeness', value: d.closeness.value, score: d.closenessRank}\n        ];\n    }).join('g').classed('score', true);\n\n    let scoreLabel = scoreWrap.append('g').attr('transform', `translate(650, 10)`);\n    scoreLabel.append('rect').attr('width', 200).attr('height', 40).attr('fill', 'gray').attr('y', 45).attr('opacity', .1)\n    scoreLabel.append('text').text('Score').attr('y', 20).style('text-anchor', 'end').style('font-size', 11);\n    scoreLabel.append('text').text('Value').attr('y', 40).style('text-anchor', 'end').style('font-size', 11);\n\n    scoreLabel.append('text').text('Total Score').attr('y', 60).attr('x', 95).style('text-anchor', 'end').style('font-size', 11);\n    scoreLabel.append('text').text('Rank').attr('y', 80).attr('x', 95).style('text-anchor', 'end').style('font-size', 11);\n\n    scoreGroups.attr('transform', (d, i, n)=> {\n       return  i === 0 ? `translate(${(670)},0)` : \n       `translate(${(660+(d3.sum(d3.selectAll(n).filter((f, j)=> i > j).data().map(m=> m.label.length * 6)))+ (i*30))},0)`;\n    });\n    var zero = d3.format(\".3n\");\n    scoreGroups.append('text').text((d, i)=>  d.label).style('font-size', 10).attr('y', 10);;\n    scoreGroups.append('text').text((d, i)=> zero(d.score)).style('font-size', 10).attr('y', 30);\n    scoreGroups.append('text').text((d, i)=> zero(d.value)).style('font-size', 10).attr('y', 50);\n\n    scoreLabel.append('text').text((d, i, n)=> zero(d.closenessRank + d.distanceRank + d.deltaRank)).style('font-size', 10).attr('y', 60).attr('x', 115);\n    scoreLabel.append('text').text((d, i)=> i+1).style('font-size', 10).attr('y', 80).attr('x', 115);\n\n    var lineGen = d3.line()\n    .x(d=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, width]);\n       let distance = x(d.combLength);\n        return distance; })\n    .y(d=> {\n        let y = d.attributes[field].scales.yScale;\n        y.range([height, 0]);\n        return y(d.attributes[field].values.realVal);\n    });\n\n    //BEGIN EXPERIOMENTING////]\n\n    let pairGroupN = pairWraps.selectAll('g.pair-neighbor').data((d, i, n)=> {\n      let species1 = d.p1.map(n=> n.node);\n      let species2 = d.p2.map(n=> n.node);\n      let labels = [...d.p1.filter(n=> n.leaf === true).map(m=> m.node)].concat(d.p2.filter(n=> n.leaf === true).map(m=> m.node));\n\n\n      let neighbors = labels.flatMap(m=> {\n          let start = speciesTest[0].indexOf(m);\n          let ne = speciesTest[0].filter((f, j)=> (j < (+start + 2)) && (j > (+start - 2)));\n          return ne;\n      });\n      \n      let speciesNames = [species1[species1.length-1], species2[species2.length-1]];\n\n      ////EXPERIMENTING WITH NODES////\n      let neighPaths = dataMaster[0].filter(f=> \n        (neighbors.indexOf(f[f.length - 1].node)) > -1 && (speciesNames.indexOf(f[f.length - 1].node) === -1));\n  \n      let labeledN = [...neighPaths].map(path=> {\n        let name = path[path.length - 1].node;\n        return path.map(p=> {\n          p.name = name;\n          return p\n        })\n      });\n  \n      let spec1N = labeledN.map(m => m.filter(f=> species1.indexOf(f.node) > -1));\n      let spec2N = labeledN.map(m => m.filter(f=> species2.indexOf(f.node) > -1));\n  \n      let closest1 = spec1N.filter((f, i, n)=> {\n        let max = d3.max(n.map(d=> d.length));\n        return f.length === max;\n      })[0];\n  \n      let closest2 = spec2N.filter((f, i, n)=> {\n        let max = d3.max(n.map(d=> d.length));\n        return f.length === max;\n      })[0];\n  \n      let wholeClosest1 = labeledN.filter(f=> f[f.length-1].node === closest1[closest1.length - 1].name)[0];\n      let wholeClosest2 = labeledN.filter(f=> f[f.length-1].node === closest2[closest2.length - 1].name)[0];\n     \n      return [wholeClosest1, wholeClosest2];\n\n    }).join('g').classed('pair-neighbor', true).attr('opacity', 0);\n\n      let innerPathsN = pairGroupN.append('path')\n      .attr(\"d\", lineGen)\n      .attr(\"class\", \"inner-line-n\")\n      .attr('fill', 'none')\n      .attr('stroke-width', 1)\n      .style('stroke', 'rgba(160, 141, 184, .9)');\n     \n      let branchesN = pairGroupN.selectAll('g.branch-n').data(d=> d).join('g').classed('branch-n', true);\n      branchesN.attr('transform', (d, i)=> `translate(${xScale(d.combLength)}, 0)`);\n      branchesN.filter(f=> f.leaf != true).append('rect').attr('width', 10).attr('height', (d)=> {\n          let y = d.attributes[field].scales.yScale;\n          return y(d.attributes[field].values.lowerCI95) - y(d.attributes[field].values.upperCI95)\n      }).attr('fill', 'rgba(160, 141, 184, .2)').attr('y', (d, i)=> {\n          let y = d.attributes[field].scales.yScale;\n          return y(d.attributes[field].values.upperCI95);\n      });\n  \n      branchesN.append('rect').attr('width', 10).attr('height', 4).attr('y', (d, i)=> {\n          return d.attributes[field].scales.yScale(d.attributes[field].values.realVal) - 2;\n      }).attr('opacity', 0.5);\n\n      branchesN.filter((b, i, n)=> {\n        return i === (n.length - 1);\n      }).append('text').text(d=> d.node)\n        .attr('fill', 'rgba(160, 141, 184, 1)')\n        .attr('y', (d, i)=> {\n        let y = d.attributes[field].scales.yScale;\n        return (y(d.attributes[field].values.realVal) - 4);\n        }).attr('x', 3).style('font-size', 10);\n\n\n\n\n////////////////////////////END EXPERIMENT///////\n\n    let pairGroup = pairWraps.selectAll('g.pair').data(d=> [d.p1, d.p2]).join('g').classed('pair', true);\n\n    let innerPaths = pairGroup.append('path')\n    .attr(\"d\", lineGen)\n    .attr(\"class\", \"inner-line\")\n    .style('stroke', (d, i)=> pairColor[i])\n   // .style('stroke', 'rgb(165, 185, 198)');\n\n   let brushedPaths = innerPaths.filter(f=> {\n    let nodeTest = f.filter(n=> nodes.map(m=> m.node).indexOf(n.node) > -1)\n    return nodeTest.length > 0}).style('stroke', '#64B5F6').style('stroke-width', '5px');\n\n   //console.log('brushed',brushedPaths, nodes.map(m=> m.node))\n    let branches = pairGroup.selectAll('g.branch').data(d=> d).join('g').classed('branch', true);\n    branches.attr('transform', (d, i)=> `translate(${xScale(d.combLength)}, 0)`);\n    branches.filter(f=> f.leaf != true).append('rect')\n    .classed('range', true)\n    .attr('width', 10)\n    .attr('height', (d)=> {\n        let y = d.attributes[field].scales.yScale;\n        return y(d.attributes[field].values.lowerCI95) - y(d.attributes[field].values.upperCI95)\n    }).attr('fill', 'rgba(165, 185, 198, .5)')\n    .attr('y', (d, i)=> {\n        let y = d.attributes[field].scales.yScale;\n        return y(d.attributes[field].values.upperCI95);\n    });\n\n    let chosenNodes = branches.filter(f=> {\n      return nodes.map(m=> m.node).indexOf(f.node) > -1\n    }).selectAll('rect.range').attr('fill', '#64B5F6')\n\n    branches.append('rect').attr('width', 10).attr('height', 4).attr('y', (d, i)=> {\n        return d.attributes[field].scales.yScale(d.attributes[field].values.realVal) - 2;\n    });\n\n    pairWraps.append('rect').attr('width', (d, i)=> {\n        return xScale(d.common.combLength)})\n        .attr('height', height)\n        .attr('fill', '#fff').style('opacity', 0.7);\n        let yAxisG = pairWraps.append('g').classed('y-axis', true);\n        let xAxisG = pairWraps.append('g').classed('x-axis', true);\n        xAxisG.call(d3.axisBottom(xScale).ticks(10));\n        xAxisG.attr('transform', `translate(0, ${height})`)\n\n    pairWraps.on('mouseover', (d, i, n)=> {\n       \n        let species1 = d.p1.map(n=> n.node);\n        let species2 = d.p2.map(n=> n.node);\n        let labels = [...d.p1.filter(n=> n.leaf === true).map(m=> m.node)].concat(d.p2.filter(n=> n.leaf === true).map(m=> m.node));\n        let neighbors = labels.flatMap(m=> {\n            let start = speciesTest[0].indexOf(m);\n            let ne = speciesTest[0].filter((f, j)=> (j < (+start + 2)) && (j > (+start - 2)));\n            return ne;\n        });\n        \n        let neighNodes = []//dataMaster[0].filter(f=> neighbors.indexOf(f[f.length -1].node) > -1).flatMap(m=> m.map(f=> f.node))\n       \n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n        let treeLinks  = d3.select('#sidebar').selectAll('.link');\n        let pairNode1 = treeNode.filter(f=> {\n            return species1.indexOf(f.data.node) > -1;\n        }).classed('hover one', true);\n\n        let pairNode2 = treeNode.filter(f=> {\n          return species2.indexOf(f.data.node) > -1;\n      }).classed('hover two', true);\n\n        treeLinks.filter(f=> species1.indexOf(f.data.node) > -1).classed('hover one', true);\n        treeLinks.filter(f=> species2.indexOf(f.data.node) > -1).classed('hover two', true);\n       // treeNode.filter(f=> neighNodes.indexOf(f.data.node) > -1).classed('hover-neighbor', true);\n        //Hiding Others\n        treeNode.filter(f=> (neighNodes.indexOf(f.data.node) === -1) && (species1.concat(species2).indexOf(f.data.node) === -1)).classed('hover-not', true);\n        //Coloring Neighbors\n       // treeLinks.filter(f=> neighNodes.indexOf(f.data.node) > -1).classed('hover-neighbor', true);\n        //Hiding Others\n        treeLinks.filter(f=> (neighNodes.indexOf(f.data.node) === -1) && (species1.concat(species2).indexOf(f.data.node) === -1)).classed('hover-not', true);\n        \n        let speciesNames = [species1[species1.length-1], species2[species2.length-1]]\n       // d3.select(n[i]).selectAll('.pair-neighbor').attr('opacity', 1);\n        return d3.select(this).classed('hover', true);\n    })\n    .on('mouseleave', (d, i, n)=>{\n\n      d3.select(n[i]).selectAll('.pair-neighbor').attr('opacity', 0);\n\n        let treeNode  = d3.select('#sidebar').selectAll('.node')\n        .classed('hover', false)\n        .classed('hover-neighbor', false)\n        .classed('hover-not', false)\n        .classed('two', false)\n        .classed('one', false);\n        let treeLinks  = d3.select('#sidebar').selectAll('.link')\n        .classed('hover', false)\n        .classed('hover-neighbor', false)\n        .classed('hover-not', false)\n        .classed('two', false)\n        .classed('one', false);\n        return d3.select(n[i]).classed('hover', false);\n    });\n\n    let axisGroup = pairWraps.append('g').classed('y-axis', true);\n  \n    axisGroup.each((d, i, n)=> {\n        let scale = d.p1[0].attributes[field].scales.yScale;\n        d3.select(n[i]).call(d3.axisLeft(scale).ticks(5));\n    });\n\n    let mouseG = pairWraps.append(\"g\")\n    .attr(\"class\", \"mouse-over-effects\");\n\n  mouseG.append(\"path\") // this is the black vertical line to follow mouse\n    .attr(\"class\", \"mouse-line\")\n    .style(\"stroke\", \"black\")\n    .style(\"stroke-width\", \"1px\")\n    .style(\"opacity\", \"0\");\n\n   var mousePerLine = mouseG.selectAll('.mouse-per-line')\n   .data((d, i)=> {\n\n    return [d.p1, d.p2]})\n   .join(\"g\")\n   .attr(\"class\", \"mouse-per-line\");\n\n mousePerLine.append(\"circle\")\n   .attr(\"r\", 7)\n   .style(\"stroke\", function(d) {\n     return 'red';\n   })\n   .style(\"fill\", \"none\")\n   .style(\"stroke-width\", \"1px\")\n   .style(\"opacity\", \"0\");\n\n  mousePerLine.append(\"text\").attr('class', 'value')\n   .attr(\"transform\", \"translate(10,3)\");\n\n  mousePerLine.append(\"text\").attr('class', 'species')\n   .attr(\"transform\", \"translate(10,3)\");\n\nmouseG.append('svg:rect') // append a rect to catch mouse movements on canvas\n      .attr('width', width) // can't catch mouse events on a g element\n      .attr('height', height)\n      .attr('fill', 'none')\n      .attr('pointer-events', 'all')\n      .on('mouseout', function() { // on mouse out hide line, circles and text\n        d3.selectAll(\".mouse-line\")\n          .style(\"opacity\", \"0\");\n        d3.selectAll(\".mouse-per-line circle\")\n          .style(\"opacity\", \"0\");\n        d3.selectAll(\".mouse-per-line text\")\n          .style(\"opacity\", \"0\");\n      })\n      .on('mouseover', (d, i, n)=> { // on mouse in show line, circles and text\n        d3.select(n[i].parentNode).selectAll('.mouse-line')\n          .style(\"opacity\", \"1\");\n          d3.select(n[i].parentNode).selectAll(\".mouse-per-line circle\")\n          .style(\"opacity\", \"1\");\n          d3.select(n[i].parentNode).selectAll(\".mouse-per-line text\")\n          .style(\"opacity\", \"1\");\n\n          \n      })\n      .on('mousemove', (dat, i, n)=> { // mouse moving over canvas\n        var mouse = d3.mouse(n[i]);\n       \n        d3.select(n[i].parentNode).select('.mouse-line')\n          .attr(\"d\", function() {\n            var d = \"M\" + mouse[0] + \",\" + height;\n            d += \" \" + mouse[0] + \",\" + 0;\n            return d;\n          });\n       \n          d3.select(n[i].parentNode).selectAll('.mouse-per-line')\n          .attr(\"transform\", function(d, j, node) {\n         \n            var xDate = xScale.invert(mouse[0]),\n                bisect = d3.bisector(function(d) { return d.edgeLength; }).right,\n                idx = bisect(d.values, xDate);\n            \n            let line = n[i].parentNode.parentNode.getElementsByClassName('inner-line');\n          \n            var beginning = 0,\n                end = line[j].getTotalLength(),\n                target = null\n\n            while (true){\n               target = Math.floor((beginning + end) / 2);\n               var pos = line[j].getPointAtLength(target);\n              if ((target === end || target === beginning) && pos.x !== mouse[0]) {\n                  break;\n              }\n              if (pos.x > mouse[0])      end = target;\n              else if (pos.x < mouse[0]) beginning = target;\n              else break; //position found\n            }\n            let y = dat.p1[0].attributes[field].scales.yScale;\n          \n            d3.select(node[j]).select('text.value')\n              .text(y.invert(pos.y).toFixed(2))\n              .style('font-size', 11)\n              .attr('y', ()=> {\n                  return j === 0 ? 10 : -10;\n                });\n\n            d3.select(node[j]).select('text.species')\n                .text(d[d.length-1].node)\n                .style('font-size', 11)\n                .attr('y', ()=> {\n                    return j === 0 ? 19 : -19;\n                  });\n              \n            return \"translate(\" + mouse[0] + \",\" + pos.y +\")\";\n          });\n      });\n\n\n   \n}","import * as d3 from \"d3\";\nimport { renderDistibutions, groupDistributions, renderDistStructure, binGroups } from './distributionView';\nimport {drawPathsAndAttributes} from './renderPathView';\nimport { getLatestData } from \"./filterComponent\";\nimport { generatePairs, rankingControl } from \"./pairView\";\nimport { drawTreeForGroups, createCladeView, chosenCladesGroup } from \"./cladeMaker\";\nimport { calculatedScalesKeeper } from \".\";\n\nexport let groupedView = false;\n\nexport function updateMainView(d, groups){\n\n    let main = d3.select('#main');\n    let data = getLatestData();\n    let moveMetric = 'edgeLength';\n\n    let scales = calculatedScalesKeeper[0];\n\n    main.selectAll('*').remove();\n\n    let view = d3.select('#view-pheno').text()\n   \n    if(d != 'Pair View' && view === 'View Phenogram'){\n        d3.select('.dropdown.attr-drop').remove();\n    }\n  \n    if(d === 'Path View' || d === null){\n        d3.select('#pair-rank').classed('hidden', true);\n        drawPathsAndAttributes(data, main);\n\n        document.getElementById(\"scrunch\").disabled = false;\n        document.getElementById(\"discrete-view\").disabled = false;\n\n        d3.select('#scrunch').classed('hidden', false);\n        d3.select('#discrete-view').classed('hidden', false);\n\n    }else if(d === 'Summary View'){\n\n        d3.select('#pair-rank').classed('hidden', true);\n\n        document.getElementById(\"scrunch\").disabled = true;\n        document.getElementById(\"discrete-view\").disabled = true;\n\n        d3.select('#scrunch').classed('hidden', true);\n        d3.select('#discrete-view').classed('hidden', true);\n\n        if(groups){\n            renderDistStructure(main, groups)\n        }else{\n           // groupDistributions(data, main, null);\n           renderDistStructure(main, data);\n        }\n    }else if(d === 'Pair View'){\n        rankingControl(data);\n        generatePairs(data);\n\n        document.getElementById(\"scrunch\").disabled = true;\n        document.getElementById(\"discrete-view\").disabled = true;\n\n        d3.select('#scrunch').classed('hidden', true);\n        d3.select('#discrete-view').classed('hidden', true);\n\n    // }else if(d === 'Clade View'){\n    //     d3.select('#pair-rank').classed('hidden', true);\n    //     createCladeView(main, scales);\n\n    //     document.getElementById(\"scrunch\").disabled = true;\n    //     document.getElementById(\"discrete-view\").disabled = true;\n\n    //     d3.select('#scrunch').classed('hidden', true);\n    //     d3.select('#discrete-view').classed('hidden', true);\n\n    }else{\n        console.error('field not found');\n    }\n}\nexport function initialViewLoad(scales, dataName){\n\n    let main = d3.select('#main');\n    let data = getLatestData();\n\n    main.selectAll('*').remove();\n\n    if(data.length > 50){\n\n        renderDistStructure(main, chosenCladesGroup[chosenCladesGroup.length - 1].groups);\n        \n        d3.select('#view-toggle').text('View Paths');\n\n        document.getElementById(\"scrunch\").disabled = true;\n        document.getElementById(\"discrete-view\").disabled = true;\n\n        d3.select('#scrunch').classed('hidden', true);\n        d3.select('#discrete-view').classed('hidden', true);\n\n    }else{\n        \n        drawPathsAndAttributes(data, main);\n        d3.select('#view-toggle').text('View Summary');\n\n        document.getElementById(\"scrunch\").disabled = false;\n        document.getElementById(\"discrete-view\").disabled = false;\n\n        d3.select('#scrunch').classed('hidden', false);\n        d3.select('#discrete-view').classed('hidden', false);\n      \n    }\n\n}\n\n","import '../styles/index.scss';\nimport {formatAttributeData, maxTimeKeeper} from './dataFormat';\nimport * as d3 from \"d3\";\nimport {filterMaster, getLatestData, getScales} from './filterComponent';\nimport { pullPath } from './pathCalc';\nimport { renderTree } from './sidebarComponent';\nimport { chosenCladesGroup } from './cladeMaker';\nimport { updateMainView } from './viewControl';\n\nconst dimensions = {\n    height: 80,\n    observedWidth : 200,\n    predictedWidth : 900,\n    margin : 20,\n    squareDim : 15,\n    timeRange: 895\n}\n\nconst brushColors = [\n    ['#64B5F6', '#F39C12'],\n    ['#6A1B9A', '#FDD835'],\n]\n\nconst compareColors = [{light: '#F8C471', dark: '#F39C12'}, {light: '#A3E4D7', dark: '#17A589'}]\n\nconst defaultBarColor = '#baaaaa'//#DCD4D4';\n\nlet colorBool = 0;\nconst selectedClades = [[]];\n\nexport function groupDistributions(pathData, mainDiv, groupAttr){\n\n    let scales = getScales();\n\n    let groupKeys = scales.filter(f=> f.field === groupAttr)[0].scales.map(s=> s.scaleName)\n  \n    let branchBinCount = d3.median(pathData.map(m=> m.length)) - d3.min(pathData.map(m=> m.length))\n   \n    let pathGroups = groupKeys.map(group => {\n        let paths = pathData.filter(path => {\n            return group.includes(path[path.length - 1].attributes[groupAttr].values[groupAttr]);\n        });\n\n        let groupBins = binGroups(paths, group, scales, branchBinCount);\n        return {'label': group, 'paths': paths, 'groupBins': groupBins}\n    });\n\n    renderDistStructure(mainDiv, pathGroups);\n}\nexport function binGroups(pathData, groupLabel, scales, branchCount){\n\n    let attrHide = filterMaster.filter(f=> f.type === 'hide-attribute').map(m=> m.attribute);\n    \n    let keys = scales.map(s=> s.field).filter(f=> attrHide.indexOf(f) === -1);\n\n    let newNormed = [...pathData];\n    let keysToHide = attrHide.length > 0 ? scales.filter(f=> attrHide.indexOf(f.field) === -1).map(m=> m.field) : null;\n\n    formatAttributeData(newNormed, scales, keysToHide);\n\n    let maxBranch = d3.max(newNormed.map(p=> p.length)) - 1;\n  \n    let max = maxTimeKeeper[0]\n\n    let normBins = new Array(branchCount).fill().map((m, i)=> {\n            let step = max / branchCount;\n            let base = (i * step);\n            let top = ((i + 1)* step);\n            return {'base': base, 'top': top, 'binI': i , 'step':step}\n    });\n\n    let internalNodes = newNormed.map(path => path.filter(node=> (node.leaf != true) && (node.root != true)));\n    let leafNodes = newNormed.flatMap(path => path.filter(node=> node.leaf === true));\n    let rootNodes = newNormed.flatMap(path => path.filter(node=> node.root === true));\n\n    normBins.map((n, i)=> {\n        let edges = internalNodes.flatMap(path => path.filter(node=> {\n                return node.combLength > n.base && node.combLength <= n.top;\n        } ));\n        n.data = edges;\n        return n;\n    });\n\n    let sortedBins = keys.map(key=> {\n        let scale = scales.filter(f=> f.field === key)[0];\n    \n        let mapNorm = normBins.map(bin => {\n            if(bin.data.length > 0){\n                bin.fData = bin.data.map(d=> {\n                    return d.attributes[key];\n                })\n            }else{\n                bin.fData = [];\n            }\n            return {'data': bin.fData, 'range': [bin.base, bin.top], 'index': bin.binI, 'key': key };\n        });\n       \n        let leafAttr = leafNodes.map(m=> m.attributes[key]);\n        let leafData = {'data': leafAttr};\n   \n        if(scale.type === 'continuous'){\n            let x = d3.scaleLinear().domain([scale.min, scale.max]).range([0, dimensions.height]);\n    \n            let histogram = d3.histogram()\n            .value(function(d) { return d.values.realVal; })  \n            .domain(x.domain())  \n            .thresholds(x.ticks(20)); \n  \n            mapNorm.map((n, i, nodeArray)=> {\n                n.type = scale.type;\n                n.bins = histogram(n.data);\n                n.domain = [scale.max, scale.min];\n                n.bins.count = branchCount;\n                n.bins.groupLabel = groupLabel;\n\n                if(d3.mean(n.bins.map(m=> m.length)) === 0){\n                    if(i === 0){\n                         n.bins = histogram(rootNodes.map(m=> m.attributes[key]));\n                         n.data = rootNodes.map(m=> m.attributes[key]);\n                         n.bins.count = branchCount;\n\n                    }else{\n                        n.bins = nodeArray[i-1].bins;\n                        n.data = nodeArray[i-1].data;\n                    }\n                }\n                return n;\n            });\n\n            //Histogram for observed////\n            let maxO = d3.max(leafAttr.flatMap(v=> +v.values.realVal));\n            let minO = d3.min(leafAttr.flatMap(v=> +v.values.realVal));\n            let xO = d3.scaleLinear().domain([minO, maxO]).range([0, dimensions.height])\n\n            let histogramO = d3.histogram()\n            .value(function(d) { \n                return +d.values.realVal; })  \n            .domain(xO.domain())  \n            .thresholds(xO.ticks(20)); \n\n            leafData.bins = histogramO(leafAttr);\n      \n            let newK = {'key': key, \n                    'branches': [...mapNorm], \n                    'type': scale.type, \n                    'leafData': leafData, \n                    'rootData': rootNodes.map(m=> m.attributes[key])[0]}\n   \n            return newK;\n\n        }else{\n            //HANDLING DISCRETE//\n            let states = leafAttr[0].scales.scales;\n           \n            let stateKeys = states[0].state? states.map(s=> s.state) : states.map(s=> s.scaleName)\n          \n            let rootNode = rootNodes[0].attributes[key]\n            rootNode.bins = d3.entries(rootNodes[0].attributes[key].values).map(m=> {       \n                let states = [{'state': m.key, 'value':m.value}];\n                return {state: states, branchCount:branchCount, color : scale.stateColors.filter(f=> f.state === m.key)[0], max:80};\n               });\n            \n            mapNorm.bins = null\n            leafData.bins = states.map(s=> {\n                return leafAttr.filter(f=> s.scaleName.includes(f.states.state))});\n   \n            let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.height]);\n            let y = d3.scaleLinear().domain([0, 1]).range([0, 40]);\n\n            let histogram = d3.histogram()\n            .value(function(d) { return d.value; })  \n            .domain(y.domain())  \n            .thresholds(y.ticks(10)); \n  \n            mapNorm.map((n, i, nodeArray)=> {\n                \n                let colors = scale.stateColors;\n                n.bins = stateKeys.map(state=> {\n                    let test = n.data.flatMap(m=> Object.entries(m.values).filter(f=> f[0] === state))\n                    .map(m=> {\n                        return {'state': m[0], 'value':m[1]}\n                    });\n                    \n                    return {state: test, branchCount:branchCount, histogram: histogram(test), color : colors.filter(f=> f.state === state)[0], max:80};\n                });\n                //IF WE DONT HAVE ANY BRANCHES< WE ASSUME THAT THEY ARE THE SAME AS THE PREVIOUS\n                if(n.bins[0].state.length === 0){\n                    if(i === 0){\n                        n.bins = d3.entries(rootNode.values).map(m=> {\n                            let histo = histogram([+m.value]).map(h=>{\n                                if(m.value <= h.x1 && m.value >= h.x0){\n                                    h.push(+m.value);\n                                }\n                                return h;\n                             });\n                             let states = [{'state': m.key, 'value':m.value}];\n                             return {state: states, branchCount:branchCount, histogram: histo, color:colors.filter(f=> f.state === m.key)[0], max:80};\n                            });\n                        \n                    }else{\n                        n.bins = nodeArray[i-1].bins;\n                    }\n                }\n\n                n.type = scale.type;\n                return n;\n            });\n\n            let newK = {'key': key, \n                        'branches': [...mapNorm], \n                        'type': scale.type, \n                        'leafData': leafData, \n                        'rootData': rootNodes.map(m=> m.attributes[key])[0],\n                        'stateKeys': stateKeys,\n                        'maxCount': d3.max(mapNorm.map(n=> n.data.length))\n                    }\n            return newK;\n        }\n    });\n\n    sortedBins.group = groupLabel;\n    sortedBins.branchCount = branchCount;\n    sortedBins.keys = keys;\n    return sortedBins;\n}\nexport function drawBranchPointDistribution(data, svg){\n\n    let branchBar = svg.append('g').classed('branch-bar', true);\n    branchBar.append('rect').classed('point-dis-rect', true)\n        .attr('height', 25)\n        .attr('x', -10)\n        .attr('y', -10)\n       .attr('fill', 'none')\n\n    let binWrap = branchBar.append('g').attr('transform', 'translate(102, -10)');\n\n    branchBar.append('line')\n        .attr('y1', 2)\n        .attr('y2', 2)\n        .attr('x1', '100')\n        .attr('x2', dimensions.predictedWidth)\n        .attr('stroke', 'gray')\n        .attr('stroke-width', .25);\n\n    branchBar.append('text').text('Root').attr('transform', 'translate(70, 7)');\n    let leafLabel = branchBar.append('g').classed('leaf-label', true).attr('transform', `translate(${dimensions.predictedWidth + 200}, 7)`);\n    leafLabel.append('text').text('Leaves');\n\n    let nodeLengthArray = [];\n    let nodeDuplicateCheck = []\n\n    data.paths.map(path=> {\n        path.filter(n=> n.leaf != true).map(node=> {\n            if(nodeDuplicateCheck.indexOf(node.node) == -1){\n                nodeDuplicateCheck.push(node.node);\n                nodeLengthArray.push({'node': node.node, 'eMove': node.combLength });\n            }\n        })\n    });\n\n    let bPointScale = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.timeRange]);\n    let pointGroups = branchBar.selectAll('g.branch-points').data(nodeLengthArray)\n        .join('g').attr('class', (d, i)=> d.node).classed('branch-points', true);\n\n    pointGroups.attr('transform', (d, i) => {\n        return `translate(${(105 + bPointScale(d.eMove))}, 0)`});\n    pointGroups.append('circle').attr('r', 5).attr('fill', '#fff').attr('opacity', 0.5);\n\n    let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.timeRange]);\n    \n    let binsRects = binWrap\n        .selectAll('rect.bin')\n        .data(data.groupBins[0].branches.map(m=> m.range))\n        .join('rect')\n        .classed('bin', true);\n\n    binsRects.attr('width', (d, i, n)=> {\n        return x(d[1]) - x(d[0]);\n    }).attr('height', 20);\n\n    binsRects.attr('transform', (d, i, n)=> {\n        let step = x(d[1]) - x(d[0]);\n        return `translate(${step*i},0)`});\n\n    binsRects.attr('fill', 'gray').attr('stroke-width', 2).attr('stroke', 'white');\n\n    let axis = d3.axisBottom(x);\n    let axGroup = branchBar.append('g').call(axis)\n    axGroup.attr('transform', 'translate(103, 10)');\n    axGroup.select('path').attr('stroke-width', 0);\n\n    return branchBar;\n}\nexport function drawGroupLabels(pathData, svg, groupLabel){\n\n    let leafNames = pathData[0].leafData.data.map(m=> m.node);\n    let nodeNames = getLatestData().filter(f=> leafNames.indexOf(f[f.length - 1].node) > -1).flatMap(fl=> fl.map(m=> m.node))\n\n    let shownAttributes = d3.select('#attribute-show').selectAll('input').filter((f, i, n)=> n[i].checked === true).data();\n\n    let cladeLabel = svg.append('g').classed('clade-label', true).attr('transform', 'translate(10, 0)');\n    cladeLabel.append('rect')\n        .attr('width', 50)\n        .attr('height', (pathData.keys.length * (dimensions.height+ 15)))\n        .attr('fill', 'gray')\n        .style('opacity', 0.2)\n        .on('mouseover', (d, i)=>{\n            let treeNode  = d3.select('#sidebar').selectAll('.node');\n            let treeLinks  = d3.select('#sidebar').selectAll('.link');\n            treeNode.filter(f=> {\n                return nodeNames.indexOf(f.data.node) > -1;\n            }).classed('hover clade', true);\n        \n        treeLinks.filter(f=> {\n            return nodeNames.indexOf(f.data.node) > -1;\n        }).classed('hover clade', true);\n\n        let species = d.paths.map(m=> m[m.length - 1].label);\n        }).on('mouseout', (d, i)=> {\n            let treeNode  = d3.select('#sidebar').selectAll('.node');\n            let treeLinks  = d3.select('#sidebar').selectAll('.link');\n            treeNode.classed('hover clade', false);\n            treeLinks.classed('hover clade', false);\n        });\n\n    cladeLabel.append('text').text(d=> d.label)\n    .style('text-anchor', 'middle')\n    .attr('transform', `translate(23, ${(shownAttributes.length * (dimensions.height+ 15)/2)}), rotate(-90)`);\n\n    return cladeLabel;\n}\n/**\n * \n * @param {*} mainDiv \n * @param {*} pathGroups \n */\nexport function renderDistStructure(mainDiv, pathGroups){\n\n    let compareTooltipFlag = false;\n   \n    let shownAttributes = d3.select('#attribute-show').selectAll('input').filter((f, i, n)=> n[i].checked === true).data();\n   \n    let groupWrap = mainDiv.append('div').attr('id', 'summary-view');\n    let groupDivs = groupWrap.selectAll('.group-div').data(pathGroups).join('div').classed('group-div', true);\n\n    groupDivs.each((d, i, node)=> {\n       let filteredAttributes = d.groupBins.filter(f=> {\n           return shownAttributes.indexOf(f.key) > -1;\n       });\n\n        let group = d3.select(node[i]);\n        group.style('text-align', 'center');\n        group.append('text').text(d.label);\n        group.append('text').text(` : ${d.paths.length} Paths` );\n\n        //////Starting something new/////\n        let svg = group.append('svg');\n        svg.attr('class', 'main-summary-view');\n        svg.attr('id', `${d.label}-svg`);\n        svg.attr('height', (shownAttributes.length * (dimensions.height + 5))+ 50);\n    \n        let branchBar = drawBranchPointDistribution(d, svg);\n        branchBar.attr('transform', 'translate(55, 10)');\n\n        group.classed(d.label, true);\n    \n        let branchScale = d3.scaleLinear().domain([0, d.groupBins.branchCount]).range([0, dimensions.timeRange]);\n        let pointGroups = branchBar.selectAll('g.branch-points');\n      \n        let wrap = svg.append('g').classed('summary-wrapper', true);\n        wrap.attr('transform', 'translate(70, 50)');\n    \n        let binnedWrap = wrap.selectAll('.attr-wrap').data(filteredAttributes).join('g').attr('class', d=> d.key + ' attr-wrap');\n    \n        binnedWrap.attr('transform', (d, i, n)=>  {\n                if(i === 0){\n                    return 'translate(0,0)';\n                }else{\n                    let selected = d3.selectAll(n).filter((f, j)=>j < i).data();\n                    let sum = d3.sum(selected.flatMap(s=> s.type === 'continuous'? dimensions.height+5 : (s.stateKeys.length*(dimensions.squareDim+4))));\n                    d.sum = sum;\n                    return `translate(0, ${sum})`;\n                }\n        });\n\n        let label = binnedWrap.append('text')\n        .text(d=> d.key);\n\n        label.filter(f=> f.type === 'continuous')\n        .attr('y', 40)\n        .attr('x', 80)\n        .style('text-anchor', 'end')\n        .style('font-size', 11);\n\n        label.filter(f=> f.type === 'discrete')\n        .attr('y', (d, i)=> 3)\n        .attr('x', d=> -((d.stateKeys.length)*(dimensions.squareDim)/2))\n        .style('text-anchor', 'middle')\n        .style('font-size', 11)\n        .attr('transform', 'rotate(-90)');\n    \n        let groupLabelBars = drawGroupLabels(d.groupBins, svg, d.label);\n\n        groupLabelBars.on('click', (d, i, n)=> {\n            if(compareTooltipFlag){\n                compareTooltipFlag = false;\n                d3.select(\"#compare-tooltip\").classed(\"hidden\", true);\n            }else{\n                compareTooltipFlag = true;\n                d3.select(\"#compare-tooltip\")\n                    .style(\"left\", (d3.event.pageX) + \"px\")\n                    .style(\"top\", (d3.event.pageY - 28) + \"px\")\n                    .select(\"#value\")\n                    .text(d.node);\n\n                d3.select(\"#compare-tooltip\").classed(\"hidden\", false);\n                d3.select('#select-for-compare').on('click', ()=> {\n\n                    compareTooltipFlag = false;\n                    d3.select(\"#compare-tooltip\").classed(\"hidden\", true);\n                    d3.select(n[i]).select('rect').attr('fill', '#F5B041');\n\n                    selectedClades[selectedClades.length - 1].push(Object.assign({},d));\n                    if(selectedClades[selectedClades.length - 1].length > 1){\n                        mainDiv.selectAll('*').remove();\n                        mainDiv.select('#compare-wrap').remove();\n                      \n                        renderDistributionComparison(mainDiv, selectedClades[selectedClades.length - 1], branchScale);\n                    }\n                });\n            }\n        });\n           \n       // });\n        renderDistibutions(binnedWrap, branchScale, pointGroups);\n    });\n}\n\nfunction renderDistributionComparison(div, data, branchScale){\n\n\n    let shownAttributes = d3.select('#attribute-show').selectAll('input').filter((f, i, n)=> n[i].checked === true).data();\n  \n    let divWrap = div.append('div').attr('id', 'compare-wrap');\n\n    let groupHeader = divWrap.append('div').classed('compare-header', true).style('margin', 'auto');\n\n    let textDiv = groupHeader.append('div').attr('height', 50).attr('width', 200).style('margin-left', '460px');\n    let branchPointSvg  = groupHeader.append('svg');\n\n    let pointData = {paths: data[0].paths.concat(data[1].paths), groupBins: data[0].groupBins}\n    let branchBar = drawBranchPointDistribution(pointData, branchPointSvg);\n    branchBar.attr('transform', 'translate(-30, 10)')\n\n    //'#DCD4D4'\n\n    branchBar.selectAll('rect.bin').attr('stroke', '#fff').attr('stroke-width', '3px');\n    let pointGroups = branchBar.selectAll('g.branch-points');\n  \n    let xOut = groupHeader.append('div')\n    .style('position', 'absolute')\n    .style('left', '5px')\n    .style('top', '65px')\n    .append('i')\n    .classed('close fas fa-times', true)\n    .style('padding-left', '10px');\n    \n    xOut.on('click', (d, i, n)=> {\n        divWrap.remove();\n        selectedClades.push(new Array());\n        updateMainView('Summary View', chosenCladesGroup[chosenCladesGroup.length-1].groups);\n        d3.select('#sidebar').selectAll('.node').remove();\n        d3.select('#sidebar').selectAll('.link').remove();\n        renderTree(d3.select('#sidebar'), null, true);\n    });\n\n    if(data.length > 1){\n//ADD THIS BACK IN//\n       // renderTree(d3.select('#sidebar'), null, true);\n\n        d3.select('#toolbar').selectAll('.brush-span').remove();\n       \n        let selectedNodes = Array.from(new Set(data.flatMap(f=> f.paths).flatMap(p=> p.map(m=> m.node))));\n   \n        let testNodes = d3.select('#sidebar').selectAll('.node').filter(f=> selectedNodes.indexOf(f.data.node) === -1);\n        let testLinks = d3.select('#sidebar').selectAll('.link').filter(f=> selectedNodes.indexOf(f.data.node) === -1);\n\n        testNodes.attr('opacity', 0.3)\n        testLinks.attr('opacity', 0.3)\n\n        let pathsListOne = Array.from(new Set(data[0].paths.flatMap(p=> p.map(m=> m.node))));\n        let pathsListTwo = Array.from(new Set(data[1].paths.flatMap(p=> p.map(m=> m.node))));\n\n        let testNodesOne = d3.select('#sidebar').selectAll('.node').filter(f=> pathsListOne.indexOf(f.data.node) > -1);\n        let testLinksOne = d3.select('#sidebar').selectAll('.link').filter(f=> pathsListOne.indexOf(f.data.node) > -1);\n\n        testNodesOne.attr('opacity', .8).selectAll('circle').attr('fill', compareColors[0].dark)\n        testLinksOne.attr('opacity', .8).style('stroke', compareColors[0].dark)\n\n        let testNodesTwo = d3.select('#sidebar').selectAll('.node').filter(f=> pathsListTwo.indexOf(f.data.node) > -1);\n        let testLinksTwo = d3.select('#sidebar').selectAll('.link').filter(f=> pathsListTwo.indexOf(f.data.node) > -1);\n\n        testNodesTwo.attr('opacity', .8).selectAll('circle').attr('fill', compareColors[1].dark)\n        testLinksTwo.attr('opacity', .8).style('stroke', compareColors[1].dark)\n\n        textDiv.append('i')\n        .classed('fas fa-arrow-left', true)\n        .style('margin-right', '10px');\n\n        data.forEach((d, i)=> {\n        textDiv.append('span')\n            .text(d.label)\n            .classed('badge badge-secondary', true)\n            .style('padding', '5px')\n            .style('margin-bottom', '7px')\n            .style('background', compareColors[i].light)\n        });\n\n        textDiv.append('i')\n        .classed('fas fa-arrow-right', true)\n        .style('margin-left', '10px');\n        \n    }\n    let svg = divWrap.append('svg').attr('class', 'compare-svg').style('padding-top', '50px');\n\n    ////COMBINEDATA///\n    if(data.length > 1){\n       \n        let startBins = data[0].groupBins.filter(f=> shownAttributes.indexOf(f.key) > -1);\n        let mapBins = data[1].groupBins.filter(f=> shownAttributes.indexOf(f.key) > -1);\n        let combined = startBins.map((d, i, n)=> {\n         \n            d.branches = [...d.branches].map((b, j)=> {\n                \n                b.bins = [{key:data[0].label, value: b.bins, index:0},\n                          {key:data[1].label, value: mapBins[i].branches[j].bins, index:1}\n                         ];\n             \n                b.data = [{key: data[0].label, \n                            value: b.data.map(m=>{\n                                    m.groupKey = data[0].label;\n                                    m.index = 0;\n                                    return m;\n                                    }), \n                            index: 0},\n                        \n                        { key: data[1].label, \n                            value : mapBins[i].branches[j].data.map(m=> {\n                                    m.groupKey = data[1].label;\n                                    m.index = 1;\n                                    return m;\n                            }), \n                         index: 1 }];\n                return b;\n            });\n          \n           if(d.type === 'continuous'){\n\n            d.leafData.data = [{key: data[0].label, \n                value: d.leafData.data.map(m=>{\n                        m.groupKey = data[0].label;\n                        m.index = 0;\n                        return m;\n                        }), \n                index: 0},\n            \n            { key: data[1].label, \n                value : mapBins[i].leafData.data.map(m=> {\n                        m.groupKey = data[1].label;\n                        m.index = 1;\n                        return m;\n                }), \n             index: 1 }];\n\n             d.leafData.bins = [{key:data[0].label, value: d.leafData.bins, index:0},\n             {key:data[1].label, value: mapBins[i].leafData.bins, index:1}\n                ];\n\n\n\n           }else{\n\n            d.leafData.data = [{key: data[0].label, \n                value: d.leafData.data.map(m=>{\n                        m.groupKey = data[0].label;\n                        m.index = 0;\n                        return m;\n                        }), \n                index: 0},\n            \n            { key: data[1].label, \n                value : mapBins[i].leafData.data.map(m=> {\n                        m.groupKey = data[1].label;\n                        m.index = 1;\n                        return m;\n                }), \n             index: 1 }];\n\n             d.leafData.bins = [\n                \n                {key:data[0].label, keys: d.stateKeys, value: d.leafData.bins, index:0},\n                {key:data[1].label, keys: d.stateKeys, value: mapBins[i].leafData.bins, index:1}\n\n                ];\n\n           }\n           \n            return d;\n        });\n\n        let wrap = svg.append('g').attr('class', 'group-wrap').attr('transform', 'translate(30, 10)');\n        let binnedWrap = wrap.selectAll('.attr-wrap').data(combined).join('g').classed('attr-wrap', true);\n        svg.attr('height', (combined.length * (dimensions.height + 5)));\n        \n        binnedWrap.attr('transform', (d, i, n)=>  {\n            if(i === 0){\n                    return 'translate(0,0)';\n            }else{\n                let selected = d3.selectAll(n).filter((f, j)=>j < i).data();\n                let sum = d3.sum(selected.flatMap(s=> s.type === 'continuous'? dimensions.height+5 : (s.stateKeys.length*(dimensions.squareDim+4))));\n                d.sum = sum;\n                return `translate(0, ${sum})`;\n            }\n        });\n\n        let label = binnedWrap.append('text')\n            .text(d=> d.key);\n    \n            label.filter(f=> f.type === 'continuous')\n            .attr('y', 40)\n            .attr('x', 80)\n            .style('text-anchor', 'end')\n            .style('font-size', 11);\n    \n            label.filter(f=> f.type === 'discrete')\n            .attr('y', (d, i)=> 3)\n            .attr('x', d=> -((d.stateKeys.length)*(dimensions.squareDim)/2))\n            .style('text-anchor', 'middle')\n            .style('font-size', 11)\n            .attr('transform', 'rotate(-90)');\n\n        /////FROM DISCRETE DRAW\n\n        let predictedWrap = binnedWrap.append('g').classed('predicted', true);\n        predictedWrap.attr('transform', 'translate(25, 0)');\n        predictedWrap.filter(f=> f.type === 'discrete').append('g').classed('win-line', true);\n\n        //ROOT RENDERING\n        let root = predictedWrap.selectAll('g.root').data(d=> {\n            return [d.rootData]}).join('g').classed('root', true);\n        root.attr('transform', `translate(60,0)`);\n\n        let contRoot = root.filter(f=> f.type === \"continuous\");\n        contRoot.append('rect')\n            .attr('height', dimensions.height)\n            .attr('width', 12)\n            .attr('fill', '#fff')\n            .style('stroke-width', '0.5px')\n            .style('stroke', 'black')\n    \n        let rootRange = contRoot.append('rect')\n            .attr('width', 12)\n            .attr('height', d=> {\n                let newy = d.scales.yScale;\n                newy.range([(dimensions.height - 5), 0]);\n                return newy(d.values.lowerCI95) - newy(+d.values.upperCI95)\n            }).attr('transform', (d, i) => {\n                let newy = d.scales.yScale;\n                newy.range([(dimensions.height - 5), 0]);\n                return 'translate(0,'+newy(+d.values.upperCI95)+')'\n            }).style('opacity', 0.5)//.attr('fill', \"rgba(133, 193, 233)\")\n            .attr('fill', defaultBarColor);\n    \n        let rootAv = contRoot.append('rect').attr('width', 12).attr('height', 3);\n        \n        rootAv.attr('transform', (d, i) => {\n                let newy = d.scales.yScale;\n                newy.range([dimensions.height, 0]);\n                let mean = +d.values.realVal;\n                return 'translate(0,'+newy(mean)+')';\n        }).attr('fill', '#004573');\n    \n           // Discrete Root\n        let disRoot = root.filter(f=> f.type === \"discrete\");\n        let rootStateGroups = disRoot.selectAll('g.root-state-groups').data(d=> {\n            return d.bins}).join('g').classed('root-state-groups', true);\n    \n        rootStateGroups.append('text')\n            .text((d, i)=> d.color.state)\n            .attr('y', 10)\n            .attr('x', -3)\n            .style('font-size', 10)\n            .style('text-anchor', 'end');\n    \n        rootStateGroups.attr('transform', (d, i)=> `translate(0, ${3.5+(i*(dimensions.squareDim+2))})`);\n        rootStateGroups.append('rect')\n            .attr('height', dimensions.squareDim)\n            .attr('width', dimensions.squareDim)\n            .attr('fill', '#fff').attr('opacity', 1);\n    \n        let rootRects = rootStateGroups.append('rect')\n            .classed('color-rect', true)\n            .attr('height', dimensions.squareDim)\n            .attr('width', dimensions.squareDim);\n    \n        rootRects.attr('fill', (d, i)=> {\n                return `rgba(89, 91, 101, ${d.state[0].value})`;\n            }).attr('stroke-width', 0.5).attr('stroke', `rgba(200, 203, 219, .9)`);\n    \n        let winStateRoot = disRoot.selectAll('g.root-state-groups')\n            .filter((f, j, n)=>{\n                let maxVal = d3.max(d3.selectAll(n).data().map(m=> m.state[0].value));\n                return f.color.state === d3.selectAll(n).data().filter(m=> m.state[0].value === maxVal)[0].color.state;\n            }).classed('win', true);\n    \n        winStateRoot.select('rect.color-rect').attr('fill', (c, i)=> {\n                return c.color.color;\n            }).attr('opacity', (c)=>{\n                let sum = d3.sum(c.state.flatMap(s=> s.value));\n                return sum/c.state.length;\n            });\n\n        ////BRANCHES\n        let branchGroup = predictedWrap.selectAll('g.branch-bin').data(d=> {\n            return d.branches}).join('g').classed('branch-bin', true);\n    \n        branchGroup.attr('transform', (d, i, n)=> {\n            let step = n.length < 11 ? (d.range[1] - d.range[0]) / 5 : 0\n            let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.timeRange])\n                return 'translate('+(100 + (branchScale(i)) + x(step)) +', 0)'});\n\n        let discreteDist = branchGroup.filter(f=> f.type === 'discrete').append('g');\n\n        discreteDist.attr('transform', 'translate(5, 0)');\n\n        let discreteMiddleGroups = discreteDist.selectAll('g.middle-group')\n            .data(d=> {\n                let bins = d.bins.map(b=> {\n                    b.key = d.key;\n                    return b;\n                })\n                return bins})\n            .join('g')\n            .classed('middle-group', true)\n            .attr('transform', (d, i)=> { \n                let move = d.index === 0 ? -(dimensions.squareDim/2) : 0 ;\n                return `translate(${move}, 0)`});\n\n        let stateRects = discreteMiddleGroups\n        .selectAll('rect.state-rect')\n        .data(d=> {\n            let bins = d.value.map(v=> {\n                v.key = d.key;\n                return v;\n            })\n            return bins})\n        .join('rect')\n        .classed('state-rect', true)\n        .attr('height', dimensions.squareDim)\n        .attr('width', dimensions.squareDim/2);\n\n        stateRects.attr('fill', (d, i, n)=> {\n            let sum = d3.sum(d.state.map(m=> m.value))\n            let av = sum / d.state.length;\n            let scale = d3.scaleLinear().domain([0, 1]).range([0, 1]);\n            return `rgba(89, 91, 101, ${scale(av)})`;\n        }).attr('stroke-width', 0.5).attr('stroke', `rgba(200, 203, 219, .9)`);\n\n        stateRects.attr('transform', (d, i)=> {\n            return `translate(0, ${(3.5+(i*(dimensions.squareDim+2)))})`\n        });\n\n        let discreteBinGroups = discreteDist.selectAll('g.group')\n                .data(d=> d.bins)\n                .join('g')\n                .classed('group', true)\n                .attr('transform', (d, i)=> { \n                    let move = d.index === 0 ? (-40 - (dimensions.squareDim/2)) : (dimensions.squareDim/2)\n                    return `translate(${move}, 0)`});\n\n        let stateBarsPredicted = discreteBinGroups.selectAll('g.histo-bars')\n            .data(d=> {\n                let binvalue = d.value.map(v=> {\n                    v.index = d.index;\n                    return v;\n                })\n            return binvalue}).join('g')\n        .classed('histo-bars', true);\n\n        stateBarsPredicted.attr('transform', (d, i)=> {\n            let dev = d3.deviation(d.state.map(m=> m.value));\n            let mean = d3.mean(d.state.map(m=> m.value));\n            let x = d3.scaleLinear().domain([0, 1]).range([0, 40]).clamp(true);\n            let xMove = d.index === 0 ? (40 - x(mean)) : 0;\n            return `translate(${xMove}, ${3.5+(i*(dimensions.squareDim+2))})`\n        });\n\n        let bars = stateBarsPredicted.append('rect')\n            .attr('height', dimensions.squareDim)\n            .attr('width', (d, i, n)=> {\n        let dev = d3.deviation(d.state.map(m=> m.value));\n        let mean = d3.mean(d.state.map(m=> m.value));\n        let x = d3.scaleLinear().domain([0, 1]).range([0, 40]).clamp(true);\n            return x(mean)\n        })\n        .attr('fill', d=> d.color.color)\n        .attr('opacity', 0.3);\n\n        stateRects.on('mouseover', (d, i, n)=> {\n           \n            let sum = d3.sum(d.state.map(m=> m.value))\n            let av = sum / d.state.length;\n            let tool = d3.select('#tooltip');\n            tool.transition()\n                .duration(200)\n                .style(\"opacity\", .9);\n            \n            let f = d3.format(\".3f\");\n              \n            tool.html(`${d.key} </br> ${d.state[0].state} : ${f(av)}`)\n                .style(\"left\", (d3.event.pageX - 40) + \"px\")\n                .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            tool.style('height', 'auto');\n    \n        }).on('mouseout', ()=>{\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n        });\n\n        discreteMiddleGroups.each((d, i, node)=>{\n            let maxBin = 0;\n            let maxState = null;\n            d.value.map(m=> {\n                if(d3.sum(m.state.flatMap(s=> s.value)) > maxBin){\n                    maxBin = d3.sum(m.state.flatMap(s=> s.value));\n                    maxState = m.color.state;\n                }\n            });\n      \n            let winStates = d3.select(node[i]).selectAll('rect.state-rect')\n                .filter((f, j, n)=>{\n                    return f.color.state === maxState;\n                }).classed('win', true)\n                .attr('fill', (c)=> {\n                    return c.color.color;\n                }).attr('opacity', (c)=>{\n                    let sum = d3.sum(c.state.flatMap(s=> s.value));\n                    return sum/c.state.length;\n                })\n        });\n    \n        //////PREDICTED CONTINUOUS\n\n          //CONTIN PREDICTED\n        let continDist = branchGroup.filter(f=> f.type === 'continuous');\n\n        continDist.on('mouseover', (d, i, node)=> {\n            let newData = d.data;\n            let list = newData[0].value.concat(newData[1].value).map(m=> m.node);\n            let selected = pointGroups.filter(p=> {\n                return list.indexOf(p.node) > -1}).classed('selected', true);\n            let treeNode  = d3.select('#sidebar').selectAll('.node');\n            let selectedBranch = treeNode.filter(f=> list.indexOf(f.data.node) > -1).classed('selected-branch', true);\n            let y = d3.scaleLinear().domain(d.domain).range([0, dimensions.height])\n            let axis = d3.select(node[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(5));\n        }).on('mouseout', (d, i, node)=> {\n            d3.selectAll(\".branch-points.selected\").classed('selected', false);\n            d3.selectAll('.selected-branch').classed('selected-branch', false);\n            d3.select(node[i]).select('.y-axis').remove();\n        });\n\n        let continBinGroups = continDist.selectAll('g.group').data(d=> {\n            return d.bins;\n        }).join('g').attr('class', d=> `g-${d.index} group`)//.classed('group', true);\n\n        continBinGroups.each((d, i, nodes)=> {\n            d.maxCount = d3.sum(d.value.map(m=> m.length));\n            d.value.maxCount = d3.sum(d.value.map(m=> m.length));\n            let distrib = d3.select(nodes[i])\n                .selectAll('g')\n                .data([d.value.map(v=> {\n                    v.maxCount = d3.sum(d.value.map(m=> m.length))\n                    v.index = d.index;\n                    return v;\n                })])\n                .join('g')\n                .classed('distribution', true);\n            distrib.attr('transform', (d,i,n)=> {\n                if(d[0].index === 0){\n                    return 'translate(0, 0) rotate(90)'\n                }else{\n                    return 'translate(11, '+dimensions.height+') rotate(-90)'\n                }\n               });\n            let path = distrib.append('path').attr('d', d.index === 0 ? mirrorlineGen : lineGen);\n            path.attr(\"fill\", (v, i, n)=> {\n                return defaultBarColor})\n            .attr('opacity', 0.4)\n            .style('stroke', compareColors[d.index].dark);\n        });\n\n        let contRect = continBinGroups.append('rect')\n        .attr('height', dimensions.height)\n        .attr('width', 10)\n        .style('fill', '#fff')\n        .style('stroke', 'gray');\n\n    let rangeRectWrap = continDist.selectAll('g.range-wrap').data(d=> {\n        return d.data;\n    }).join('g').classed('range-wrap', true);\n    \n    let rangeRect = rangeRectWrap.selectAll('rect.range').data((d,i)=> {\n        let newData = d.value.map(m=> {\n            m.range = d.range;\n            m.gindex = i;\n            return m;\n        })\n        return newData;\n    }).join('rect').classed('range', true);\n\n    let avRect = continDist.selectAll('rect.av-rect').data(d=> d.data)\n        .join('rect').classed('av-rect', true).attr('width', 10).attr('height', (d, i)=> {\n        if(d.value != undefined){\n            return 3;\n        }else{\n            return 0;\n        }\n    });\n    \n    avRect.attr('transform', (d, i) => {\n        if(d.value != undefined){\n            let newy = d.value[0].scales.yScale;\n            newy.range([dimensions.height, 0]);\n            let mean = d3.mean(d.value.map(m=> +m.values.realVal));\n            return 'translate(0,'+newy(mean)+')';\n        }else{\n            return 'translate(0,0)';\n        }\n    }).attr('fill', (d)=>compareColors[d.index].dark);\n\n     //////START BRANCH EXPERIMENT\n     let brush = d3.brushY().extent([[0, 0], [20, dimensions.height]])\n     brush.on('end', brushedComparison);\n\n     continDist.append(\"g\")\n     .classed('continuous-branch-brush', true)\n     .attr(\"class\", \"brush\")\n     .call(brush);\n\n     //////BRUSH FOR COMPARISON/////\n\n     function brushedComparison(){\n\n        let data = d3.select(this.parentNode).data()[0]\n\n        let maxCounts = data.bins.map(m => m.maxCount);\n       \n        var s = d3.event.selection;\n        var zero = d3.format(\".3n\");\n    \n        let index = d3.select('#toolbar').selectAll('.brush-span').size();\n        let classLabel = index === 0 ? 'one' : 'two';\n    \n        if(s != null){\n            let treeTest = d3.select('#sidebar').selectAll('.node').filter(f=> {\n                return f.data.leaf === true});\n    \n            \n            let y = d3.scaleLinear().domain([data.domain[0], data.domain[1]]).range([0, dimensions.height])\n            let attribute = data.key;\n            let brushedVal = [y.invert(s[1]), y.invert(s[0])];\n    \n            let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n            let nodes = data.data.map(m=> m.value.filter(f=> {\n                return (f.values.realVal >= brushedVal[0]) && (f.values.realVal <= brushedVal[1]);\n            }));\n\n\n            let otherBins = continDist.filter(f=> f.index === data.index && f.key != data.key);\n\n            let descendBins = continDist.filter(f=> {\n                return (f.index > data.index) && (f.key === data.key)});\n                \n            \n\n            nodes.forEach((n, i)=> {\n               \n                if(n.length > 0){\n                    let test = d3.select(this.parentNode).select(`.g-${i}`)\n                    let groupDis = test.append('g').classed('distribution-too', true);\n                    \n                    let histo = continuousHistogram(n)\n                    histo.maxCount = maxCounts[i];\n\n                    let names = n.map(m=> m.node);\n                   \n                    groupDis\n                    .data([histo]);\n\n                    groupDis.append('path')\n                    .attr('d', i === 0 ? mirrorlineGen : lineGen)\n                    .style('stroke', compareColors[i].dark)\n                    .style('fill', compareColors[i].light)\n                    .style('fill-opacity', 0.8);\n\n                    groupDis.attr('transform', i === 0 ? 'translate(0, 0) rotate(90)' : `translate(11, ${dimensions.height}) rotate(-90)`);\n                    let otherDis = otherBins\n                    .select(`.g-${i}`).each((o, j, oNode)=> {\n                        let oHisto = continuousHistogram(o.data.filter(f=> f.index === i)[0].value.filter(f=> names.indexOf(f.node) > -1));\n                        oHisto.maxCount = o.bins[i].maxCount;\n                        let oDist = d3.select(oNode[j]).append('g').classed('distribution-too', true);\n                        oDist.data([oHisto])\n                        .append('path')\n                        .attr('d', i === 0 ? mirrorlineGen : lineGen)\n                        .style('stroke', compareColors[i].dark)\n                        .style('fill', compareColors[i].light)\n                        .style('fill-opacity', 0.8);\n                        oDist.attr('transform', i === 0 ? 'translate(0, 0) rotate(90)' : `translate(11, ${dimensions.height}) rotate(-90)`);\n                    });\n\n                    let otherDesDis = descendBins\n                    .select(`.g-${i}`).each((o, j, oNode)=> {\n\n                        let oHisto = continuousHistogram(o.data.filter(f=> f.index === i)[0].value\n                                    .filter(f=> (f.values.realVal > brushedVal[0]) && (f.values.realVal < brushedVal[1])));\n                        oHisto.maxCount = o.bins[i].maxCount;\n\n                        let oDist = d3.select(oNode[j]).append('g').classed('distribution-too', true);\n                        oDist.data([oHisto])\n                        .append('path')\n                        .attr('d', i === 0 ? mirrorlineGen : lineGen)\n                        .style('stroke', compareColors[i].dark)\n                        .style('fill', compareColors[i].light)\n                        .style('fill-opacity', 0.8);\n                        oDist.attr('transform', i === 0 ? 'translate(0, 0) rotate(90)' : `translate(11, ${dimensions.height}) rotate(-90)`);\n\n                    });\n                  \n                }\n            });\n\n             let nodesFlat = data.data.flatMap(m=> m.value.filter(f=> {\n                return (f.values.realVal >= brushedVal[0]) && (f.values.realVal <= brushedVal[1]);\n            }));\n\n           \n            let notNodes = data.data.flatMap(m=> m.value.filter(f=> {\n                return (f.values.realVal < brushedVal[0]) || (f.values.realVal > brushedVal[1]);\n            }));\n    \n            let selectedNodes = brushedNodes(nodesFlat, notNodes, data, brushedVal, classLabel);\n            let selectedBranch = selectedNodes[0];\n            let secondGrp = selectedNodes[1];\n            let antiSelected = selectedNodes[2];\n            let antiSecond = selectedNodes[3];\n    \n            if(index < 2){\n                let doesItExist = d3.select('#toolbar').selectAll('.brush-span').filter((f, i, n)=> {\n                    return d3.select(n[i]).attr('value') == `${data.bins.groupLabel}-${data.key}`;\n                });\n    \n                if(doesItExist.size() === 0){\n    \n                    d3.select(this).select('.selection')\n                    .style('fill', `${brushColors[index][0]}`)\n                    .attr('stroke', `${brushColors[index][0]}`)\n                    .attr('stroke-width', 2);\n    \n                    d3.select(this).select('.overlay')\n                    .attr('stroke', brushColors[index][1])\n                    .attr('stroke-width', 2);\n    \n                    let badge = d3.select('#toolbar')\n                        .append('span')\n                        .attr('class', classLabel)\n                        .attr('id', classLabel)\n                        .classed('brush-span', true)\n                        .classed(`${data.bins.groupLabel}`, true)\n                        .classed('badge badge-secondary', true)\n                        .style('background', brushColors[index][0])\n                        .attr('value', `${data.bins.groupLabel}-${data.key}`)\n                        .datum({brush:this, nodes: nodes})\n                        .text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n    \n                    let xOut = badge.append('i').classed('close fas fa-times', true).style('padding-left', '10px');\n    \n                    xOut.on('click', (d, i, n)=> {\n                        let classy = index === 0 ? 'one' : 'two';\n                        \n                        d3.select(d.brush).call(brush.move, null);\n                        d3.select(n[i].parentNode).remove();\n                        d3.select(d.brush).select('.overlay').attr('stroke-width', 0);\n                        descendBins.selectAll('.distribution-too').remove();\n                        otherBins.selectAll('.distribution-too').remove();\n                        d3.select(d.brush.parentNode).selectAll('.distribution-too').remove();\n                        d3.select('#sidebar').selectAll(`.${classy}`).classed('anti-brushed-second', false);\n                        d3.select('#sidebar').selectAll(`.${classy}`).classed('anti-brushed', false);\n                    });\n    \n                }else{\n\n                    doesItExist.text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n                    let xOut = doesItExist.append('i').classed('close fas fa-times', true).style('padding-left', '10px');\n    \n                    xOut.on('click', (d, i, n)=> {\n                        d3.select(d).call(brush.move, null);\n                        d3.select(d).select('.overlay').attr('stroke-width', 0);\n                        d3.select(n[i].parentNode).remove();\n                    });\n                   \n                    d3.select(doesItExist.datum()).call(brush.move, null);\n                    d3.select(doesItExist.datum()).select('.overlay').attr('stroke-width', 0)\n    \n                    treeNode.selectAll(`.${data.key}`)\n                        .selectAll(`${data.bins.groupLabel}`)\n                        .selectAll('.second-branch')\n                        .classed('second-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                    treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.selected-branch')\n                        .classed('selected-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                        treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.anti-brushed-second')\n                        .classed('anti-brushed-second', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                        treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.anti-brushed-branch')\n                        .classed('anti-brushed-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n    \n                    let label = doesItExist.attr('id');\n    \n                    index = label === 'one' ? 0 : 1;\n    \n                    d3.select(this).select('.selection')\n                        .style('fill', `${brushColors[index][0]}`)\n                        .attr('stroke', `${brushColors[index][0]}`)\n                        .attr('stroke-width', 2);\n    \n                    d3.select(this).select('.overlay')\n                        .attr('stroke', brushColors[index][1])\n                        .attr('stroke-width', 2);\n\n                        let nodes = data.data.flatMap(m=> m.value.filter(f=> {\n                            return (f.values.realVal >= brushedVal[0]) && (f.values.realVal <= brushedVal[1]);\n                        }))\n                       \n                        let notNodes = data.data.flatMap(m=> m.value.filter(f=> {\n                            return (f.values.realVal < brushedVal[0]) || (f.values.realVal > brushedVal[1]);\n                        }));\n\n                        doesItExist.datum({brush: this, nodes: nodes})\n    \n                    brushedNodes(nodes, notNodes, data, brushedVal, label);\n                    \n                }\n    \n            }else{\n    \n                d3.select('#toolbar').selectAll('.brush-span').filter((f, i)=> i === 0).remove();\n    \n                let classLabel = colorBool === 0 ? 'one': 'two';\n    \n                d3.select('#toolbar')\n                    .append('span')\n                    .attr('class', )\n                    .classed('brush-span', true)\n                    .classed('badge badge-secondary', true)\n                    .style('background', brushColors[colorBool][0])\n                    .attr('value', `${data.bins.groupLabel}-${data.key}`)\n                    .text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n\n                colorBool === 0 ? colorBool = 1 : colorBool = 0;\n                secondGrp.classed(classLabel, true);\n                selectedBranch.classed(classLabel, true);\n            }\n    \n        }else{\n            d3.selectAll(`.${data.key}.brushed-branch`).classed('brushed-branch', false);\n            d3.selectAll(`.${data.key}.brushed-second`).classed('brushed-second', false);\n        }\n     }\n    \n\n    ///OBSERVED/////\n    let observedWrap = binnedWrap.append('g').classed('observed', true);\n    observedWrap.attr('transform', (d, i, n)=> {\n        return 'translate('+ (dimensions.predictedWidth + 150) +', 0)'});\n\n    ////OBSERVED CONTIUOUS/////\n    let contOb = observedWrap.filter(f=> f.type === 'continuous');\n    contOb.attr('transform', `translate(${dimensions.predictedWidth + 160}, -15)`);\n\n    let compContGroups = contOb.selectAll('g.cont-groups').data(d=> d.leafData.bins).join('g').classed('cont-groups', true);\n\n    let contBars = compContGroups.selectAll('g.ob-bars').data(d=> {\n        let value = d.value.map(m=> {\n            m.index = d.index;\n            return m;\n        });\n        return value}).join('g').classed('ob-bars', true);\n\n    let cRects = contBars.append('rect').attr('width', (d, i, n)=> {\n        let width = dimensions.observedWidth / n.length;\n        return width;\n    }).attr('height', (d, i)=> {\n        let y = d3.scaleLinear().domain([0, Object.keys(d).length]).range([(dimensions.height - dimensions.margin), 0])\n        return y(Object.keys(d).length - 2)\n    })\n    .attr('fill', d=> compareColors[d.index].light).attr('fill-opacity', .4);\n\n    contBars.attr('transform', (d, i, n)=> {\n        let movex = dimensions.observedWidth / n.length;\n        let y = d3.scaleLinear()\n            .domain([0, Object.keys(d).length])\n            .range([(dimensions.height - dimensions.margin), 0]);\n\n     let movey = dimensions.height - y(Object.keys(d).length - 2);\n     return 'translate('+(movex * i)+', '+movey+')'});\n\n contOb.each((d, i, nodes)=> {\n\n     let xvalues = d.leafData.data[0].value.map(m=> {\n         return +m.values.realVal});\n     let x = d3.scaleLinear()\n         .domain([d3.min(xvalues), d3.max(xvalues)])\n         .range([0, dimensions.observedWidth]);\n\n     let y = d3.scaleLinear()\n         .domain([0, d3.max(d.leafData.bins[0].value.map(b=> Object.keys(b).length)) - 2])\n         .range([(dimensions.height - dimensions.margin), 0]);\n     \n     d3.select(nodes[i])\n         .append('g')\n         .classed('x-axis', true)\n         .call(d3.axisBottom(x))\n         .attr('transform', 'translate(0, '+dimensions.height+')')\n\n     d3.select(nodes[i]).append('g')\n         .classed('y-axis', true)\n         .call(d3.axisLeft(y).ticks(4))\n         .attr('transform', 'translate(0, '+dimensions.margin+')');\n\n         d3.select(nodes[i]).select('.x-axis').selectAll('text').style('font-size', '8px');\n         d3.select(nodes[i]).select('.y-axis').selectAll('text').style('font-size', '8px');\n\n         d3.select(nodes[i])\n         .append('g')\n         .classed('x-axis-label', true)\n         .append('text').text('Frequency')\n         .attr('transform', `translate(-20, ${dimensions.height- 10}) rotate(-90)`)\n         .style('font-size', '10px');\n });\n \n        ////Observed Discrete////\n        let discOb =  observedWrap.filter(f=> f.type === 'discrete');\n\n        discOb.attr('transform', `translate(${dimensions.predictedWidth + 160}, 5)`);\n\n        let compDisGroups = discOb.selectAll('g.dis-groups').data(d=> d.leafData.bins).join('g').classed('dis-groups', true);\n\n        let discBars = compDisGroups.selectAll('g.ob-bars').data(d=> {\n            \n            return d.keys.map((key, i)=>{\n                return {state: key, data: d.value[i], max: d3.sum(d.value[i].map(b=> b.length)), index: d.index}\n            });\n        }).join('g').classed('ob-bars', true);\n        let dRects = discBars.append('rect').attr('width', (d, i, n)=> {\n            let width = dimensions.observedWidth / n.length;\n            return width/2;\n        }).attr('height', (d, i, n)=> {\n           \n            let height = d.data[0] ? (d.data[0].scales.stateColors.length * dimensions.squareDim - 10): 0;\n            let y = d3.scaleLinear().domain([0, d.max]).range([0, (height)])\n            return y(d.data.length);\n        }).attr('fill', (d, i) => {\n            return d.data[0] != undefined ? d.data[0].color : '#fff';\n        }).attr('opacity', 0.3);\n\n        discBars.attr('transform', (d, i, n)=> {\n            let movex = dimensions.observedWidth / n.length;\n            let offSet = movex / 2\n            let height = d.data[0] ? (d.data[0].scales.stateColors.length * dimensions.squareDim - 10) : 0;\n            let y = d3.scaleLinear().domain([0, d.max]).range([0, (height-5)])\n            let movey = (height-2) - y(d.data.length);\n            let finalMove = d.index === 0 ? 'translate('+(movex * i)+', '+movey+')' : 'translate('+(offSet+(movex * i))+', '+movey+')';\n            return finalMove;\n        })\n\n        dRects.on('mouseover', (d, i, n)=> {\n            let state = d3.select('g.'+d[0].label).selectAll('g.state');\n            state.filter(f=> {\n                return f[0].state === d[0].winState}).attr('opacity', 0.8);\n            state.filter(f=> f[0].state != d[0].winState).attr('opacity', 0.1);\n            d3.select(n[i]).attr('opacity', 0.9);\n        }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).attr('opacity', 0.3);\n            let state = d3.select('g.'+d[0].label).selectAll('g.state').attr('opacity', 0.6);\n        });\n\n        discOb.each((d, i, nodes)=> {\n                \n                let xPoint = d3.scalePoint().domain(d.stateKeys).range([0, dimensions.observedWidth]).padding(.6)\n                let height = d.stateKeys ? (d.stateKeys.length * dimensions.squareDim - 10) : 0;\n                let y = d3.scaleLinear().domain([0, d.leafData.data.length]).range([(height), 0]);\n                d3.select(nodes[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(4))//.attr('transform', 'translate(0, '+height+')');\n                d3.select(nodes[i]).append('g').classed('x-axis', true).call(d3.axisBottom(xPoint)).attr('transform', 'translate(0, '+height+')');\n\n                d3.select(nodes[i]).select('.x-axis').selectAll('text').style('font-size', '8px');\n                d3.select(nodes[i]).select('.y-axis').selectAll('text').style('font-size', '8px');\n        });\n\n\n\n    }\n\n}\n\n/**\n * \n * @param {*} binnedWrap \n * @param {*} branchScale \n * @param {*} pointGroups \n */\n\nexport function renderDistibutions(binnedWrap, branchScale, pointGroups){\n\n    let predictedWrap = binnedWrap.append('g').classed('predicted', true);\n    predictedWrap.attr('transform', 'translate(25, 0)');\n    predictedWrap.filter(f=> f.type === 'discrete').append('g').classed('win-line', true);\n\n    //ROOT RENDERING\n    let root = predictedWrap.selectAll('g.root').data(d=> {\n        return [d.rootData]}).join('g').classed('root', true);\n    root.attr('transform', `translate(60,0)`);\n\n    let contRoot = root.filter(f=> f.type === \"continuous\");\n    contRoot.append('rect')\n        .attr('height', dimensions.height)\n        .attr('width', 12)\n        .attr('fill', '#fff')\n        .style('stroke-width', '0.5px')\n        .style('stroke', 'black')\n\n    let rootRange = contRoot.append('rect')\n        .attr('width', 12)\n        .attr('height', d=> {\n            let newy = d.scales.yScale;\n            newy.range([(dimensions.height - 5), 0]);\n            return newy(d.values.lowerCI95) - newy(+d.values.upperCI95)\n        }).attr('transform', (d, i) => {\n            let newy = d.scales.yScale;\n            newy.range([(dimensions.height - 5), 0]);\n            return 'translate(0,'+newy(+d.values.upperCI95)+')'\n        }).style('opacity', 0.5).attr('fill', defaultBarColor);\n\n    let rootAv = contRoot.append('rect').attr('width', 12).attr('height', 3);\n    \n    rootAv.attr('transform', (d, i) => {\n            let newy = d.scales.yScale;\n            newy.range([dimensions.height, 0]);\n            let mean = +d.values.realVal;\n            return 'translate(0,'+newy(mean)+')';\n    }).attr('fill', '#004573');\n\n       // Discrete Root\n    let disRoot = root.filter(f=> f.type === \"discrete\");\n    let rootStateGroups = disRoot.selectAll('g.root-state-groups').data(d=> {\n        return d.bins}).join('g').classed('root-state-groups', true);\n\n    rootStateGroups.append('text')\n        .text((d, i)=> d.color.state)\n        .attr('y', 10)\n        .attr('x', -3)\n        .style('font-size', 10)\n        .style('text-anchor', 'end');\n\n    rootStateGroups.attr('transform', (d, i)=> `translate(0, ${3.5+(i*(dimensions.squareDim+2))})`);\n    rootStateGroups.append('rect')\n        .attr('height', dimensions.squareDim)\n        .attr('width', dimensions.squareDim)\n        .attr('fill', '#fff').attr('opacity', 1);\n\n    let rootRects = rootStateGroups.append('rect')\n        .classed('color-rect', true)\n        .attr('height', dimensions.squareDim)\n        .attr('width', dimensions.squareDim);\n\n    rootRects.attr('fill', (d, i)=> {\n            return `rgba(89, 91, 101, ${d.state[0].value})`;\n        }).attr('stroke-width', 0.5).attr('stroke', `rgba(200, 203, 219, .9)`);\n\n    let winStateRoot = disRoot.selectAll('g.root-state-groups')\n        .filter((f, j, n)=>{\n            let maxVal = d3.max(d3.selectAll(n).data().map(m=> m.state[0].value));\n            return f.color.state === d3.selectAll(n).data().filter(m=> m.state[0].value === maxVal)[0].color.state;\n        }).classed('win', true);\n\n    winStateRoot.select('rect.color-rect').attr('fill', (c, i)=> {\n            return c.color.color;\n        }).attr('opacity', (c)=>{\n            let sum = d3.sum(c.state.flatMap(s=> s.value));\n            return sum/c.state.length;\n        })\n\n\n    /////BRANCHES\n    let branchGroup = predictedWrap.selectAll('g.branch-bin').data(d=> {\n        return d.branches}).join('g').classed('branch-bin', true);\n\n    branchGroup.attr('transform', (d, i, n)=> {\n        let step = n.length < 11 ? (d.range[1] - d.range[0]) / 5 : 0\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.timeRange])\n            return 'translate('+(100 + (branchScale(i)) + x(step)) +', 0)'});\n\n    let discreteDist = branchGroup.filter(f=> f.type === 'discrete');\n\n    /////////EXPERIMENT////////\n    let stateBarsPredicted = discreteDist.selectAll('g.histo-bars')\n        .data(d=> {\n            let bins = d.bins.map(m=> {\n                m.index = d.index;\n                return m\n            });\n            return bins}).join('g')\n        .classed('histo-bars', true);\n  \n//stateBarsPredicted.attr('transform', (d, i)=> `translate(${dimensions.squareDim}, ${3.5+(i*(dimensions.squareDim+2))})`);\n    stateBarsPredicted.attr('transform', (d, i, n)=> {\n        return `translate(${dimensions.squareDim}, ${3.5+(i*(dimensions.squareDim+2))})`});\n\n    let bars = stateBarsPredicted.append('rect')\n              .attr('height', dimensions.squareDim)\n              .attr('width', 80)\n              .attr('stroke', 'black')\n              .attr('fill', '#fff')\n              .attr('opacity', 0.3);\n\n    let probabilityTicks = stateBarsPredicted.selectAll('.prob-tick').data(d=> {\n        return d.state;\n    }).join('rect').classed('prob-tick', true)\n\n    probabilityTicks\n    .attr('width', 2)\n    .attr('height', dimensions.squareDim)\n    .attr('opacity', 0.2)\n    .attr('fill', 'gray');\n\n    probabilityTicks.attr('transform', (d, i, n)=> {\n        let scale = d3.scaleLinear().domain([0, 1]).range([0, (80 - 2)]);\n        return `translate(${scale(d.value)},0)`})\n\n    /////////END XPERIMENT////////\n\n    let stateBinsPredicted = discreteDist.selectAll('g.state-bins')\n        .data(d=> d.bins).join('g')\n        .classed('state-bins', true);\n\n    stateBinsPredicted.attr('transform', (d, i)=> `translate(0, ${3.5+(i*(dimensions.squareDim+2))})`);\n\n    stateBinsPredicted.append('rect')\n        .attr('height', dimensions.squareDim)\n        .attr('width', dimensions.squareDim)\n        .attr('fill', '#fff').attr('opacity', 1);\n\n    let stateRects = stateBinsPredicted.append('rect')\n        .classed('state-rect', true)\n        .attr('height', dimensions.squareDim)\n        .attr('width', dimensions.squareDim);\n\n    stateRects.attr('fill', (d, i, n)=> {\n        let sum = d3.sum(d.state.map(m=> m.value))\n        let av = sum / d.state.length;\n        let scale = d3.scaleLinear().domain([0, 1]).range([0, 1]);\n        return `rgba(89, 91, 101, ${scale(av)})`;\n    }).attr('stroke-width', 0.5).attr('stroke', `rgba(200, 203, 219, .9)`);\n\n    stateRects.on('mouseover', (d, i, n)=> {\n        let sum = d3.sum(d.state.map(m=> m.value))\n        let av = sum / d.state.length;\n        let tool = d3.select('#tooltip');\n        tool.transition()\n            .duration(200)\n            .style(\"opacity\", .9);\n        \n        let f = d3.format(\".3f\");\n          \n        tool.html(`${d.state[0].state} : ${f(av)}`)\n            .style(\"left\", (d3.event.pageX - 40) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n        tool.style('height', 'auto');\n\n    }).on('mouseout', ()=>{\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(500)\n          .style(\"opacity\", 0);\n    });\n\n    discreteDist.each((d, i, node)=>{\n        let maxBin = 0;\n        let maxState = null;\n        d.bins.map(m=> {\n            if(d3.sum(m.state.flatMap(s=> s.value)) > maxBin){\n                maxBin = d3.sum(m.state.flatMap(s=> s.value));\n                maxState = m.color.state;\n            }\n        });\n  \n        let winStates = d3.select(node[i]).selectAll('g.state-bins')\n            .filter((f, j, n)=>{\n                return f.color.state === maxState;\n            }).classed('win', true);\n\n           \n        let winStateTicks = d3.select(node[i]).selectAll('g.histo-bars')\n            .filter((f, j, n)=>{\n                return f.color.state === maxState;\n            }).classed('win', true);\n        \n        console.log(winStateTicks)\n\n        winStates.select('rect.state-rect').attr('fill', (c)=> {\n                return c.color.color;\n            }).attr('opacity', (c)=>{\n                let sum = d3.sum(c.state.flatMap(s=> s.value));\n                return sum/c.state.length;\n            });\n        winStateTicks.selectAll('rect.prob-ticks').attr('fill', (c)=> {\n            console.log('c',c)\n                return c.color.color;\n            }).attr('opacity', (c)=>{\n                let sum = d3.sum(c.state.flatMap(s=> s.value));\n                return sum/c.state.length;\n            });\n            \n       // console.log('node',node[i])\n    });\n\n    let disWrap = predictedWrap.filter(f=> f.type === 'discrete')\n    let pathKeeper = []\n    disWrap.each((d, i, node)=> {\n        let winPosArray = [];\n        d3.select(node[i]).selectAll('.win').each((r, j, n)=>{\n            winPosArray.push([n[j].getBoundingClientRect().x,(n[j].getBoundingClientRect().y + 10)])\n            winPosArray.push([n[j].getBoundingClientRect().x + 15,(n[j].getBoundingClientRect().y + 10)])\n        });\n        pathKeeper.push([...winPosArray]);\n        let lineThing = d3.line();\n        winPosArray[winPosArray.length -1][1] = winPosArray[winPosArray.length -1][1] + 2;\n        winPosArray[winPosArray.length -2][1] = winPosArray[winPosArray.length -2][1] + 2;\n        d.win = winPosArray;\n    });\n\n    disWrap.each((e, i, n)=> {\n        let lineThing = d3.line();\n        d3.select(n[i]).select('.win-line').append('path').attr('d', (d)=> lineThing(d.win))\n        .attr('transform', 'translate(-75, -'+n[i].getBoundingClientRect().y+')')\n        .attr('fill', 'none')\n        .attr('stroke', `rgba(200, 203, 219, .9)`)\n        .attr('stoke-width', 1)\n    });\n\n    //CONTIN PREDICTED\n    let continDist = branchGroup.filter(f=> f.type === 'continuous');\n\n    continDist.on('mouseover', (d, i, node)=> {\n        let list = d.data.map(m=> m.node);\n        let selected = pointGroups.filter(p=> {\n            return list.indexOf(p.node) > -1}).classed('selected', true);\n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n        let selectedBranch = treeNode.filter(f=> list.indexOf(f.data.node) > -1).classed('selected-branch', true);\n        let y = d3.scaleLinear().domain(d.domain).range([0, dimensions.height])\n        let axis = d3.select(node[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(5));\n    }).on('mouseout', (d, i, node)=> {\n        d3.selectAll(\".branch-points.selected\").classed('selected', false);\n        d3.selectAll('.selected-branch').classed('selected-branch', false);\n        d3.select(node[i]).select('.y-axis').remove();\n    });\n\n    continDist.each((d, i, nodes)=> {\n        let distrib = d3.select(nodes[i])\n            .selectAll('g')\n            .data([d.bins])\n            .join('g')\n            .classed('distribution', true);\n\n        distrib.attr('transform', 'translate(11, '+dimensions.height+') rotate(-90)');\n        let path = distrib.append('path').attr('d', lineGen);\n        path.attr(\"fill\", defaultBarColor).attr('fill-opacity', .4)//.attr(\"fill\", \"rgba(133, 193, 233, .4)\")\n        .style('stroke', defaultBarColor);\n    });\n\n    let contRect = continDist.append('rect')\n        .attr('height', dimensions.height)\n        .attr('width', 10)\n        .style('fill', 'none')\n        .style('stroke', 'gray');\n\n    let rangeRect = continDist.selectAll('rect.range').data(d=> {\n        let newData = d.data.map(m=> {\n            m.range = d.range;\n            return m;\n        })\n        return newData}).join('rect').classed('range', true);\n\n    rangeRect.attr('width', 10);\n    rangeRect.attr('height', (d, i)=> {\n        if(d.scales.yScale != undefined){\n            let newy = d.scales.yScale;\n            newy.range([80, 0]);\n            return newy(d.values.lowerCI95) - newy(d.values.upperCI95)\n        }else{\n            return 0;\n        }\n    }).attr('transform', (d, i) => {\n        let newy = d.scales.yScale;\n        newy.range([80, 0]);\n        return 'translate(0,'+newy(d.values.upperCI95)+')'\n    });\n\n    //rangeRect.attr('fill', \"rgba(133, 193, 233, .05)\");\n    rangeRect.attr('fill', defaultBarColor).attr('opacity', 0.5)\n\n    let avRect = continDist.append('rect').attr('width', 10).attr('height', (d, i)=> {\n        if(d.data[0] != undefined){\n            return 3;\n        }else{\n            return 0;\n        }\n    });\n\n    avRect.attr('transform', (d, i) => {\n        if(d.data[0] != undefined){\n            let newy = d.data[0].scales.yScale;\n            newy.range([dimensions.height, 0]);\n            let mean = d3.mean(d.data.map(m=> +m.values.realVal));\n            return 'translate(0,'+newy(mean)+')';\n        }else{\n            return 'translate(0,0)';\n        }\n    }).attr('fill', '#004573');\n\n     //////START BRANCH EXPERIMENT\n     let brush = d3.brushY().extent([[0, 0], [20, dimensions.height]])\n     brush.on('end', brushed);\n\n     continDist.append(\"g\")\n     .classed('continuous-branch-brush', true)\n     .attr(\"class\", \"brush\")\n     .call(brush);\n \n     function brushed(){\n\n        let data = d3.select(this.parentNode).data()[0]\n        var s = d3.event.selection;\n        var zero = d3.format(\".3n\");\n\n       \n    \n        let index = d3.select('#toolbar').selectAll('.brush-span').size();\n        let classLabel = index === 0 ? 'one' : 'two';\n    \n        if(s != null){\n            let treeTest = d3.select('#sidebar').selectAll('.node').filter(f=> {\n                return f.data.leaf === true});\n    \n            if(treeTest.empty()){\n                renderTree(d3.select('#sidebar'), null, true);\n            }\n\n            let y = d3.scaleLinear().domain([data.domain[0], data.domain[1]]).range([0, dimensions.height])\n           \n            let attribute = data.key;\n            let brushedVal = [y.invert(s[1]), y.invert(s[0])];\n    \n            let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n            let nodes = data.data.filter(f=> {\n                return (f.values.realVal > brushedVal[0]) && (f.values.realVal < brushedVal[1]);\n            });\n           \n            let test = continuousHistogram(nodes);\n\n           \n            test.maxCount = d3.sum(data.bins.map(m=> m.length));\n\n            //////EXPERIMENTING WITH BRUSH DRAW DISTRIBUTIONS////\n            let brushedDist = d3.select(this.parentNode)\n            .selectAll('g.distribution-too')\n            .data([test])\n            .join('g')\n            .classed('distribution-too', true);\n\n            brushedDist.attr('transform', 'translate(0, 0) rotate(90)');\n            let path = brushedDist.append('path').attr('d', mirrorlineGen);\n            path.attr(\"fill\", brushColors[index][0]).attr('fill-opacity', 0.5)\n            .style('stroke', brushColors[index][0]);\n\n            let nodeNames = nodes.map(m=> m.node);\n\n            let otherBins = continDist.filter(f=> f.index === data.index && f.key != data.key);\n            otherBins.each((b, i, n)=> {\n                \n                let test = continuousHistogram(b.data.filter(f=> nodeNames.indexOf(f.node) > -1) );\n               \n                test.maxCount = d3.sum(b.bins.map(m=> m.length));\n              \n                let otherDist = d3.select(n[i]).selectAll('g.distribution-too')\n                .data([test])\n                .join('g')\n                .classed('distribution-too', true);\n\n                otherDist.attr('transform', 'translate(0, 0) rotate(90)');\n                let path = otherDist.append('path').attr('d', mirrorlineGen);\n                path.attr(\"fill\", brushColors[index][0]).attr('fill-opacity', 0.5)\n                .style('stroke', brushColors[index][0]);\n    \n            });\n\n            let descendBins = continDist.filter(f=> {\n                return (f.index > data.index) && (f.key === data.key)});\n\n            descendBins.each((b, i, n)=> {\n\n                let test = b.data.filter(f=> {\n                    return (f.values.realVal > brushedVal[0]) && (f.values.realVal < brushedVal[1]);\n                    });\n\n                 let testH = continuousHistogram(test);\n               \n                 testH.maxCount = d3.sum(b.bins.map(m=> m.length));\n              \n                let otherDist = d3.select(n[i]).selectAll('g.distribution-too')\n                .data([testH])\n                .join('g')\n                .classed('distribution-too', true);\n\n                otherDist.attr('transform', 'translate(0, 0) rotate(90)');\n                let path = otherDist.append('path').attr('d', mirrorlineGen);\n                path.attr(\"fill\", brushColors[index][0]).attr('fill-opacity', 0.5)\n                .style('stroke', brushColors[index][0]);\n\n            })\n          \n            ////END DISTRIBUTION///\n           \n            let notNodes = data.data.filter(f=> {\n                return (f.values.realVal < brushedVal[0]) || (f.values.realVal > brushedVal[1]);\n            });\n\n            let selectedNodes = brushedNodes(nodes, notNodes, data, brushedVal, classLabel);\n            let selectedBranch = selectedNodes[0];\n            let secondGrp = selectedNodes[1];\n            let antiSelected = selectedNodes[2];\n            let antiSecond = selectedNodes[3];\n    \n            if(index < 2){\n    \n                let doesItExist = d3.select('#toolbar').selectAll('.brush-span').filter((f, i, n)=> {\n                    return d3.select(n[i]).attr('value') == `${data.bins.groupLabel}-${data.key}`;\n                });\n    \n                if(doesItExist.size() === 0){\n    \n                    d3.select(this).select('.selection')\n                    .style('fill', `${brushColors[index][0]}`)\n                    .attr('stroke', `${brushColors[index][0]}`)\n                    .attr('stroke-width', 2);\n    \n                    d3.select(this).select('.overlay')\n                    .attr('stroke', brushColors[index][1])\n                    .attr('stroke-width', 2);\n    \n                    let badge = d3.select('#toolbar')\n                        .append('span')\n                        .attr('class', classLabel)\n                        .attr('id', classLabel)\n                        .classed('brush-span', true)\n                        .classed(`${data.bins.groupLabel}`, true)\n                        .classed('badge badge-secondary', true)\n                        .style('background', brushColors[index][0])\n                        .attr('value', `${data.bins.groupLabel}-${data.key}`)\n                        .datum({brush:this, nodes: nodes})\n                        .text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n    \n                    let xOut = badge.append('i').classed('close fas fa-times', true).style('padding-left', '10px');\n    \n                    xOut.on('click', (d, i, n)=> {\n                       \n                        let classy = index === 0 ? 'one' : 'two';\n                        \n                        d3.select(d.brush).call(brush.move, null);\n                        d3.select(n[i].parentNode).remove();\n                        d3.select(d.brush).select('.overlay').attr('stroke-width', 0);\n                        descendBins.selectAll('.distribution-too').remove();\n                        otherBins.selectAll('.distribution-too').remove();\n                        d3.select(d.brush.parentNode).select('.distribution-too').remove();\n                        d3.select('#sidebar').selectAll(`.${classy}`).classed('anti-brushed-second', false);\n                        d3.select('#sidebar').selectAll(`.${classy}`).classed('anti-brushed', false);\n                    });\n    \n                }else{\n    \n                    doesItExist.text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n                    let xOut = doesItExist.append('i').classed('close fas fa-times', true).style('padding-left', '10px');\n    \n                    xOut.on('click', (d, i, n)=> {\n                        d3.select(d).call(brush.move, null);\n                        d3.select(d).select('.overlay').attr('stroke-width', 0);\n                        d3.select(n[i].parentNode).remove();\n                    });\n                   \n                    d3.select(doesItExist.datum().brush).call(brush.move, null);\n                    d3.select(doesItExist.datum().brush).select('.overlay').attr('stroke-width', 0)\n    \n                    treeNode.selectAll(`.${data.key}`)\n                        .selectAll(`${data.bins.groupLabel}`)\n                        .selectAll('.second-branch')\n                        .classed('second-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                    treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.selected-branch')\n                        .classed('selected-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                        treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.anti-brushed-second')\n                        .classed('anti-brushed-second', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                        treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.anti-brushed-branch')\n                        .classed('anti-brushed-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                    let label = doesItExist.attr('id');\n    \n                    index = label === 'one' ? 0 : 1;\n    \n                    d3.select(this).select('.selection')\n                        .style('fill', `${brushColors[index][0]}`)\n                        .attr('stroke', `${brushColors[index][0]}`)\n                        .attr('stroke-width', 2);\n    \n                    d3.select(this).select('.overlay')\n                        .attr('stroke', brushColors[index][1])\n                        .attr('stroke-width', 2);\n\n                       \n                    let nodes = data.data.filter(f=> {\n                        return (f.values.realVal >= brushedVal[0]) && (f.values.realVal <= brushedVal[1]);\n                    });\n\n                    let notNodes = data.data.filter(f=> {\n                        return (f.values.realVal < brushedVal[0]) || (f.values.realVal > brushedVal[1]);\n                    });\n\n                    doesItExist.datum({brush:this, nodes: nodes})\n                    brushedNodes(nodes, notNodes, data, brushedVal, label);\n                    \n                }\n    \n            }else{\n    \n                d3.select('#toolbar').selectAll('.brush-span').filter((f, i)=> i === 0).remove();\n    \n                let classLabel = colorBool === 0 ? 'one': 'two';\n    \n                d3.select('#toolbar')\n                    .append('span')\n                    .attr('class', )\n                    .classed('brush-span', true)\n                    .classed('badge badge-secondary', true)\n                    .style('background', brushColors[colorBool][0])\n                    .attr('value', `${data.bins.groupLabel}-${data.key}`)\n                    .text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n                colorBool === 0 ? colorBool = 1 : colorBool = 0;\n                secondGrp.classed(classLabel, true);\n                selectedBranch.classed(classLabel, true);\n            }\n    \n        }else{\n            d3.selectAll(`.${data.key}.brushed-branch`).classed('brushed-branch', false);\n            d3.selectAll(`.${data.key}.brushed-second`).classed('brushed-second', false);\n        }\n     }\n\n     ///OBSERVED/////\n     let observedWrap = binnedWrap.append('g').classed('observed', true);\n     observedWrap.attr('transform', (d, i, n)=> {\n         return 'translate('+ (dimensions.predictedWidth + 150) +', 0)'});\n\n    ////OBSERVED CONTIUOUS/////\n    let contOb = observedWrap.filter(f=> f.type === 'continuous');\n    contOb.attr('transform', `translate(${dimensions.predictedWidth + 160}, -15)`);\n\n    let contBars = contOb.selectAll('g.ob-bars').data(d=> {\n        return d.leafData.bins}).join('g').classed('ob-bars', true);\n\n    let cRects = contBars.append('rect').attr('width', (d, i, n)=> {\n        let width = dimensions.observedWidth / n.length;\n        return width;\n    }).attr('height', (d, i)=> {\n        let y = d3.scaleLinear().domain([0, Object.keys(d).length]).range([(dimensions.height - dimensions.margin), 0])\n        return y(Object.keys(d).length - 2)\n    })\n    .attr('fill', defaultBarColor).attr('fill-opacity', .5);\n\n    contBars.attr('transform', (d, i, n)=> {\n        let movex = dimensions.observedWidth / n.length;\n        let y = d3.scaleLinear()\n            .domain([0, Object.keys(d).length])\n            .range([(dimensions.height - dimensions.margin), 0]);\n\n        let movey = dimensions.height - y(Object.keys(d).length - 2);\n        return 'translate('+(movex * i)+', '+movey+')'});\n\n    contOb.each((d, i, nodes)=> {\n\n        let xvalues = d.leafData.data.map(m=> {\n            return +m.values.realVal});\n        let x = d3.scaleLinear()\n            .domain([d3.min(xvalues), d3.max(xvalues)])\n            .range([0, dimensions.observedWidth]);\n\n        let y = d3.scaleLinear()\n            .domain([0, d3.max(d.leafData.bins.map(b=> Object.keys(b).length)) - 2])\n            .range([(dimensions.height - dimensions.margin), 0]);\n        \n        d3.select(nodes[i])\n            .append('g')\n            .classed('x-axis', true)\n            .call(d3.axisBottom(x))\n            .attr('transform', 'translate(0, '+dimensions.height+')')\n\n        d3.select(nodes[i]).append('g')\n            .classed('y-axis', true)\n            .call(d3.axisLeft(y).ticks(4))\n            .attr('transform', 'translate(0, '+dimensions.margin+')');\n\n            d3.select(nodes[i]).select('.x-axis').selectAll('text').style('font-size', '8px');\n            d3.select(nodes[i]).select('.y-axis').selectAll('text').style('font-size', '8px');\n\n            d3.select(nodes[i])\n            .append('g')\n            .classed('x-axis-label', true)\n            .append('text').text('Frequency')\n            .attr('transform', `translate(-20, ${dimensions.height- 10}) rotate(-90)`)\n            .style('font-size', '10px');\n    });\n    \n    ////Observed Discrete////\n    let discOb =  observedWrap.filter(f=> f.type === 'discrete');\n\n    discOb.attr('transform', `translate(${dimensions.predictedWidth + 160}, 5)`)\n    let discBars = discOb.selectAll('g.ob-bars').data(d=> {\n        return d.stateKeys.map((key, i)=>{\n            return {state: key, data: d.leafData.bins[i], max: d3.sum(d.leafData.bins.map(b=> b.length))}\n        });\n    }).join('g').classed('ob-bars', true);\n    let dRects = discBars.append('rect').attr('width', (d, i, n)=> {\n        let width = dimensions.observedWidth / n.length;\n        return width;\n    }).attr('height', (d, i, n)=> {\n        let height = d.data[0] ? (d.data[0].scales.stateColors.length * dimensions.squareDim - 10): 0;\n        let y = d3.scaleLinear().domain([0, d.max]).range([0, (height)])\n        return y(d.data.length);\n    }).attr('fill', (d, i) => {\n        return d.data[0] != undefined ? d.data[0].color : '#fff';\n    }).attr('opacity', 0.3);\n\n    discBars.attr('transform', (d, i, n)=> {\n        let movex = dimensions.observedWidth / n.length;\n        let height = d.data[0] ? (d.data[0].scales.stateColors.length * dimensions.squareDim - 10) : 0;\n        let y = d3.scaleLinear().domain([0, d.max]).range([0, (height-5)])\n        let movey = (height-5) - y(d.data.length);\n        return 'translate('+(movex * i)+', '+movey+')'});\n\n    dRects.on('mouseover', (d, i, n)=> {\n        let state = d3.select('g.'+d[0].label).selectAll('g.state');\n        state.filter(f=> {\n            return f[0].state === d[0].winState}).attr('opacity', 0.8);\n        state.filter(f=> f[0].state != d[0].winState).attr('opacity', 0.1);\n        d3.select(n[i]).attr('opacity', 0.9);\n    }).on('mouseout', (d, i, n)=> {\n        d3.select(n[i]).attr('opacity', 0.3);\n        let state = d3.select('g.'+d[0].label).selectAll('g.state').attr('opacity', 0.6);\n    });\n\n    discOb.each((d, i, nodes)=> {\n           \n            let xPoint = d3.scalePoint().domain(d.stateKeys).range([0, dimensions.observedWidth]).padding(.6)\n            let height = d.stateKeys ? (d.stateKeys.length * dimensions.squareDim - 10) : 0;\n            let y = d3.scaleLinear().domain([0, d.leafData.data.length]).range([(height), 0]);\n            d3.select(nodes[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(4))//.attr('transform', 'translate(0, '+height+')');\n            d3.select(nodes[i]).append('g').classed('x-axis', true).call(d3.axisBottom(xPoint)).attr('transform', 'translate(0, '+height+')');\n\n            d3.select(nodes[i]).select('.x-axis').selectAll('text').style('font-size', '8px');\n            d3.select(nodes[i]).select('.y-axis').selectAll('text').style('font-size', '8px');\n    });\n\n}\n\nfunction brushedNodes(nodes, notNodes, data, brushedVal, classLabel){\n   \n    let nodeNames = nodes.map(m=> m.node);\n    let notNodeNames = notNodes.map(m=> m.node);\n\n    let timeNodes = d3.extent(nodes.map(m=> m.combLength));\n    let treeNode = d3.select('#sidebar').selectAll('.node');\n\n    let selectedBranch = treeNode.filter(f=> {\n        return nodeNames.indexOf(f.data.node) > -1;\n    }).classed('brushed-branch', true);\n\n    let notNodeSelectedBranch = treeNode.filter(f=> notNodeNames.indexOf(f.data.node) > -1).classed('anti-brushed', true);\n\n    let test = pullPath([], selectedBranch.data(), [], [], 0);\n    let notTest = pullPath([], notNodeSelectedBranch.data(), [], [], 0);\n\n    let testtest = test.flatMap(t=> t).filter(f=>{\n        return f.data.attributes[data.key].values.realVal >= brushedVal[0] && f.data.attributes[data.key].values.realVal <= brushedVal[1];\n    }).map(m=> m.data.node);\n\n    let notTestTest = notTest.flatMap(t=> t).filter(f=>{\n        return f.data.attributes[data.key].values.realVal < brushedVal[0] || f.data.attributes[data.key].values.realVal > brushedVal[1];\n    }).map(m=> m.data.node);\n    \n    let secondGrp = treeNode.filter(f=> (nodeNames.indexOf(f.data.node) === -1)&&(testtest.indexOf(f.data.node) > -1))\n        .classed('brushed-second', true)\n        .classed(`${data.key}`, true)\n        .classed(classLabel, true);\n    let secondLinks = d3.select('#sidebar').selectAll('.link')\n        .filter(f=> (nodeNames.indexOf(f.data.node) === -1)&&(testtest.indexOf(f.data.node) > -1))\n        .classed('brushed-second', true)\n        .classed(`${data.key}`, true)\n        .classed(classLabel, true);\n    \n    selectedBranch.classed(`${data.key}`, true).classed(classLabel, true).classed('brushed-branch', true);\n   \n    let notNodeSecondGrp = treeNode\n        .filter(f=> (notNodeNames.indexOf(f.data.node) === -1 )&& (notTestTest.indexOf(f.data.node) > -1))\n        .classed('anti-brushed-second', true)\n        .classed(`${data.key}`, true)\n        .classed(classLabel, true);\n\n    let secondAntiLinks = d3.select('#sidebar').selectAll('.link')\n            .filter((f, j)=> (notNodeNames.indexOf(f.data.node) === -1)&&(notTestTest.indexOf(f.data.node) > -1));\n    secondAntiLinks.classed('anti-brushed-second', true).classed(`${data.key}`, true).classed(classLabel, true);\n    notNodeSelectedBranch.classed('anti-brushed', true).classed(classLabel, true).classed(classLabel, true);\n\n    return [selectedBranch, secondGrp, notNodeSelectedBranch, notNodeSecondGrp];\n}\n\nfunction continuousHistogram(data){\n    \n    let x = data[0].yScale;\n    let histogram = d3.histogram()\n            .value(function(d) { return d.values.realVal; })  \n            .domain(x.domain())  \n            .thresholds(x.ticks(20)); \n\n    return histogram(data);\n}\n\nlet mirrorlineGen = d3.area()\n    .curve(d3.curveCardinal)\n    .x((d, i, n)=> {\n      \n        let y = d3.scaleLinear().domain([n.length - 1, 0]).range([0, dimensions.height]).clamp(true);\n        \n        return y(i); \n    })\n    .y0(d=> {\n        return 0;\n    })\n    .y1((d, i, n)=> {\n        let max = n.maxCount ? n.maxCount : d.maxCount;\n        let dat = d.length;\n        let count = n.count? n.count : 8;\n        let x = d3.scaleLinear().domain([0, max]).range([0, ((dimensions.predictedWidth/count)*.5)]).clamp(true);\n        \n        return x(dat); \n});\n\nvar lineGen = d3.area()\n    .curve(d3.curveCardinal)\n    .x((d, i, n)=> {\n        let y = d3.scaleLinear().domain([0, n.length - 1]).range([0, dimensions.height]).clamp(true);\n        return y(i); \n    })\n    .y0(d=> {\n        return 0;\n    })\n    .y1((d, i, n)=> {\n        let max = d.maxCount? d.maxCount : d3.sum(n.map(m=> m.length))\n        let dat = d.length;\n        let count = n.count? n.count : 8;\n        let x = d3.scaleLinear().domain([0, max]).range([0, ((dimensions.predictedWidth/count)*.5)]).clamp(true);\n        return x(dat); \n    });\n\n\n","import * as d3 from \"d3\";\nimport { load_data } from \"./multinetLoad\";\nimport { discreteTraitList, colorKeeper, calculatedScalesKeeper, dataMaster, nestedData, speciesTest } from \".\";\nimport { allPaths } from \"./pathCalc\";\nimport { binGroups } from \"./distributionView\";\nimport { addCladeGroup, chosenCladesGroup, addClade } from \"./cladeMaker\";\nimport { buildTreeStructure } from \"./sidebarComponent\";\n\nexport const maxTimeKeeper = []\n\nexport async function loadData(readFunction, fileString, type){\n    let data = await readFunction(fileString);\n    data.type = String(type);\n    return data;\n}\n\nexport function pairPaths(pathData, field){\n\n\n    return pathData.flatMap((path, i)=> {\n        let pairs = pathData.filter((f, j)=> j != i);\n        let paired =  pairs.map((p)=> {\n            return {'p1': path, 'p2': p}\n        });\n        return paired.map(m=> {\n            m.distance = getDistance(m);\n            m.deltas = calculateDelta(m, field);\n            m.closeness = calculateCloseness(m, field);\n            \n            return m;\n        })\n    })\n}\n\nfunction getDistance(pair){\n    let verts = pair.p2.map(m=> m.node);\n\n    let test = pair.p1.filter(f=> verts.indexOf(f.node) != -1);\n    let lastNode = test[test.length - 1].node;\n\n    let p1Index = pair.p1.map(m=> m.node).indexOf(lastNode);\n    let p2Index = pair.p2.map(m=> m.node).indexOf(lastNode);\n  \n    let p1 = pair.p1.filter((f, i)=> i >= p1Index);\n    let p2 = pair.p2.filter((f, i)=> i >= p2Index);\n\n    pair.common = pair.p1[p1Index]\n\n    return d3.sum(p1.map(m=> m.edgeLength)) + d3.sum(p2.map(m=> m.edgeLength));\n}\n\nfunction calculateDelta(pair, field){\n   \n    let verts = pair.p2.map(m=> m.node);\n\n    let test = pair.p1.filter(f=> verts.indexOf(f.node) != -1);\n    let lastNode = test[test.length - 1].node;\n\n    let p1Index = pair.p1.map(m=> m.node).indexOf(lastNode);\n    let p2Index = pair.p2.map(m=> m.node).indexOf(lastNode);\n  \n    let p1 = pair.p1.filter((f, i)=> i >= p1Index);\n    let p2 = pair.p2.filter((f, i)=> i >= p2Index);\n\n \n    let range = maxTimeKeeper[0] - p1[0].combLength;\n    let binCount = d3.max([p1.length, p2.length])\n    let binStep = range / binCount;\n   \n    let bins = [...new Array(binCount-1)].map((d, i)=> {\n        return {'bottom': p1[0].combLength + (i*binStep), 'top': p1[0].combLength + ((i+1)*binStep) }\n    })\n   \n    bins = bins.map((d, i)=> {\n        let one = p1.filter(f=> (f.combLength <= d.top) && (f.combLength >= d.bottom))\n        let two = p2.filter(f=> (f.combLength <= d.top) && (f.combLength >= d.bottom))\n        d.one = one;\n        d.two = two;\n        return d;\n    });\n\n    bins = bins.map((b, i)=> {\n        if(b.one.length === 0){\n            b.one = bins[i-1].one;\n        }\n        if(b.two.length === 0){\n            b.two = bins[i-1].two;\n        }\n\n        return b;\n    })\n    \n    let attributes = d3.entries(p1[0].attributes)\n                    .filter(f => f.value.type === 'continuous')\n                    .map(m=> {\n                        let name = m.key;\n                        let valdiffs = bins.map((b, i)=> {\n                            return Math.abs(b.one[0].attributes[name].values.realVal - b.two[0].attributes[name].values.realVal);\n                        });\n                        m.value = d3.max(valdiffs)\n                        return m;\n                    });\n\nreturn attributes;\n\n}\n\nfunction calculateCloseness(pair, field){\n let leaf1 = pair.p1.filter(p=> p.leaf === true)[0].attributes;\n let leaf2 = pair.p2.filter(p=> p.leaf === true)[0].attributes;\n\n return d3.entries(leaf1).filter(f=> f.value.type === 'continuous').map(m=> {\n    \n     m.value = Math.abs(m.value.values.realVal - leaf2[m.key].values.realVal);\n     return m\n });\n}\n\nexport function calculateNewScales(attributes, keyList, colorKeeper){\n\n    return keyList.map((d, i)=> {\n\n        let attData = attributes.flatMap(f=> f[d]);\n        let color = colorKeeper[i] != undefined ? colorKeeper[i][0] : colorKeeper[0][0];\n       \n        if(attData[0].type == 'continuous'){\n            \n            let max = d3.max(attData.flatMap(m=> m.values.upperCI95));\n            let min = d3.min(attData.flatMap(m=> m.values.lowerCI95));\n            let mean = d3.mean(attData.flatMap(m=> m.values.realVal));\n\n            return {\n                'field': d, \n                'type':'continuous',\n                'max': max, \n                'min':  min,\n                'yScale': d3.scaleLinear().range([0, 43]).domain([min, max]).clamp(true),\n                'satScale': d3.scaleLinear().range([0, .9]).domain([min, max]),\n                'colorScale': d3.scaleLinear().range([color, '#f23929']).domain([min, max]),\n                'catColor': color,\n            };\n        }else{\n            let scaleCat = d3.keys(attData[0].values);\n            return { \n                'field': d,\n                'type':'discrete',\n                'stateColors': scaleCat.map((sc, j)=> {\n                    return {'state': sc, 'color': colorKeeper[j][0]};\n                }),\n                'catColor': color,\n                'scales': scaleCat.map(sc=> {\n                let scaleName = sc;\n               \n                let max = 1;\n                let min = 0;\n                return {\n                    'field': d, \n                    'scaleName': scaleName,\n                    'max': max, \n                    'min':  min,\n                    'yScale': d3.scaleLinear().range([45, 0]).domain([min, max]),\n                };\n                \n            }) };\n        }\n    });\n}\n\nexport function calculateScales(calculatedAtt, colorKeeper){\n    return Object.keys(calculatedAtt).map((d, i)=> {\n       \n        if(calculatedAtt[d].type == 'continuous'){\n            \n            let max = d3.max(calculatedAtt[d].rows.map(m=> m.upperCI95));\n            let min = d3.min(calculatedAtt[d].rows.map(m=> m.lowerCI95));\n            let mean = d3.mean(calculatedAtt[d].rows.map(m=> m.realVal));\n            \n            return {\n                'field': d, \n                'type':'continuous',\n                'max': max, \n                'min':  min,\n                'yScale': d3.scaleLinear().range([0, 43]).domain([min, max]).clamp(true),\n                'satScale': d3.scaleLinear().range([0, .9]).domain([min, max]),\n                'colorScale': d3.scaleLinear().range([colorKeeper[i][0], '#f23929']).domain([min, max]),\n                'catColor': colorKeeper[i][0],\n            };\n        }else{\n            let scaleCat = calculatedAtt[d].fields.filter(f=> f!= 'nodeLabels');\n            return { \n                'field': d,\n                'type':'discrete',\n                'stateColors': scaleCat.map((sc, i)=> {\n                    return {'state': sc, 'color': colorKeeper[i][0]};\n                }),\n                'catColor': colorKeeper[i][0],\n                'scales': scaleCat.map(sc=> {\n                let scaleName = sc;\n               \n                let max = 1;\n                let min = 0;\n                return {\n                    'field': d, \n                    'scaleName': scaleName,\n                    'max': max, \n                    'min':  min,\n                    'yScale': d3.scaleLinear().range([45, 0]).domain([min, max]),\n                };\n                \n            }) };\n        }\n    });\n}\n\nexport function matchLeaves(labels, leaves, leafChar, calculatedScales){\n\n        ////MATCHING LABELSS TO THE STUFF/////\n    let  mappedLeafLabels = labels.rows.map(m=> {\n        let label = m.x;\n        return label;\n    });\n\n    return leaves.map((leaf, i)=> {\n      \n        leaf.label = mappedLeafLabels[i];\n\n        //let leafCharIndex = leafChar.rows.map(m=> m[\"\"]);\n      \n        let leafCharIndex = leafChar.rows[0][\"\"] ? leafChar.rows.map(m=> m[\"\"]) : leafChar.rows.map(m=> m[\"species\"]);\n  \n        leaf.node = leaf.V2;\n        let keys = calculatedScales.map(m=> m.field);\n        let attr = {};\n         \n        let chosenOne = leafChar.rows[leafCharIndex.indexOf(leaf.label)];\n \n        keys.forEach((k)=> {\n             let scaleOb = calculatedScales.filter(f=> f.field == k)[0];\n            \n             if(scaleOb.type === 'discrete'){\n                 let thisScale = scaleOb.scales.filter(f=> f.scaleName == chosenOne[k])[0].yScale;\n                 let states = scaleOb.scales.map(m=> m.scaleName).map(state=> {\n                     let value = (state === chosenOne[k])? 1 : 0;\n                    // return {'state': state,  scaleVal: thisScale(value), realVal: value};\n                     return {'state': state, realVal: value};\n                 });\n                 //let states = {'state': leafChar.rows[i][k],  scaleVal: thisScale(1), realVal: 1}\n                 attr[k] = {'states': states, 'label': k, 'type': scaleOb.type, leaf: true};\n             }else if(scaleOb.type === 'continuous'){\n                 let scale = scaleOb.yScale;\n                 //attr[k] = {'scaleVal': scale(chosenOne[k]), 'scaledHigh': 0, 'scaledLow': 0, 'realVal': chosenOne[k], 'type': scaleOb.type, leaf: true};\n                 attr[k] = {'realVal': chosenOne[k], 'type': scaleOb.type, leaf: true};\n \n             }else{\n                 attr[k] = 'error in leaf matching';\n             }\n         });\n\n         leaf.clade = chosenOne.clade;\n         leaf.attributes = attr;\n         leaf.leaf = true;\n     \n         return leaf;\n     });\n}\n\nexport function matchEdges(edges, edgeLen, calculatedAtt, calculatedScales){\n    return edges.rows.map((edge, i)=> {\n        let attrKeys = Object.keys(calculatedAtt);\n        let index = calculatedAtt[attrKeys[0]].rows.map(m=> m['nodeLabels']).indexOf(edge.V2);\n        edge.edgeLength = edgeLen.rows[i].x;\n        edge.node = edge.V2;\n        if(index > -1){ \n            attrKeys.forEach(attr=> {\n                if(calculatedAtt[attr].type == 'continuous'){\n                    let scale = calculatedScales.filter(f=> f.field == attr)[0].yScale;\n                    let res = calculatedAtt[attr].rows[index];\n                   // res.scaleVal = scale(res.estimate);\n                   // res.scaledLow = scale(res.lowerCI95);\n                    //res.scaledHigh = scale(res.upperCI95);\n                    res.realVal = res.estimate;\n                    res.type = 'continuous';\n                    edge.attributes = (edge.attributes != undefined)? edge.attributes : {};\n                    edge.attributes[attr] = res;\n                }else{\n                    let scales = calculatedScales.filter(f=> f.field == attr)[0].scales;\n                    let row = calculatedAtt[attr].rows[index];\n                    let states = scales.map(s=> {\n                       // return {'state': s.scaleName,  scaleVal: s.yScale(row[s.scaleName]), realVal: row[s.scaleName]};\n                        return {'state': s.scaleName, realVal: row[s.scaleName]};\n                    });\n                    edge.attributes = (edge.attributes != undefined)? edge.attributes : {};\n                    edge.attributes[attr] = {'states':states, 'type': 'discrete'};\n                }\n            });\n        }\n        return edge;\n    });\n\n}\nexport function rootAttribute(paths, calculatedAtt, calculatedScales){\n\n    let rootAtt = calculatedAtt.filter(f=> f.node === paths[0][0].node)[0];\n\n    Object.keys(rootAtt).filter(f=> f != 'node').map(att=> {\n        rootAtt[att].scales = calculatedScales.filter(f=> f.field === att)[0];\n    });\n\n    return paths.map((p, i)=> {\n        p[0].attributes = rootAtt;\n        p[0].root = true;\n        return p\n    });\n\n};\nexport function combineLength(paths){\n\n    let maxTime = paths.map(path=> d3.sum(path.map(p=> p.edgeLength)))[0];\n    maxTimeKeeper.push(maxTime);\n    return paths.map(path=> {\n        return path.map((node, i, n)=> {\n            node.maxTime = maxTime;\n            node.combLength = d3.sum(n.filter((f, j)=> i >= j).map(m=> m.edgeLength));\n            return node;\n        })\n    })\n\n}\n\nexport function filterKeeper(){\n\n    this.filterArray = new Array();\n    this.attributeFilter = false;\n\n    this.addFilter = function(filter){\n        this.filterArray.push(filter);\n        return this.filterArray;\n    };\n    this.removeFilter = function(index){\n        this.filterArray = this.filterArray.filter((f, i)=> i != index);\n        return this.filterArray;\n    };\n}\n\nexport function formatAttributeData(pathData, scales, filterArray){\n\n    let keys = (filterArray == null)? Object.keys(pathData[0][0].attributes).filter(f=> f != 'node' && f != 'leaf' && f != 'length' && f != 'root' && f != 'key'): filterArray;\n   \n    let newData = pathData.map(path=> {\n        return keys.map((key)=> {\n            return path.map((m)=> {\n                let speciesLabel = path[path.length - 1].node;\n                \n                if(m.attributes[key].type === 'continuous'){\n                    m.attributes[key].species = speciesLabel;\n                    m.attributes[key].color = scales.filter(f=> f.field === key)[0].catColor;\n                    m.attributes[key].move = m.combineLength;\n                    m.attributes[key].combLength = m.combLength;\n                    m.attributes[key].node = m.node;\n                    m.attributes[key].edgeMove = m.edgeLength;\n                    m.attributes[key].edgeLength = m.edgeLength;\n                    m.attributes[key].label = key;\n                    m.attributes[key].yScale = m.attributes[key].scales.yScale;\n                    m.attributes[key].satScale = m.attributes[key].scales.satScale;\n                    m.attributes[key].colorScale = m.attributes[key].scales.colorScale;\n                    if(m.leaf){\n                        m.attributes[key].leaf = m.leaf;\n                    }\n                    m.attributes[key].leaf = m.leaf;\n                    return m.attributes[key];\n                }else if(m.attributes[key].type === 'discrete'){\n                    if(m.leaf === true){\n                        let states = d3.entries(m.attributes[key].values);\n                     \n                        m.attributes[key].leaf = m.leaf;\n                        let state = m.attributes[key];\n                        state.states = {field: key, state: m.attributes[key].values[key]}\n                        state.species = speciesLabel;\n                        state.winState = m.attributes[key].values[key] ?  m.attributes[key].values[key] : d3.entries(m.attributes[key].values);\n                        state.color = m.attributes[key].scales.stateColors.filter(f=> {\n                            return f.state.includes(state.winState)})[0].color;\n\n                        \n                        state.move = m.combLength;\n                        state.combLength = m.combLength;\n                        state.node = m.node;\n                        state.edgeMove = m.edgeLength;\n                        state.edgeLength = m.edgeLength;\n                        state.attrLabel = key;\n                        return state;\n                    }else{\n                        let states = m.attributes[key].states ? m.attributes[key].states : d3.entries(m.attributes[key].values);//.filter(f => f.state != undefined);\n\n                        return states.map((st, j)=> {\n                            st.state = st.key;\n                            st.value = st.value;\n                            \n                            st.color = m.attributes[key].scales.stateColors.filter(f=> f.state === st.key)[0];\n                           \n                            st.move = m.combLength;\n                            st.combLength = m.combLength;\n                            st.node = m.node;\n                            st.edgeMove = m.edgeLength;\n                            st.edgeLength = m.edgeLength;\n                            st.attrLabel = key;\n                            st.species = speciesLabel;\n                            return st;\n                        });\n                    }\n             \n                }else{\n                    console.error('attribute type not found');\n                }\n            });\n        });\n    });\n    return newData;\n}\n\nexport async function dataLoadAndFormatMultinet(workspace, graphName){\n\n    let dataName = graphName;\n\n    let data = await load_data(workspace, graphName);\n\n    console.log('data', workspace, graphName, data)\n   \n    //helper function to create array of unique elements\n    Array.prototype.unique = function() {\n        return this.filter(function (value, index, self) { \n            return self.indexOf(value) === index;\n        });\n    }\n\n    let attributeList = []\n\n    let edges = data.links;\n    let internal = data.nodes.filter(f=> f.id.includes('internal'));\n    let leaves = data.nodes.filter(f=> f.id.includes('leaf'));\n\n    let notAttributeList = [\"id\", \"label\", \"_key\", \"_rev\", \"key\", \"length\"];\n\n    ///Creating attribute list to add estimated values in //\n    d3.keys(leaves[0]).filter(f=> notAttributeList.indexOf(f) === -1).forEach((d, i)=> {\n\n        if(discreteTraitList.indexOf(d) > -1){\n            attributeList.push({field: d, type: 'discrete'});\n        }else{\n            attributeList.push({field: d, type:'continuous'});\n        }\n\n    });\n\n    let calculatedAtt = internal.map((row, i)=> {\n\n        let newRow = {};\n        attributeList.forEach((att)=>{\n            newRow[att.field] = {};\n            newRow[att.field].field = att.field;\n            newRow[att.field].type = att.type;\n            let values = {}\n            d3.entries(row).filter(f=> f.key.includes(att.field)).map(m=> {\n                if(att.type === 'continuous'){\n                   \n                    if(m.key.includes('upperCI')){\n                        values.upperCI95 = +m.value;\n                    }else if(m.key.includes('lowerCI')){\n                        values.lowerCI95 = +m.value;\n                    }else{\n                        values.realVal = +m.value;\n                    }\n                }else{\n                     values[m.key] = m.value;   \n                }\n            });\n            newRow[att.field].values = values;\n        });\n        newRow.node = row.label;\n        newRow.key = row.id;\n        newRow.length = +row.length;\n        newRow.leaf = false;\n        return newRow;\n    });\n\n    let calcLeafAtt = leaves.map((row, i)=> {\n        let newRow = {};\n        attributeList.forEach((att)=>{\n            newRow[att.field] = {};\n            newRow[att.field].field = att.field;\n            newRow[att.field].type = att.type;\n            let values = {}\n            d3.entries(row).filter(f=> f.key.includes(att.field)).map(m=> {\n                if(att.type === 'continuous'){\n                    values.realVal = +m.value;\n                }else{\n                    values[m.key] = m.value;   \n                }\n            });\n            newRow[att.field].values = values;\n        });\n        newRow.node = row.label;\n        newRow.label = row.label;\n        newRow.length = +row.length;\n        newRow.key = row.id;\n        newRow.leaf = true;\n        return newRow;\n    });\n\n    let calculatedScales = calculateNewScales(calculatedAtt, attributeList.map(m=> m.field), colorKeeper);\n\n    let matchedEdges = edges.map((edge, i)=> {\n\n        let attrib = edge.target.includes(\"internal\") ? calculatedAtt.filter(f=> f.key === edge.target)[0] : calcLeafAtt.filter(f=> f.key === edge.target)[0];\n        let fromNode = edge.source.includes(\"internal\") ? calculatedAtt.filter(f=> f.key === edge.source)[0] : calcLeafAtt.filter(f=> f.key === edge.source)[0];\n\n        if(attrib){\n           \n            Object.keys(attrib).filter(f=> (f != 'node') && (f != 'label') && (f != 'length') && (f != 'leaf') && (f != 'key')).map((att, i)=>{\n                let scales = calculatedScales.filter(f=> f.field=== att)[0];\n                attrib[att].scales = scales;\n                return att;\n            })\n        }\n        let newEdge = {\n            V1: fromNode.node,\n            V2: attrib.node,\n            node: attrib.node,\n            leaf: attrib.leaf,\n            edgeLength: +attrib.length,\n            attributes: attrib ? attrib : null\n        }\n        return newEdge;\n    });\n\n    let paths = allPaths(matchedEdges, matchedEdges.filter(f=> f.leaf === true), \"V1\", \"V2\")\n        .map((path, i)=> {\n            let root = path[0];\n            let attrib = calculatedAtt.filter(f=> f.node === root.node)[0];\n            if(attrib){\n               \n                Object.keys(attrib).filter(f=> (f != 'node') && (f != 'label') && (f != 'length') && (f != 'leaf') && (f != 'key')).map((att, i)=>{\n                    let scales = calculatedScales.filter(f=> f.field=== att)[0]\n                    attrib[att].scales = scales;\n                    return att;\n                })\n            }\n            let rooted = {\n                V1: null,\n                V2: attrib.node,\n                node: attrib.node,\n                leaf: attrib.leaf,\n                root: true,\n                edgeLength: 0,\n                attributes: attrib ? attrib : null\n            }\n            path[0] = rooted;\n            return path;\n        });\n\n    let normedPaths = combineLength(paths);\n\n    let group = binGroups(normedPaths, dataName, calculatedScales, 8);\n    let chosenClade = addCladeGroup(`All ${dataName}`, ['Whole Set'], [{'label': `All ${dataName}`, 'paths': normedPaths, 'groupBins': group}]);\n    chosenCladesGroup.push(chosenClade)    \n    \n    addClade(`All ${dataName}`, normedPaths);\n\n    calculatedScalesKeeper.push(calculatedScales);\n    dataMaster.push(normedPaths);\n    nestedData.push(buildTreeStructure(normedPaths, matchedEdges));\n    speciesTest.push(normedPaths.flatMap(m=> m.filter(f=> f.leaf === true)).map(l=> l.node));\n\n    return [normedPaths, calculatedScales];\n}","import '../styles/index.scss';\nimport * as d3 from \"d3\";\nimport {calculateNewScales, rootAttribute, combineLength, dataLoadAndFormatMultinet} from './dataFormat';\nimport {allPaths} from './pathCalc';\nimport {renderTree, buildTreeStructure, renderTreeButtons} from './sidebarComponent';\nimport {toolbarControl, toolbarDataControl} from './toolbarComponent';\nimport { initialViewLoad } from './viewControl';\nimport { addCladeGroup, chosenCladesGroup, addClade} from './cladeMaker';\nimport { binGroups } from './distributionView';\nimport { getGraphNames } from './multinetLoad';\n\nexport const dataMaster = [];\nexport const savedSelected = [];\nexport const collapsed = false;\nexport const nestedData = [];\nexport const speciesTest = [];\nexport const calculatedScalesKeeper = [];\n\nexport const colorKeeper = [\n    ['#0dc1d1', '#c8f7fd'],\n    ['#3AD701', '#2a9b01'],\n    ['#fec303', '#d3a001'],\n    ['#fe4ecb', '#d30197'],\n    ['#f36b2c'],\n    ['#1abc9c'],\n    ['#493267'],\n    ['#a40b0b'],\n    ['#0095b6'],\n    ['#97A628'],\n    ['#9B28A6'],\n    ['#3928A6'],\n    ['#0dc1d1', '#c8f7fd'],\n    ['#3AD701', '#2a9b01'],\n    ['#fec303', '#d3a001'],\n    ['#fe4ecb', '#d30197'],\n    ['#f36b2c'],\n    ['#1abc9c'],\n    ['#493267'],\n    ['#a40b0b'],\n    ['#0095b6'],\n    ['#97A628'],\n    ['#9B28A6'],\n    ['#3928A6'],\n]\n\nexport const attributeList = [];\nexport let discreteTraitList = ['Clade', 'Group', 'island/mainland'];\n\nexport const workspace = 'evobio';\n\nlet wrap = d3.select('#wrapper');\nlet main = wrap.select('#main');\nwrap.select('#selected').classed('hidden', true);\nlet sidebar = wrap.select('#sidebar');\nlet toolbarDiv = wrap.select('#toolbar');\nlet toolbarDataWrap = toolbarDiv.append('div').classed('toolbar-data-button', true);\nlet toolbarButtonWrap = toolbarDiv.append('div').classed('toolbar-button-wrap', true);\nwrap.select('#filter-tab').classed('hidden', true);\n\nlet tooltip = wrap.append(\"div\")\n.attr(\"id\", \"tooltip\")\n.style(\"opacity\", 0);\n\n////DATA LOADING////\n\nappLaunch();\n\nasync function appLaunch(){\n\n    let graphList = await getGraphNames(workspace);\n    graphList = graphList.map(name=> {\n        return {field: name, text: `Data: ${name}`}\n    })\n\n    toolbarDataControl(toolbarDataWrap, graphList, graphList[1]);\n\n    loadApp(workspace, graphList[1].field);\n\n}\n\nexport async function loadApp(workspace, graphName){\n\n    dataLoadAndFormatMultinet(workspace, graphName).then(centData=> {\n    \n        toolbarControl(toolbarButtonWrap, main, centData[1]);\n    \n        d3.select('#clade-show').selectAll('li').select('input').node().checked = true\n       \n        renderTree(null, true, false);\n        renderTreeButtons(centData[0], false);\n        /// LOWER ATTRIBUTE VISUALIZATION ///\n        initialViewLoad(centData[1]);\n    });\n}\n\nasync function dataLoadAndFormat(edgeFile, edgeLengthFile, leafCharFile, resFile, dataName){\n\n    //helper function to create array of unique elements\n    Array.prototype.unique = function() {\n        return this.filter(function (value, index, self) { \n            return self.indexOf(value) === index;\n        });\n    }\n\n    let edges = await loadData(d3.json, `./public/data/${edgeFile}`, 'edge');\n    let leafChar = await loadData(d3.csv, `./public/data/${leafCharFile}`, '');\n    let edgeLen = await loadData(d3.json, `./public/data/${edgeLengthFile}`, 'edge');\n    let char = await loadData(d3.json, `./public/data/${resFile}`, '');\n\n    ///Creating attribute list to add estimated values in //\n\n    leafChar.columns.filter(f=> f != 'species').forEach((d, i)=> {\n\n        if(discreteTraitList.indexOf(d) > -1){\n            attributeList.push({field: d, type: 'discrete'});\n        }else{\n            attributeList.push({field: d, type:'continuous'});\n        }\n\n    });\n\n    edges.rows = edges.rows.filter(f=> f.From != \"\").map((edge, i)=> {\n        edge.edgeLength = edgeLen.rows[i].x;\n        return edge;\n    });  \n\n    //Mapping data together/////\n    let edgeSource = edges.rows.map(d=> d.From);\n   \n    let leaves = edges.rows.filter(f=> edgeSource.indexOf(f.To) == -1 );\n\n    let calculatedAtt = char.rows.map((row, i)=> {\n        let newRow = {};\n        attributeList.forEach((att)=>{\n            newRow[att.field] = {};\n            newRow[att.field].field = att.field;\n            newRow[att.field].type = att.type;\n            let values = {}\n            d3.entries(row).filter(f=> f.key.includes(att.field)).map(m=> {\n                if(att.type === 'continuous'){\n                   \n                    if(m.key.includes('upperCI')){\n                        values.upperCI95 = m.value;\n                    }else if(m.key.includes('lowerCI')){\n                        values.lowerCI95 = m.value;\n                    }else{\n                        values.realVal = m.value;\n                    }\n                }else{\n                     values[m.key] = m.value;   \n                }\n            });\n            newRow[att.field].values = values;\n        });\n        newRow.node = row.nodeLabels;\n        return newRow;\n    });\n\n  \n    let calculatedScales = calculateNewScales(calculatedAtt, attributeList.map(m=> m.field), colorKeeper);\n\n    let matchedEdges = edges.rows.map((edge, i)=> {\n        let attrib = calculatedAtt.filter(f=> f.node === edge.To)[0]\n        if(attrib){\n            Object.keys(attrib).filter(f=> f != 'node').map((att, i)=>{\n                \n                let scales = calculatedScales.filter(f=> f.field=== att)[0]\n                attrib[att].scales = scales;\n                return att;\n                \n            })\n        }\n        let newEdge = {\n            V1: edge.From,\n            V2: edge.To,\n            node: edge.To,\n            edgeLength: edge.edgeLength,\n            attributes: attrib ? attrib : null\n        }\n        return newEdge;\n    });\n\n\n    let calcLeafAtt = leafChar.map((row, i)=> {\n        let newRow = {};\n        attributeList.forEach((att)=>{\n            newRow[att.field] = {};\n            newRow[att.field].field = att.field;\n            newRow[att.field].type = att.type;\n            let values = {}\n            d3.entries(row).filter(f=> f.key.includes(att.field)).map(m=> {\n                if(att.type === 'continuous'){\n                    values.realVal = m.value;\n                }else{\n                    values[m.key] = m.value;   \n                }\n            });\n            newRow[att.field].values = values;\n        });\n        newRow.node = row.species;\n        newRow.label = row.species;\n        \n        return newRow;\n    })\n\n\n    let matchedLeaves = leaves.map((leaf, i)=>{\n        let attrib = calcLeafAtt.filter(f=> f.node === leaf.To)[0]\n        if(attrib){\n            Object.keys(attrib).map((att, i)=>{\n                if(att!='node' && att != 'label'){\n                    let scales = calculatedScales.filter(f=> f.field=== att)[0]\n                    attrib[att].scales = scales;\n                    return att;\n                }\n            });\n        }\n        let newEdge = {\n            V1: leaf.From,\n            V2: leaf.To,\n            node: leaf.To,\n            edgeLength: leaf.edgeLength,\n            attributes: attrib ? attrib : null,\n            group: null,\n            leaf: true\n        }\n        return newEdge;\n    });\n\n    let all = matchedEdges.filter(f=> f.attributes != null);\n\n    let paths = allPaths(all, matchedLeaves, \"V1\", \"V2\");\n    \n    let addedRoot = rootAttribute(paths, calculatedAtt, calculatedScales);\n\n    let normedPaths = combineLength(addedRoot);\n\n    let group = binGroups(normedPaths, dataName, calculatedScales, 8);\n    let chosenClade = addCladeGroup(`All ${dataName}`, ['Whole Set'], [{'label': `All ${dataName}`, 'paths': normedPaths, 'groupBins': group}]);\n    chosenCladesGroup.push(chosenClade)    \n    \n    addClade(`All ${dataName}`, normedPaths);\n\n    calculatedScalesKeeper.push(calculatedScales);\n    dataMaster.push(normedPaths);\n    nestedData.push(buildTreeStructure(normedPaths, all.concat(matchedLeaves)));\n    speciesTest.push(normedPaths.flatMap(m=> m.filter(f=> f.leaf === true)).map(l=> l.node));\n\n    return [normedPaths, calculatedScales];\n}\n\n\n\n\n\n\n\n\n\n\n\n"],"sourceRoot":""}